/*
 Zoomify Image Viewer, version on line 25 below. Copyright Zoomify, Inc., 1999-2016. All rights reserved. You may
use this file on private and public websites, for personal and commercial purposes, with or without modifications, so long as this
notice is included. Redistribution via other means is not permitted without prior permission. Additional terms apply. For complete
license terms please see the Zoomify License Agreement in this product and on the Zoomify website at www.zoomify.com.
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
*/
(function(){(function(){return this}).call().Z={}})();Z.version="4.01 LimitedEdition-InternalToolbar&NavVisParam";Z.setCallback=function(a,b){"undefined"===typeof Z.callbacks&&(Z.callbacks=[]);var c=Z.Utils.arrayIndexOfObjectTwoValues(Z.callbacks,"callbackEvent",a,null,"callbackFunction",b);-1==c&&(c=Z.callbacks.length);Z.callbacks[c]={callbackEvent:a,callbackFunction:b}};
Z.showImage=function(a,b,c){Z.showImage.done?(Z.Utils.declareGlobals(),Z.pageContainerID=a,"undefined"!==typeof b&&Z.Utils.stringValidate(b)?Z.imagePath=Z.Utils.stringRemoveTrailingSlashCharacters(b):Z.imagePath=null,"undefined"!==typeof c&&(Z.parameters=Z.Utils.parseParameters(c)),Z.initialize()):(Z.showImage.done=!0,Z.Utils.addCrossBrowserMethods(),Z.Utils.addCrossBrowserEvents(),Z.Utils.declareGlobals(),Z.pageContainerID=a,Z.setEditPermissionFunction=function(a){Z.externalEditPermissionFunction=
a},Z.clearCallback=function(a,b){var c=Z.Utils.arrayIndexOfObjectTwoValues(Z.callbacks,"callbackEvent",a,null,"callbackFunction",b);-1!=c&&(Z.callbacks=Z.Utils.arraySplice(Z.callbacks,c,1))},"undefined"!==typeof b&&Z.Utils.stringValidate(b)?Z.imagePath=Z.Utils.stringRemoveTrailingSlashCharacters(b):Z.imagePath=null,"undefined"!==typeof c&&("string"===typeof c?(a=unescape(c),a=Z.Utils.stringUnescapeAmpersandCharacters(a),Z.parameters=Z.Utils.parseParameters(a)):Z.parameters=Z.Utils.parseParameters(c)),
"complete"!=document.readyState?(Z.Utils.addEventListener(document,"DOMContentLoaded",Z.initialize),Z.Utils.addEventListener(window,"load",Z.initialize)):Z.initialize())};
Z.initialize=function(){Z.Utils.removeEventListener(document,"DOMContentLoaded",Z.initialize);Z.Utils.removeEventListener(window,"load",Z.initialize);Z.Utils.detectBrowserFeatures();Z.xmlParametersPath&&!Z.parameters?Z.loadParametersXML():null!==Z.parameters&&"undefined"!==typeof Z.parameters.zXMLParametersPath?Z.Utils.setParameters(Z.parameters):(Z.Utils.setParameters(Z.parameters),Z.Viewer=new Z.ZoomifyImageViewer,Z.Utils.stringValidate(Z.copyrightPath)?Z.Utils.enforceCopyright():Z.Viewer.configureViewer(),
1!=Z.debug&&2!=Z.debug&&3!=Z.debug||Z.Utils.trace(Z.Utils.getResource("z445"),!1,!0))};Z.loadParametersXML=function(){Z.xmlParametersParsing=!0;var a=new Z.NetConnector,b=Z.Utils.cacheProofPath(Z.xmlParametersPath);a.loadXML(b)};
Z.ZoomifyImageViewer=function(){function a(){document.getElementsByTagName("body")?document.getElementsByTagName("body")[0].onorientationchange=b:window.setTimeout(a,100)}function b(a){Z.interactive&&Z.fullView&&(Z.Toolbar&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.Navigator&&1<Z.navigatorVisible&&Z.Navigator.setVisibility(!1),Z.Viewport&&(Z.Viewport.toggleFullViewMode(!1),Z.Viewport.toggleFullViewMode(!0)),Z.Navigator&&1<Z.navigatorVisible&&Z.Navigator.setVisibility(!0),Z.Toolbar&&Z.toolbarAutoShowHide&&
Z.Toolbar.show(!0))}function c(a){if(Z.interactive&&Z.keys&&"INPUT"!=document.activeElement.tagName&&"TEXTAREA"!=document.activeElement.tagName&&(a=Z.Utils.event(a),18==a.keyCode||a.altKey||(Z.viewportCurrent.zoomAndPanAllStop(!0,!0),Z.maskingSelection&&Z.viewportCurrent.clearLabelMask()),a)){var b=a.type;a=a.keyCode;if("keydown"==b)switch(Z.keyIsDown=!0,a){case 90:Z.viewportCurrent.zoom("out");break;case 17:Z.viewportCurrent.zoom("out");break;case 65:Z.viewportCurrent.zoom("in");break;case 16:Z.viewportCurrent.zoom("in");
break;case 37:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("left"):Z.imageSet&&e.viewportPrior();break;case 38:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("up"):Z.imageSet&&e.viewportNext();break;case 40:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("down"):Z.imageSet&&e.viewportPrior();break;case 39:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("right"):
Z.imageSet&&e.viewportNext();break;case 27:Z.viewportCurrent.reset()}else if("keyup"==b)if(Z.keyIsDown=!1,90==a||17==a||65==a||16==a)Z.viewportCurrent.zoom("stop");else if(37==a||39==a||38==a||40==a)Z.tracking||(37==a||39==a?Z.viewportCurrent.pan("horizontalStop"):38!=a&&40!=a||Z.viewportCurrent.pan("verticalStop"))}}function d(a){a=Z.Utils.event(a);var b=a.type;if(a&&b){var c=Z.Utils.isRightMouseButton(a),d=a.altKey;if(!("mouseover"!=b&&"mouseout"!=b&&!Z.interactive||"mousedown"==b&&(!Z.interactive||
Z.coordinatesVisible&&d)||c)){Z.touchSupport&&!Z.clickZoomAndPanBlock&&"touchmove"!=b&&"gesturechange"!=b&&a.preventDefault();switch(b){case "mouseover":Z.fullView||"TEXTAREA"==document.activeElement.tagName||Z.Viewer.initializeViewerKeyDefaultListeners(!0);break;case "mouseout":Z.tracking||Z.Viewer.initializeViewerKeyDefaultListeners(!1)}var e;e=Z.Utils.event(a);var g=e.type;if(e&&g){var l;a=Z.Utils.target(e);c=Z.Utils.relatedTarget(e);"resize"!=g&&(l=Z.Utils.getMousePosition(e));d=e.altKey;"DOMMouseScroll"==
g&&(g="mousewheel");switch(g){case "mouseover":d=Z.Utils.nodeIsInViewer(a);e=Z.Utils.nodeIsInViewer(c);d&&e||(Z.viewportCurrent&&Z.viewportCurrent.showLists(!0),Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!0),Z.Navigator&&1<Z.navigatorVisible&&Z.Navigator.setVisibility(!0),Z.mouseOutDownPoint=null);break;case "mouseout":d=Z.Utils.nodeIsInViewer(a);e=Z.Utils.nodeIsInViewer(c);d&&e||"[object HTMLSelectElement]"==a||"[object HTMLOptionElement]"==a||"[object HTMLSelectElement]"==c||"[object HTMLOptionElement]"==
c||(Z.mouseIsDown?Z.mouseOutDownPoint=new Z.Utils.Point(l.x,l.y):(Z.viewportCurrent&&Z.viewportCurrent.showLists(!1),Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.Navigator&&1<Z.navigatorVisible&&Z.Navigator.setVisibility(!1)));break;case "mousewheel":0<Z.mouseWheel&&(l=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),Z.viewportCurrent.mouseWheelHandler(l,d))}}if("mousedown"==b||"mousemove"==b)return!1}}}var e=this,g=[];Z.ViewerDisplay=Z.Utils.createContainerElement("div","ViewerDisplay",
"inline-block","relative","hidden","100%","100%","0px","0px","none","0px","transparent none","0px","0px","normal","pointer");Z.pageContainer=document.getElementById(Z.pageContainerID);Z.Utils.getElementStyle(Z.pageContainer);Z.ViewerDisplay.style["-webkit-touch-callout"]="none";Z.ViewerDisplay.style["-moz-user-select"]="none";Z.ViewerDisplay.style["-khtml-user-select"]="none";Z.ViewerDisplay.style["-webkit-user-select"]="none";Z.ViewerDisplay.style["-ms-user-select"]="none";Z.ViewerDisplay.style["-o-user-select"]=
"none";Z.ViewerDisplay.style["user-select"]="none";var l=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay);Z.viewerW=l.x;Z.viewerH=l.y;Z.pageContainer.innerHTML="";Z.pageContainer.appendChild(Z.ViewerDisplay);Z.autoResize=Z.autoResize||Z.Utils.isElementFluid(Z.pageContainer);parseInt(Z.Utils.getResource("DEFAULT_AUTORESIZESKIPDURATION"),10);Z.mouseWheelCompleteDuration=parseInt(Z.Utils.getResource("z165"),10);this.configureViewer=function(){if(!Z.Viewer.getStatus("configureCalled")){var b=
function(){Z.clearCallback("readyViewer",b);Z.Utils.getMessage()!=Z.Utils.getResource("ALERT_LOADINGIMAGESET")&&Z.Utils.getMessage()!=Z.Utils.getResource("ALERT_LOADINGANNOTATIONS")||Z.Utils.hideMessage()},c=function(){Z.clearCallback(g,c);e.initializeViewerKeyEventListeners(!0);Z.Utils.addEventListener(Z.ViewerDisplay,"mouseover",d);Z.Utils.addEventListener(Z.ViewerDisplay,"mouseout",d);Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",Z.Utils.preventDefault);Z.Utils.addEventListener(Z.ViewerDisplay,
"mousewheel",d);Z.Utils.addEventListener(Z.ViewerDisplay,"mousewheel",Z.Utils.preventDefault);a();Z.autoResize&&Z.Utils.addEventListener(window,"resize",Z.Viewer.viewerEventsHandler);var b=Z["Viewport"+(Z.imageSetLength-1).toString()];e.configureComponents(Z.overlays?b:Z.viewportCurrent)};Z.Viewer.setStatus("configureCalled",!0);var g=Z.imageSet?"initializedViewer":"initializedViewport";Z.setCallback(g,c);Z.setCallback("readyViewer",b);if(Z.imageSet)if(Z.Utils.showMessage(Z.Utils.getResource("ALERT_LOADINGIMAGESET"),
!1,null,"center"),"undefined"!==typeof Z.overlayJSONObject&&"object"===typeof Z.overlayJSONObject&&null!==Z.overlayJSONObject){var l=Z.Utils.jsonConvertObjectToXMLText(Z.overlayJSONObject),l=Z.Utils.xmlConvertTextToDoc(l);e.parseImageSetXML(l,"overlay")}else{var X=new Z.NetConnector;".xml"!=Z.imageSetPath.toLowerCase().substring(Z.imageSetPath.length-4,Z.imageSetPath.length)&&(Z.imageSetPath=Z.imageSetPath+"/"+Z.Utils.getResource("DEFAULT_IMAGESETXMLFILE"));l=Z.Utils.cacheProofPath(Z.imageSetPath);
X.loadXML(l)}else Z.Viewport=new Z.ZoomifyViewport,Z.viewportCurrent=Z.Viewport}};this.configureComponents=function(a){0<Z.toolbarVisible&&!Z.Toolbar&&(Z.Toolbar=new Z.ZoomifyToolbar(a));0<Z.navigatorVisible&&!Z.Navigator&&(Z.Navigator=new Z.ZoomifyNavigator(a),Z.Navigator&&Z.Navigator.z682());Z.helpCustom&&(new Z.NetConnector).loadHTML(Z.helpPath,e.receiveHelpHTML,null,"loadHTML")};this.receiveHelpHTML=function(a){4==a.readyState&&200==a.status&&Z.Utils.stringValidate(a.responseText)&&(Z.helpContent=
a.responseText)};this.getVersion=function(){return Z.version};this.setSizeAndPosition=function(a,b,c,d,e){Z.viewerW=a;Z.viewerH=b;Z.ViewerDisplay.style.width=a+"px";Z.ViewerDisplay.style.height=b+"px";Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setSizeAndPosition(a,b,c,d);b=1==Z.toolbarPosition?b-Z.toolbarH:0;Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&(Z.Toolbar.setSizeAndPosition(a,null,null,b),0!=Z.toolbarVisible&&8!=Z.toolbarVisible&&Z.Toolbar.show(!0));Z.Navigator&&
Z.Navigator.getInitialized()&&(Z.Navigator.setSizeAndPosition(null,null,0==Z.navigatorL?c:Z.navigatorL+Z.navigatorW>a?a-Z.navigatorW:Z.navigatorL,0!=Z.navigatorT?Z.navigatorT:d,Z.navigatorFit),1<Z.navigatorVisible&&Z.Navigator.setVisibility(!0));e&&Z.Viewport.updateView(!0)};this.getImagePath=function(){return e.getImage()};this.getImage=function(){return Z.imagePath};this.getStatus=function(a){a=Z.Utils.arrayIndexOfObjectValue(g,"state",a);return-1==a?!1:g[a].status};this.setStatus=function(a,b){var c=
!1,d=Z.Utils.arrayIndexOfObjectValue(g,"state",a);-1==d?(c=b,g[g.length]={state:a,status:b}):(!g[d].status&&b&&(c=!0),g[d].status=b);c&&(Z.Utils.validateCallback(a),e.validateViewerReady(a))};this.validateViewerStatus=function(a){var b=!0;if(Z.imageSet)for(var c=0,d=Z.imageSetLength;c<d;c++)if(!Z["Viewport"+c.toString()].getStatus(a)){b=!1;break}b&&(b=a.indexOf("Viewport"),-1!=b&&(a=a.substring(0,b)),e.setStatus(a+"Viewer",!0))};this.validateViewerReady=function(a){a=Z.Viewport&&Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&
("unconverted"==Z.tileSource||Z.Viewport.getStatus("precacheLoadedViewport")&&Z.Viewport.getStatus("backfillLoadedViewport")&&Z.Viewport.getStatus("backfillDrawnViewport"))&&Z.Viewport.getStatus("displayLoadedViewport")&&Z.Viewport.getStatus("displayDrawnViewport");var b=!Z.hotspots||Z.Viewport&&Z.Viewport.getStatus("hotspotsLoadedViewport"),c=!Z.annotations||Z.Viewport&&Z.Viewport.getStatus("annotationsLoadedViewport")&&(!Z.annotationPanelVisible||Z.Viewport.getStatus("annotationPanelInitializedViewport")),
d=0==Z.ToolbarVisible||Z.Toolbar&&Z.Toolbar.getInitialized(),e=!Z.NavigatorVisible||Z.Navigator&&Z.Navigator.getInitialized(),g=!Z.GalleryVisible||Z.Gallery&&Z.Gallery.getInitialized(),l=!Z.RulerVisible||Z.Ruler&&Z.Ruler.getInitialized(),U=!Z.imageSet||Z.Viewer&&Z.Viewer.getStatus("initializedViewer")&&("unconverted"==Z.tileSource||Z.Viewer.getStatus("precacheLoadedViewer")&&Z.Viewer.getStatus("backfillLoadedViewer")&&Z.Viewer.getStatus("backfillDrawnViewer"))&&Z.Viewer.getStatus("displayLoadedViewer")&&
Z.Viewer.getStatus("displayDrawnViewer"),k=!Z.imageSet||!Z.hotspots||Z.Viewer&&Z.Viewer.getStatus("hotspotsLoadedViewer"),u=!Z.imageSet||!Z.annotations||Z.Viewer&&Z.Viewer.getStatus("annotationsLoadedViewer")&&(!Z.annotationPanelVisible||Z.Viewer.getStatus("annotationPanelInitializedViewer"));(a=a&&b&&c&&d&&e&&g&&l&&U&&k&&u)&&Z.Viewer.setStatus("readyViewer",!0);return a};this.initializeViewerKeyEventListeners=function(a){a?(Z.Utils.addEventListener(document,"keydown",c),Z.Utils.addEventListener(document,
"keyup",c)):(Z.Utils.removeEventListener(document,"keydown",c),Z.Utils.removeEventListener(document,"keyup",c))};this.initializeViewerKeyDefaultListeners=function(a){a?(Z.Utils.addEventListener(document,"keydown",Z.Utils.preventDefault),Z.Utils.addEventListener(document,"keyup",Z.Utils.preventDefault)):(Z.Utils.removeEventListener(document,"keydown",Z.Utils.preventDefault),Z.Utils.removeEventListener(document,"keyup",Z.Utils.preventDefault))};this.viewerEventsHandler=function(a){d(a)};this.z586=function(a){Z.mouseWheelIsDown=
!1;Z.mouseWheelCompleteTimer&&(window.clearTimeout(Z.mouseWheelCompleteTimer),Z.mouseWheelCompleteTimer=null,Z.zooming="stop",Z.viewportCurrent.updateView(!0))}};
Z.ZoomifyViewport=function(a,b,c,d,e,g){function l(a,b,R,c,d,f,e,n,g,Ub,m){Z.useCanvas&&(I&&(na=I.getContext("2d")),rb=V.getContext("2d"),oa=aa.getContext("2d"),Bb=za.getContext("2d"),Cb&&(qc=Cb.getContext("2d")),Va&&(rc=Va.getContext("2d")),fc&&(sc=fc.getContext("2d")),Vc&&Vc.getContext("2d"),Z.imageFilters&&(md.getContext("2d"),nd.getContext("2d")));Z.imageW=a;Z.imageH=b;Z.imageCtrX=Z.imageW/2;Z.imageCtrY=Z.imageH/2;Z.imageD=Math.round(Math.sqrt(a*a+b*b));tc=d;Ea=R;Fa=c;if("unconverted"==Z.tileSource)va[0]=
Z.imageW,Ga[0]=Z.imageH,pa[0]=1,Ha[0]=1,wa=Ma[0]=1;else if("ZoomifyImageFile"==Z.tileSource)for(a=wa-1;0<=a;a--)pa[a]=Math.ceil(va[a]/Ea),Ha[a]=Math.ceil(Ga[a]/Fa),Ma[a]=pa[a]*Ha[a];else{a=Z.imageW;for(b=Z.imageH;a>Ea||b>Fa;)a/=2,b/=2,wa++;a=Z.imageW;b=Z.imageH;R=0;for(c=wa-1;0<=c;c--)va[c]=a,Ga[c]=b,pa[c]=Math.ceil(va[c]/Ea),Ha[c]=Math.ceil(Ga[c]/Fa),Ma[c]=pa[c]*Ha[c],a/=2,b/=2,R+=Ma[c];if(R!=tc&&("ZoomifyImageFolder"==Z.tileSource||"ZoomifyImageFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)){va=
[];Ga=[];pa=[];Ha=[];wa=1;a=Z.imageW;b=Z.imageH;for(R=2;a>Ea||b>Fa;)a=Math.floor(Z.imageW/R),b=Math.floor(Z.imageH/R),R*=2,a%2&&a++,b%2&&b++,wa++;a=Z.imageW;b=Z.imageH;R=2;tileCounter=0;for(c=wa-1;0<=c;c--)pa[c]=Math.floor(a/Ea),a%Ea&&pa[c]++,Ha[c]=Math.floor(b/Fa),b%Fa&&Ha[c]++,Ma[c]=pa[c]*Ha[c],tileCounter+=Ma[c],va[c]=a,Ga[c]=b,a=Math.floor(Z.imageW/R),b=Math.floor(Z.imageH/R),R*=2,a%2&&a++,b%2&&b++;a=tileCounter;a!=tc&&Z.Utils.showMessage(Z.Utils.getResource("z254"),!1,Z.messageDurationStandard,
"center")}}v(O,K,Wc,gc);h.validateXYZDefaults();wa>Xc?(Ia=x(Na,Z.initialZ),I&&na.scale(Ia,Ia)):na=Wa=I=null;Xa=x(ka,Z.initialZ);sb=S=x(G,Z.initialZ);if(Z.useCanvas)try{oa.scale(S,S)}catch(l){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE"),!1,Z.messageDurationStandard,"center"),console.log("In function initializeViewportContinue scaling canvas:  "+l)}"unconverted"!=Z.tileSource&&h.z619();Lb(Z.initialX,Z.initialY,Z.initialZ,Z.initialR,null,!0);Z.Utils.addEventListener(P,
"mousedown",L);Z.Utils.addEventListener(P,"mousemove",Z.Utils.preventDefault);Z.Utils.addEventListener(P,"touchstart",L);Z.Utils.addEventListener(P,"touchmove",L);Z.Utils.addEventListener(P,"touchend",L);Z.Utils.addEventListener(P,"touchcancel",L);Z.Utils.addEventListener(P,"gesturestart",L);Z.Utils.addEventListener(P,"gesturechange",L);Z.Utils.addEventListener(P,"gestureend",L);Z.Utils.addEventListener(V,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(aa,"contextmenu",Z.Utils.preventDefault);
Vb&&Z.Utils.addEventListener(Vb,"contextmenu",Z.Utils.preventDefault);Yc&&Z.Utils.addEventListener(Yc,"contextmenu",Z.Utils.preventDefault);h.setStatus("initializedViewport",!0);h.syncViewportRelated()}function p(){wa=1;ka=G=0;uc=vc=wc=fa=!1;"undefined"!==typeof va&&Z.Utils.arrayClear(va);"undefined"!==typeof Ga&&Z.Utils.arrayClear(Ga);"undefined"!==typeof pa&&Z.Utils.arrayClear(pa);"undefined"!==typeof Ha&&Z.Utils.arrayClear(Ha);"undefined"!==typeof Ma&&Z.Utils.arrayClear(Ma);"undefined"!==typeof Db&&
Z.Utils.arrayClear(Db);"undefined"!==typeof tierTileOffsetsCount&&Z.Utils.arrayClear(tierTileOffsetsCount);"undefined"!==typeof tierTileOffsetChunks&&Z.Utils.arrayClear(tierTileOffsetChunks);"undefined"!==typeof tierTileOffsetLast&&Z.Utils.arrayClear(tierTileOffsetLast);"undefined"!==typeof tb&&Z.Utils.arrayClear(tb);"undefined"!==typeof tierTileByteCountsCount&&Z.Utils.arrayClear(tierTileByteCountsCount);"undefined"!==typeof tierTileByteCountChunks&&Z.Utils.arrayClear(tierTileByteCountChunks);"undefined"!==
typeof tierTileByteCountLast&&Z.Utils.arrayClear(tierTileByteCountLast)}function v(a,b,R,c){if("undefined"===typeof R||null===R)R=0;if("undefined"===typeof c||null===c)c=0;Z.viewerW=O=a;Z.viewerH=K=b;da=O*Zc;ea=K*Zc;a=Z.imageSet?od:"unconverted"==Z.tileSource&&Z.mobileDevice?pd:"unconverted"==Z.tileSource&&Z.browser==Z.browsers.FIREFOX?qd:rd;b=Z.constrainPanStrict?Z.imageW:2*Z.imageW;var d=Z.constrainPanStrict?Z.imageH:2*Z.imageH;da>a&&(da=a);ea>a&&(ea=a);da>b&&(da=b);ea>d&&(ea=d);da<O&&(da=O);ea<
K&&(ea=K);Ja=Z.Utils.roundToFixed(da/2,4);Ka=Z.Utils.roundToFixed(ea/2,4);la=Z.Utils.roundToFixed(-((da-O)/2)+R,4);Z.Utils.roundToFixed((da-O)/2+R,4);ma=Z.Utils.roundToFixed(-((ea-K)/2)+c,4);Z.Utils.roundToFixed((ea-K)/2+c,4);I&&(I.width=O,I.height=K,Wa.width=O+"px",Wa.height=K+"px",Wa.left="0px",Wa.top="0px");P.width=da;P.height=ea;y.width=da+"px";y.height=ea+"px";y.left=la+"px";y.top=ma+"px";aa.width=da;aa.height=ea;ha.width=da+"px";ha.height=ea+"px";if(Z.useCanvas){I&&(na.translate(O/2,K/2),na.save());
try{oa.translate(Ja,Ka)}catch(f){Z.Utils.showMessage(Z.Utils.getResource("ERROR_TRANSLATINGCANVASFORUNCONVERTEDIMAGE"),!1,Z.messageDurationStandard,"center")}oa.save();fc&&(sc.translate(Ja,Ka),sc.save());Cb&&(qc.translate(Ja,Ka),qc.save());Va&&(rc.translate(Ja,Ka),rc.save())}}function B(a,b,R){if("ZoomifyImageFile"==Z.tileSource){R=parseFloat(Z.Utils.getResource("z125"));var c=parseFloat(Z.Utils.getResource("z124"));b.loadByteRange(a,R,c,"header")}else"ZoomifyImageFolder"==Z.tileSource&&(a=Z.Utils.cacheProofPath(a+
"/ImageProperties.xml"),b.loadXML(a,R))}function D(a,b){p();if("undefined"===typeof h.getStatus)window.setTimeout(function(){D(a,b)},100);else{var R=null,c=null,d=null,f=null,e=null,n=null;"ZoomifyImageFolder"==Z.tileSource&&(R=parseInt(a.documentElement.getAttribute("WIDTH"),10),c=parseInt(a.documentElement.getAttribute("HEIGHT"),10),e=parseInt(a.documentElement.getAttribute("NUMTILES"),10),parseInt(a.documentElement.getAttribute("NUMIMAGES"),10),n=parseInt(a.documentElement.getAttribute("VERSION"),
10),d=f=parseInt(a.documentElement.getAttribute("TILESIZE"),10));null!==Z.tileW&&(d=Z.tileW);null!==Z.tileH&&(f=Z.tileH);if("ZoomifyImageFolder"==Z.tileSource||"IIIFImageServer"==Z.tileSource||"ImageServer"==Z.tileSource){if(null===d||isNaN(d))d=Ea;if(null===f||isNaN(f))f=Fa;if(null===e||isNaN(e))e=1}!isNaN(R)&&0<R&&!isNaN(c)&&0<c&&!isNaN(d)&&0<d&&!isNaN(f)&&0<f&&0<e?h.getStatus("initializedViewport")||l(R,c,d,f,e,n,null,null,null,null,null,b):"ZoomifyImageFolder"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z252"),
!1,Z.messageDurationStandard,"center"):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}}function X(a,b){for(var c=pa[a]-1,J=Ha[a]-1,d=0;d<=c;d++)for(var f=0;f<=J;f++)b[b.length]=a+"-"+d+"-"+f}function N(a){if(a){a=h.z542(ka);Z.Utils.arrayClear(qa);Z.Utils.arrayClear(kb);b=a.l;for(c=a.r;b<=c;b++)for(J=a.t,d=a.b;J<=d;J++)f=ka+"-"+b+"-"+J,kb[kb.length]=f,qa[qa.length]=f;A(qa,Q,"simple","image-backfill")}else{Z.Utils.arrayClear(lb);Z.Utils.arrayClear(mb);Z.Utils.arrayClear(Ya);
Z.Utils.arrayClear(W);a=h.z542();for(var b=a.l,c=a.r;b<=c;b++)for(var J=a.t,d=a.b;J<=d;J++){var f=G+"-"+b+"-"+J;lb[lb.length]=f;W[W.length]=f}if(h.getStatus("initializedViewport")&&0<ta.length&&(G==hc||G==ic||G==Wb))for(b=0,c=ta.length;b<c;b++)(J=ta[b])&&J.t==G&&J.c>=a.l&&J.c<=a.r&&J.r>=a.t&&J.r<=a.b&&(Ya[Ya.length]=J.name,mb[mb.length]=J,d=Z.Utils.arrayIndexOf(W,J.name),-1!=d&&(W=Z.Utils.arraySplice(W,d,1)));b=0;for(c=xa.length;b<c;b++)(J=xa[b])&&J.t==G&&J.c>=a.l&&J.c<=a.r&&J.r>=a.t&&J.r<=a.b&&(d=
Z.Utils.arrayIndexOf(Ya,J.name),-1==d&&(Ya[Ya.length]=J.name,mb[mb.length]=J),J=Z.Utils.arrayIndexOf(W,J.name),-1!=J&&(W=Z.Utils.arraySplice(W,J,1)));if(0!=jc){b=0;for(c=Ua.length;b<c;b++)J=Ua[b],J.alpha=1;Z.Utils.arrayClear(Ua);Z.Utils.arrayClear(ub)}h.traceDebugValues("tilesToDisplay",null,lb.length,lb);h.traceDebugValues("tilesInCache",null,Ya.length,Ya);h.traceDebugValues("tilesToLoad",null,W.length,W)}}function w(a,b,c,d,e,f){e||Z.Utils.clearDisplay(a);if("canvasCopy"==d)Z.Utils.clearDisplay(aa),
oa.restore(),oa.save(),oa.scale(1,1),oa.drawImage(za,-Ja,-Ka),oa.restore(),oa.save(),oa.scale(S,S);else{e=h.z542(b);f=[];if(null===c)for(var Y=0,n=mb.length;Y<n;Y++)f[Y]=mb[Y];else if(0<c.length)for(Y=0,n=c.length;Y<n;Y++){var g=c[Y];g&&g.t==b&&(b==ka&&!fa||g.c>=e.l&&g.c<=e.r&&g.r>=e.t&&g.r<=e.b)&&(f[f.length]=c[Y])}if(0<f.length)if(h.traceDebugValues("z622-"+a.id,null,null,f),"centerOut"==d)for(Y=Math.floor(f.length/2),n=f.length;Y<n;Y++)Aa(a,b,f[Y]),f.length-Y-1!=Y&&Aa(a,b,f[f.length-Y-1]);else for(Y=
0,n=f.length;Y<n;Y++)Aa(a,b,f[Y]);else h.traceDebugValues("No cached tiles in view");h.traceDebugValues("blankLine")}}function U(a,b){var c=h.z542();syncTransitionCanvas();for(var d=0,e=b.length;d<e;d++){var f=b[d];f&&f.t==a&&(a==ka||f.c>=c.l&&f.c<=c.r&&f.r>=c.t&&f.r<=c.b)&&Aa(za,a,f)}}function k(){if("undefined"!==typeof Ba){var a=Z.Utils.createContainerElement("div","testImageContainer","inline-block","absolute","hidden",O+"px",K+"px","0px","0px","none","0px","transparent none","0px","0px","normal",
null,!0);a.appendChild(Ba);a.removeChild(Ba);var a=null,a=Ba.width,b=Ba.height;0!=a&&0!=b?l(a,b,a,b,null,null,null,null,null,null,null):window.setTimeout(function(){k()},100)}else window.setTimeout(function(){k()},100)}function u(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNCONVERTEDIMAGEPATHINVALID"))}function A(a,b,c,d){var e="undefined"!==typeof d&&null!==d?"-"+d:"";if(0<a.length){h.traceDebugValues("z577"+e,null,null,a);e=(new Date).getTime();if("centerOut"==c&&4<a.length){var f=[],Y=0,
n=0,g=0,Ub=0;for(c=0;c<a.length;c++){var m=a[c];m&&(m=new M(m,d),f[f.length]=m,0==c?(Y=n=m.c,g=Ub=m.r):(m.c<Y?Y=m.c:m.c>n&&(n=m.c),m.r<g?g=m.r:m.r>Ub&&(Ub=m.r)))}a=Y+(n-Y)/2;d=g+(Ub-g)/2;for(c=0;c<f.length;c++)f[c].r-=d,f[c].c-=a;f.sort(function(a,b){return a.r*a.r+a.c*a.c-(b.r*b.r+b.c*b.c)});for(c=0;c<f.length;c++)f[c].r+=d,f[c].c+=a,T(f[c],e,b)}else for(c=0,f=a.length;c<f;c++)if(m=a[c])m=new M(m,d),T(m,e,b);h.traceDebugValues("blankLine")}else h.traceDebugValues("z577"+e,"No new tiles requested")}
function M(a,b){this.imagePath=Z.imagePath;this.name=a;var c=new ba(a);this.t=c.t;this.c=c.c;this.r=c.r;this.x=Math.floor(this.c*Ea);this.y=Math.floor(this.r*Fa);this.image=null;this.alpha=0;this.url=h.formatTilePath(this.t,this.c,this.r,b);this.style=this.elmt=this.loadTime=null}function ba(a){this.t=parseInt(a.substring(0,a.indexOf("-")),10);this.c=parseInt(a.substring(a.indexOf("-")+1,a.lastIndexOf("-")),10);this.r=parseInt(a.substring(a.lastIndexOf("-")+1),10)}function Za(a,b,c){c=b+c*pa[a];b=
8*c+Db[a];c=Math.floor(c/vb);var d=c*vb,d=d+vb>Ma[a]?8*(Ma[a]-d):$c;this.chunkStart=Db[a]+c*$c;this.chunkEnd=this.chunkStart+d;this.offsetStartInChunk=b-this.chunkStart;this.chunkID=a.toString()+"-"+c.toString()}function ga(a,b,c){c=b+c*pa[a];b=4*c+tb[a];c=Math.floor(c/vb);var d=c*vb,d=d+vb>Ma[a]?4*(Ma[a]-d):ad;this.chunkStart=tb[a]+c*ad;this.chunkEnd=this.chunkStart+d;this.bcStartInChunk=b-this.chunkStart;this.chunkID=a.toString()+"-"+c.toString()}function ua(a,b){for(var c=0,d=ra.length;c<d;c++){var e=
ra[c].split(",");e[0]==a&&e[5]==b&&(void 0!==e[4]&&"image-display"==e[4]?$a[$a.length]=e[1]+"-"+e[2]+"-"+e[3]:"image-backfill"==e[4]&&(Qa[Qa.length]=e[1]+"-"+e[2]+"-"+e[3]),ra=Z.Utils.arraySplice(ra,c,1),c--,d--)}0<$a.length&&($a.sort(),$a=Z.Utils.arrayUnique($a),h.traceDebugValues("z637",$a),c=h.getStatus("imageSaving")?ab:E,ya($a,c,"simple","image-display"));0<Qa.length&&(Qa.sort(),Qa=Z.Utils.arrayUnique(Qa),c=h.getStatus("imageSaving")?z599ToSave:Q,ya(Qa,c,"simple","image-backfill"))}function ya(a,
b,c,d){c=(new Date).getTime();for(var e=0,f=a.length;e<f;e++){var m=null;if(m=a[e])a=Z.Utils.arraySplice(a,e,1),e--,f--,index=Z.Utils.arrayIndexOfObjectValue(nb,"name",m),-1!=index?(m=nb[index],nb=Z.Utils.arraySplice(nb,index,1),m.url=h.formatTilePath(m.t,m.c,m.r,d)):m=new M(m,d),null!=m&&-1==m.url.indexOf("NaN")?(h.traceDebugValues("z577Retry",m.name+"  "+m.url),T(m,c,b)):-1==m.url.indexOf("NaN")&&Z.Utils.showMessage(Z.Utils.getResource("z280-ZIF")+m.name+".jpg",!1,Z.messageDurationShort,"center",
!1)}}function T(a,b,c){var d=a.name;if("offsetLoading"==a.url)-1==Z.Utils.arrayIndexOfObjectValue(nb,"name",d)&&(nb[nb.length]=a),h.traceDebugValues("z581DelayForOffset",d);else if("offsetLoading"!=a.url){var e;if(c==E||c==ab)e="image-display";else if(c==Q||c==z599ToSave)e="image-backfill";var f=a.t==hc&&wc||a.t==ic&&vc||a.t==Wb&&uc;"image-display"==e&&f||(a.loadTime=b,h.traceDebugValues("z581-"+e,d),sd.loadImage(a.url,Z.Utils.createCallback(null,c,a),e,a))}}function E(a,b){if(a&&b&&a.imagePath==
Z.imagePath){a.image=b;var c=a.name,d=Z.Utils.arrayIndexOf(W,c);if(-1!=d){W=Z.Utils.arraySplice(W,d,1);xc(a);if(Z.preloadVisible&&!Z.imageSet&&a.t!=G){Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADING-STORINGORDRAWINGTILES")+"   Tile: "+c,!1,Z.messageDurationShort/10,"center");a.alpha=1;return}-1==Z.Utils.arrayIndexOf(ub,c)&&(ub[ub.length]=c,Ua[Ua.length]=a);Z.preloadVisible&&Z.imageSet&&h.getViewportID()!=Z.viewportCurrentID&&(c=(h.getViewportID()+1).toString()+" of "+Z.imageSetLength.toString()+
"   Tile: "+c,Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADING-STORINGORDRAWINGTILES")+c,!1,Z.messageDurationShort/10,"center"));kc||(kc=window.setInterval(Eb,50));jc=W.length;if(0==jc)for(Z.useCanvas&&0<Mb&&(yc?(U(G,xa),w(aa,G,xa,"canvasCopy",!1,"4. Updating view: all new tiles loaded"),window.setTimeout(function(){Z.Utils.clearDisplay(za)},200),yc=!1):w(aa,G,xa,"centerOut",!1,"4. Updating view: all new tiles loaded"));bb.length>Mb&&xa.length>Mb;)bb=Z.Utils.arraySplice(bb,0,1),xa=Z.Utils.arraySplice(xa,
0,1);h.traceDebugValues("onTileLoad",a.name,a.loadTime)}zc==Ac+Fb&&h.setStatus("displayLoadedViewport",!0)}else"undefined"!==typeof b&&null!==b||console.log(Z.Utils.getResource("z280")+a.name+".jpg")}function Q(a,b){if(a&&b&&a.imagePath==Z.imagePath){a.image=b;var c=a.name;ta[ta.length]=a;var d=Z.Utils.arrayIndexOf(qa,c);-1!=d&&(qa=Z.Utils.arraySplice(qa,d,1));if("ZoomifyImageFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)c=Z.Utils.arrayIndexOf(Qa,c),-1!=c&&(Qa=Z.Utils.arraySplice(Qa,c,1));a.alpha=
1;a.t==ka&&Aa(V,ka,a);h.traceDebugValues("onTileBackfillPrecache",a.name);bd==Bc&&h.setStatus("precacheLoadedViewport",!0);h.traceDebugValues("z599",a.name);Cc<=0+Dc&&h.setStatus("backfillLoadedViewport",!0);a.t==G&&E(a,b)}else if("undefined"===typeof b||null===b)Z.mobileDevice?console.log(Z.Utils.getResource("z280")+a.name+".jpg"):Z.Utils.showMessage(Z.Utils.getResource("z280")+a.name+".jpg")}function Eb(){for(var a=0,b=0,c=Ua.length;b<c;b++){var d=Ua[b];d.t==G?(Z.fadeIn&&0!=Ec&&1>d.alpha+Ec?d.alpha+=
Ec:(d.alpha=1,a++),Aa(aa,G,d),a>=c&&(window.clearInterval(kc),kc=null,b=c)):(Ua=Z.Utils.arraySplice(Ua,b,1),ub=Z.Utils.arraySplice(ub,b,1),d=Z.Utils.arrayIndexOf(W,d.name),-1!=d&&(W=Z.Utils.arraySplice(W,d,1)),c--)}}function Aa(a,b,c){if("z647"!=c.url.substr(0,8)&&0!=c.image.width&&0!=c.image.height){var d=c.x,e=c.y;b=F(b,1);Ia=x(Na,h.getZoom());var f=8<Ia;Z.useCanvas?(a==aa||a==za||a==V&&fa?(d-=Z.imageX*b,e-=Z.imageY*b):a==I&&(fa||f)&&(f=h.calculateCurrentCenterCoordinates(),d-=f.x*b,e-=f.y*b),b=
a.getContext("2d"),Z.alphaSupported&&1>c.alpha&&"transitionCanvas"!=a.id&&-1==a.id.indexOf("oversizeDisplay")&&"savingDisplay"!=a.id&&(b.globalAlpha=c.alpha),Z.imageFilters&&0!=imageFiltersApplied.length?(f=z456(c.name,c.image),Z.Utils.clearDisplay(za),Bb.putImageData(f,0,0),b.drawImage(za,d,e)):b.drawImage(c.image,d,e),Z.alphaSupported&&1>c.alpha&&"transitionCanvas"!=a.id&&"oversizeDisplay"!=a.id&&"savingDisplay"!=a.id&&(b.globalAlpha=1),2!=Z.debug&&4!=Z.debug||wb(a,c.name,d,e,S)):(a==aa?(d-=Z.imageX*
b-Ja/S,e-=Z.imageY*b-Ka/S,b=S):b=Xa,c.elmt||(c.elmt=Z.Utils.createContainerElement("img"),c.elmt.onmousedown=Z.Utils.preventDefault,Z.Utils.addEventListener(c.elmt,"contextmenu",Z.Utils.preventDefault),c.elmt.src=c.url,c.style=c.elmt.style,c.style.position="absolute",Z.Utils.renderQuality(c,Z.renderQuality),Z.cssTransformsSupported&&(c.style[Z.cssTransformProperty+"Origin"]="0px 0px")),c.elmt.parentNode!=a&&a.appendChild(c.elmt),f=c.style,f.display="none",Z.cssTransformsSupported?f[Z.cssTransformProperty]=
["matrix(",(c.image.width/c.elmt.width*b).toFixed(8),",0,0,",(c.image.height/c.elmt.height*b).toFixed(8),",",(d*b).toFixed(8),Z.cssTransformNoUnits?",":"px,",(e*b).toFixed(8),Z.cssTransformNoUnits?")":"px)"].join(""):(f.width=c.image.width*b+"px",f.height=c.image.height*b+"px",f.left=d*b+"px",f.top=e*b+"px"),f.display="inline-block",Z.Utils.setOpacity(c,c.alpha),2!=Z.debug&&4!=Z.debug||wb(a,c.name,d,e,b));a==aa?(h.traceDebugValues("z507",c.name),zc==lc&&h.setStatus("displayDrawnViewport",!0)):(h.traceDebugValues("displayBackfillTile",
c.name),Cc<=Fc&&h.setStatus("backfillDrawnViewport",!0))}}function wb(a,b,c,d,e){if(Z.useCanvas){var f=parseInt(Z.Utils.getResource("z129"),10),h=parseInt(Z.Utils.getResource("z160"),10),n=parseInt(Z.Utils.getResource("z151"),10),f=Math.round(f*e),h=2*(f<h?h:f>n?n:f);a=a.getContext("2d");a.font=h+"px verdana";a.textAlign="left";a.textBaseline="top";h=Ea*e/2;e=Fa*e/2;a.fillStyle="#FFFFFF";a.fillText(b,c+h,d+e);a.fillStyle="#000000";a.fillText(b,c+h+1,d+e+1)}else{var f=parseInt(Z.Utils.getResource("z129"),
10),h=parseInt(Z.Utils.getResource("z160"),10),n=parseInt(Z.Utils.getResource("z151"),10),f=Math.round(f*e),m=2*(f<h?h:f>n?n:f),h=parseInt(Z.Utils.getResource("z130"),10)*e,n=Z.Utils.createContainerElement("div","tileNameTextBox","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent none","0px",h+"px","nowrap"),f=document.createTextNode(b);n.appendChild(f);a.appendChild(n);Z.Utils.setTextNodeStyle(f,"white","verdana",m+"px","none","normal","normal","normal","normal",
"1em","center","none");var g=Z.Utils.createContainerElement("div","tileNameTextBox2","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent none","0px",h+"px","nowrap"),l=document.createTextNode(b);g.appendChild(l);a.appendChild(g);Z.Utils.setTextNodeStyle(l,"black","verdana",m+"px","none","normal","normal","normal","normal","1em","center","none");h=parseFloat(n.style.padding);a=parseFloat(Z.Utils.getElementStyleProperty(n,"width"));isNaN(a)&&(a=parseFloat(Z.Utils.getResource("z115")),
a=parseFloat(n.style.fontSize)/a,a=Math.round(parseFloat(b.length*a)));b=Ea*e/2;m=Fa*e/2;n.style.left=c*e+(b-a/2-h)+"px";n.style.top=d*e+m+"px";g.style.left=1+c*e+(b-a/2-h)+"px";g.style.top=1+d*e+m+"px";Z.Utils.addEventListener(n,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(f);Z.Utils.addEventListener(g,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(l)}}function ia(a,b){var c=F(b,1),d=Math.floor(a.l*c/Ea),e=Math.floor(a.r*c/Ea),f=Math.floor(a.t*c/Fa),
c=Math.floor(a.b*c/Fa);0>d&&(d=0);e>pa[b]-1&&(e=pa[b]-1);0>f&&(f=0);c>Ha[b]-1&&(c=Ha[b]-1);this.l=d;this.r=e;this.t=f;this.b=c}function r(a,b,c,d,e,f,h,n,m){"undefined"===typeof n||null===n?(this.l=a+c/h,this.r=a+d/h,this.t=b+e/h,this.b=b+f/h):(h=O/va[n],n=K/Ga[n],this.l=a+c*h,this.r=a+d*h,this.t=b+e*n,this.b=b+f*n);m&&(this.l-=256-this.l%256,this.r+=256-this.r%256,this.t-=256-this.t%256,this.b+=256-this.b%256)}function F(a,b){return va[a]/Z.imageW*b}function x(a,b){return b/(va[a]/Z.imageW)}function ca(a,
b,c,d,e){if(Z.constrainPan){c="undefined"!==typeof c&&null!==c?c:Z.imageZ;d="undefined"!==typeof d&&null!==d?Math.round(d):Math.round(Z.imageR);0>d&&(d+=360);var f=a,m=b;"image"==e&&(b=h.convertImageCoordsToViewportEdgeCoords(a,b,c,d),a=b.x,b=b.y);var n=Z.imageW,g=Z.imageH,l=Math.round(n*c),k=Math.round(g*c);Math.round(n*c/2);Math.round(g*c/2);var n=O,g=K,L=Math.round(.1*O),A=Math.round(.1*K),u=Math.round(.5*O),M=Math.round(.5*K),t,p;t=u-la+(Z.imageCtrX-Z.imageX)*c+a;p=M-ma+(Z.imageCtrY-Z.imageY)*
c+b;var fb=t+l/2,y=p-k/2,w=t+l/2,D=p+k/2,x=t-l/2,r=p+k/2,ba=Z.Utils.getPositionRotated(t-l/2,p-k/2,t,p,d),fb=Z.Utils.getPositionRotated(fb,y,t,p,d),w=Z.Utils.getPositionRotated(w,D,t,p,d),r=Z.Utils.getPositionRotated(x,r,t,p,d);t=Math.min(ba.x,fb.x,w.x,r.x);p=Math.min(ba.y,fb.y,w.y,r.y);x=Math.max(ba.x,fb.x,w.x,r.x);ba=Math.max(ba.y,fb.y,w.y,r.y);x-t>n||!Z.constrainPanStrict?3==Z.constrainPanLimit?a=0<t?a-t:x<n?a-(x-n):a:2==Z.constrainPanLimit?a=t>u?a-(t-u):x<u?a-(x-u):a:1==Z.constrainPanLimit&&(a=
t>9*L?a-(t-9*L):x<L?a-(x-L):a):a=t>u-l/2?a-(t-(u-l/2)):x<u+l/2?a-(x-(u+l/2)):a;ba-p>g||!Z.constrainPanStrict?3==Z.constrainPanLimit?b=0<p?b-p:ba<g?b-(ba-g):b:2==Z.constrainPanLimit?b=p>M?b-(p-M):ba<M?b-(ba-M):b:1==Z.constrainPanLimit&&(b=p>9*A?b-(p-9*A):ba<A?b-(ba-A):b):b=p>M-k/2?b-(p-(M-k/2)):ba<M+k/2?b-(ba-(M+k/2)):b;"image"==e&&(b=h.convertViewportEdgeCoordsToImageCoords(a,b,c,d),a=b.x,b=b.y);if(a!=f||b!=m)a=Math.round(a),b=Math.round(b),Z.Utils.validateCallback("panConstrained")}return new Z.Utils.Point(a,
b)}function cb(a){a>Z.maxZ?(a=Z.maxZ,Z.Utils.validateCallback("zoomConstrainedMax")):a<Z.minZ&&(a=Z.minZ,Z.Utils.validateCallback("zoomConstrainedMin"));return a}function xc(a){if(0<Mb){var b=Z.Utils.arrayIndexOf(bb,a.name);-1!=b&&(bb=Z.Utils.arraySplice(bb,b,1),xa=Z.Utils.arraySplice(xa,b,1));bb[bb.length]=a.name;xa[xa.length]=a}}function Xb(){window.clearTimeout(Nb);Nb=null;Ob=((new Date).getTime()-tilesTimeStart)/1E3;var a=Gc*Ob,a=Pb&&Fb<a,b=Pb&&Fb>=mc;if(2==Z.debug||3==Z.debug)Z.Utils.trace("View validation-time elapsed: "+
Ob),0<Pb&&(a?Z.Utils.trace("Loading delay - re-calling updateView"):b?Z.Utils.trace("Display delay - re-calling updateView"):Z.Utils.trace("Progress slow, resetting timer")),Z.Utils.trace(""),Z.traces.scrollTop=Z.traces.scrollHeight;0<Pb?nc<td?a||b?(nc+=1,h.updateView(!0)):Nb=window.setTimeout(Xb,cd):console.log(Z.Utils.getResource("ERROR_VALIDATEVIEW")):(nc=0,Z.Utils.validateCallback("viewUpdateComplete"),Z.Utils.validateCallback("viewUpdateCompleteGetLabelIDs"))}function ab(a,b,c){}function ob(){Z.preventDupCall||
(Z.priorX=Math.round(Z.imageX),Z.priorY=Math.round(Z.imageY),Z.priorZ=Z.imageZ,Z.priorR=Math.round(Z.imageR));Z.preventDupCall="undefined"!==typeof called&&null!==called}function Lb(a,b,c,d,e,f){f||h.zoomAndPanAllStop();Z.maskingSelection&&Z.maskClearOnUserAction&&h.clearMask();if("undefined"===typeof a||null===a)a=Z.imageW/2;if("undefined"===typeof b||null===b)b=Z.imageH/2;"undefined"===typeof c||null===c?c=Z.fitZ:1<c&&c>Z.maxZ&&(c/=100);if("undefined"===typeof d||null===d)d=Z.imageR;c=cb(c);Z.rotationFree||
(d=90*Math.round(Math.abs(d)/90)*Z.Utils.getSign(d));-360>=d?d+=360:360<=d&&(d-=360);a=ca(a,b,c,d,"image");Z.imageX=Hc=a.x;Z.imageY=Ic=a.y;Z.imageZ=c;d!=Z.imageR&&Z.Utils.rotateElement(y,d);Z.imageR=d;h.updateView(!0);"function"===typeof e&&e()}function Gb(){if(pb&&(0!=Ca||0!=Da||0!=La))if(Z.tracking&&0==La)h.zoomAndPanToView(h.getX()+Ca,h.getY()+Da);else{var a=Ca,b=Da,c=La,d=h.getZoom();0!=c&&(d=F(G,S*(1+c)),d=cb(d),d!=Z.imageZ&&m(d));if(0!=a||0!=b)a=parseFloat(y.left)+a,b=parseFloat(y.top)+b,d=
ca(a,b,d,Z.imageR,"container"),y.left=Math.round(d.x)+"px",y.top=Math.round(d.y)+"px",b=d.x-la,d=d.y-ma,I&&fa&&(Z.mobileDevice||Math.abs(b)>O/2||Math.abs(d)>K/2)&&w(I,Na,ta,"simple",!1,"Updating backfill oversize display");h.syncViewportRelated();dd++;pb=window.setTimeout(Gb,Jc)}}function Yb(a,b,c,d,e,f,g){Zb++;var n=e/f,l=Zb*n,k=Z.Utils.easing(Z.imageX,a,l,e),q=Z.Utils.easing(Z.imageY,b,l,e),L=Z.Utils.easing(Z.imageZ,c,l,e),l=Z.Utils.easing(Z.imageR,d,l,e),q=h.convertImageCoordsToViewportEdgeCoords(k,
q,L),k=q.x,q=q.y,u=!1,A=syncOversize=!1;if(parseFloat(y.left)!=k||parseFloat(y.top)!=q)y.left=k+"px",y.top=q+"px",A=!0,I&&fa&&(syncOversize=!0);L!=Z.imageZ&&(m(L,!1),u=A=!0,I&&fa&&(na.restore(),na.save(),na.scale(Ia,Ia),syncOversize=!0));l!=Z.imageR&&(Z.Utils.rotateElement(y,l),I&&fa&&(na.rotate((l-Z.imageR)*Math.PI/180),syncOversize=!0),Z.imageR=l,A=!0);syncOversize&&w(I,Na,ta,"simple",!1,"Updating backfill oversize display");0==Zb%2&&h.syncViewportRelated(!1,!1,u,A,u);L=Z.tour&&Z.tourStop&&0==Math.round(Z.imageR%
90);Zb<f+1&&!L?xb=window.setTimeout(function(){Yb(a,b,c,d,e,f,g)},n):(L&&(Z.tourPlaying=!1),Z.interactive=!0,xb&&(window.clearTimeout(xb),xb=null),h.updateView(),"function"===typeof g&&g())}function yb(){dd=La=Da=Ca=0;pb&&(window.clearTimeout(pb),pb=null)}function m(a,b){var c=!1,d=x(G,a);if(d!=S){S=d;var c=d/sb,e=da*c,f=ea*c,m=(da-e)/2,n=(ea-f)/2;d<sb&&(d=ca(parseFloat(y.left),parseFloat(y.top),a,Z.imageR,"container"),y.left=d.x+"px",y.top=d.y+"px");if(Z.useCanvas)if(ha.width=e+"px",ha.height=f+
"px",ha.left=m+"px",ha.top=n+"px",Cb&&(Ra.width=e+"px",Ra.height=f+"px",Ra.left=m+"px",Ra.top=n+"px"),Va&&(Sa.width=e+"px",Sa.height=f+"px",Sa.left=m+"px",Sa.top=n+"px"),Ia=x(Na,h.getZoom()),d=8<Ia,fa||d){if(null!==na&&"undefined"===typeof b||null===b||b&&I&&("in"!=Z.zooming||e>Z.scaleThreshold||f>Z.scaleThreshold))na.restore(),na.save(),na.scale(Ia,Ia),na.rotate(Z.imageR*Math.PI/180),w(I,Na,ta,"simple",!1,"Updating backfill oversize display");Xa=c=x(ka,a);e=c/tierBackfillScalePrior;c=db*e;e*=eb;
f=Oa+(db-c)/2;d=Pa+(eb-e)/2;H.width=c+"px";H.height=e+"px";H.left=f+"px";H.top=d+"px"}else I&&Z.Utils.clearDisplay(I),e=db*c,f=eb*c,m=Oa+Z.imageX*(1-c)*Z.imageZ,n=Pa+Z.imageY*(1-c)*Z.imageZ,H.width=e+"px",H.height=f+"px",H.left=m+"px",H.top=n+"px";else w(aa,G,xa,"centerOut",!1,"Scaling: non-canvas zoom"),fa?(c=ed,db=da*c,eb=ea*c,Oa=-(da/c),Pa=-(ea/c),Kc=Ja*c,Lc=Ka*c,V.width=db,V.height=eb,H.width=V.width+"px",H.height=V.height+"px"):(c=Ga[ka],V.width=va[ka],V.height=c,c=Z.imageY*a,Oa=Ja-Z.imageX*
a,Pa=Ka-c),H.left=Oa+"px",H.top=Pa+"px",w(V,ka,ta,"simple",!1,"Scaling: non-canvas zoom - backfill");c=!0}return c}function L(a){a=Z.Utils.event(a);var b=a.type;if(a&&b){var c=Z.Utils.isRightMouseButton(a),d=a.altKey;if("mouseover"!=b&&"mouseout"!=b&&!Z.interactive||"mousedown"==b&&(!Z.interactive||Z.coordinatesVisible&&d)||c)Z.tourStop=!0;else{if("mousedown"==b||"touchstart"==b||Z.tourPlaying&&Z.tourStop)h.zoomAndPanAllStop(),Z.tourStop=!0,Z.interactive=!0;Z.touchSupport&&!Z.clickZoomAndPanBlock&&
"touchmove"!=b&&"gesturechange"!=b&&a.preventDefault();if("mousedown"==b)window.setTimeout(function(){h.zoomAndPanAllStop(!1,!0)},1),Z.maskingSelection&&Z.maskClearOnUserAction&&h.clearMask();else if("touchstart"==b||"gesturestart"==b)c=!1,touch=Z.Utils.getFirstTouch(a),"undefined"!==typeof touch&&null!==touch&&(d=z538(touch.target),null===d?c=!0:(d=d.id.substring(3,d.id.length),d=Z.Utils.arrayIndexOfObjectValue(hotspots,"internalID",d),-1!=d&&(d=hotspots[d],null!==d&&"function"==d.clickURL&&(c=!0)))),
c&&a.preventDefault(),h.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&h.clearMask();switch(b){case "mouseover":Z.fullView||"TEXTAREA"==document.activeElement.tagName||Z.Viewer.initializeViewerKeyDefaultListeners(!0);break;case "mousedown":!Z.fullView&&document.activeElement&&document.activeElement.blur();Z.Viewer.initializeViewerKeyEventListeners(!0);Z.Utils.addEventListener(document,"mousemove",L);Z.Utils.addEventListener(document,"mouseup",L);break;case "mouseup":Z.Utils.removeEventListener(document,
"mousemove",L),Z.Utils.removeEventListener(document,"mouseup",L)}fb(a);if("mousedown"==b||"mousemove"==b)return!1}}}function fb(b){var c=Hb.toString();b=Z.Utils.event(b);var d=b.type;if(b&&d){var e,m,f;if("touchstart"==d||"touchmove"==d||"touchend"==d||"touchcancel"==d)e=Z.Utils.getFirstTouch(b),"undefined"!==typeof e&&(m=e.target,f=new Z.Utils.Point(e.pageX,e.pageY));else{m=Z.Utils.target(b);Z.Utils.relatedTarget(b);var g=Z.Utils.isRightMouseButton(b),n=b.altKey;"resize"!=d&&(f=Z.Utils.getMousePosition(b));
Z.smoothPan&&(Ib=f)}"DOMMouseScroll"==d&&(d="mousewheel");var l=h.getZoom(),k=(100*l).toString(),q;"undefined"!==typeof f&&null!==f&&(q=h.getClickCoordsInImage(b,l,f));switch(d){case "mousedown":Z.mouseIsDown=!0;sa=new Z.Utils.Point(f.x,f.y);$b=(new Date).getTime();P.mouseXPrior=f.x;P.mouseYPrior=f.y;if(("rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&null!==hotspotCurrentID||"rectangle"==Z.labelMode&&null===hotspotCurrentID)controlPointCurrent=z534(b,q);if(Z.zoomRectangle&&
n&&!Z.measureVisible&&"view"==Z.labelMode&&null===Z.editing){if("none"==oc.display||"none"==Sa.display||"none"==Ra.display)oc.display=Sa.display=Ra.display="inline-block",Z.Utils.addEventListener(Mc,"mousedown",Z.Utils.preventDefault);zoomRectangleDragging=!0;createdNewLabel=!1;k=1;z489(null,!1,q);z489(hotspotCurrentID,!1,new Z.Utils.Point(q.x+k,q.y));z489(hotspotCurrentID,!1,new Z.Utils.Point(q.x+k,q.y+k));z489(hotspotCurrentID,!1,new Z.Utils.Point(q.x,q.y+k));z474(hotspotCurrentID,!0);controlPointCurrent=
2}else if(!n&&"view"!=Z.labelMode&&("addLabel"==Z.editing||"editLabel"==Z.editing||null===Z.editMode&&"measure"==Z.labelMode)){Z.Utils.hideMessage();if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction()&&("freehand"==Z.labelMode||"rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode))break;"addLabel"==Z.editing&&("freehand"==Z.labelMode||"rectangle"==Z.labelMode&&null===controlPointCurrent)&&h.saveEditsLabel(!0,!1,!1);createdNewLabel=!1;"freehand"==
Z.labelMode&&Z.mouseIsDown?("editLabel"==Z.editing&&hotspotCurrent&&Z.Utils.arrayClear(hotspotCurrent.polygonPts),b="editLabel"==Z.editing?hotspotCurrentID:null,z489(b,!1,q),Qb=(q.x-Z.imageX)*l,Rb=(q.y-Z.imageY)*l,z474(hotspotCurrentID,!1),createdNewLabel=!0):"rectangle"==Z.labelMode&&null===controlPointCurrent&&(k=1,b=null,"editLabel"==Z.editing&&(b=hotspotCurrentID,hotspotCurrent&&null===controlPointCurrent&&Z.Utils.arrayClear(hotspotCurrent.polygonPts)),z489(b,!1,q),z489(hotspotCurrentID,!1,new Z.Utils.Point(q.x+
k,q.y)),z489(hotspotCurrentID,!1,new Z.Utils.Point(q.x+k,q.y+k)),z489(hotspotCurrentID,!1,new Z.Utils.Point(q.x,q.y+k)),z474(hotspotCurrentID,!0),controlPointCurrent=2,createdNewLabel=!0);createdNewLabel&&!Z.annotationsAddMultiple&&(Z.editing="editLabel")}else if(!n&&!Z.labelsClickDrag||"addLabel"!=Z.editing&&"editLabel"!=Z.editing)Z.smoothPan&&!n&&Z.mousePan&&1<Z.smoothPanEasing&&(Nc(void 0),Oc=sa,null===ac&&(ac=new Z.Utils.Point(parseFloat(y.left),parseFloat(y.top))),null===gb&&(gb=window.setInterval(ud,
50)));else if(t=z538(m)){k=h.z480(b.clientX,b.clientY);f=new Z.Utils.Point(parseFloat(t.style.left),parseFloat(t.style.top));b=k.x-f.x;k=k.y-f.y;t.mouseXPrior=sa.x;t.mouseYPrior=sa.y;t.mouseXOffset=b;t.mouseYOffset=k;t.style.zIndex=hotspots.length+1;b=t.id.substring(3,t.id.length);if(hotspotCurrentID&&hotspotCurrentID!=b){if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction())break;z632("save","labels");var u=Z.Utils.arrayIndexOfObjectValue(hotspots,"internalID",
b);-1!=u&&(b=hotspots[u]);Z.Utils.validateCallback("labelSelectedInViewportGetIDs")}hotspotList&&(Z.hotspotListTitle||Z.tourListTitle)&&(hotspotList.selectedIndex=0)}break;case "mousemove":ja=new Z.Utils.Point(f.x,f.y);k=(q.x-Z.imageX)*l;d=(q.y-Z.imageY)*l;C&&(clearTimeout(C),C=null,z604(b,q,A));if(Z.zoomRectangle&&n&&"view"==Z.labelMode&&null===Z.editing)z672(hotspotCurrentID,controlPointCurrent,q);else if(n||Z.tracking||(null!==Z.editMode||"measure"!=Z.labelMode)&&("view"==Z.labelMode||"addLabel"!=
Z.editing&&"editLabel"!=Z.editing))if(t){if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction())break;h.getLabelEditable(hotspotCurrentID)&&(n=t.style,k=ja.x-t.mouseXPrior,f=ja.y-t.mouseYPrior,k=parseFloat(n.left)+k,f=parseFloat(n.top)+f,n.left=k+"px",n.top=f+"px",t.mouseXPrior=ja.x,t.mouseYPrior=ja.y,z670(b,t,ja))}else!n&&Z.mousePan&&(gb?Ib=f:Z.animation&&h.getZoom()==Z.minZ?(f.x>P.mouseXPrior?Z.Viewer.viewportNext():f.x<P.mouseXPrior&&Z.Viewer.viewportPrior(),
P.mouseXPrior=f.x,P.mouseYPrior=f.y):(k=f.x-P.mouseXPrior,b=f.y-P.mouseYPrior,isNaN(k)||isNaN(b)||(k=parseFloat(y.left)+k,b=parseFloat(y.top)+b,n=ca(k,b,Z.imageZ,Z.imageR,"container"),y.left=n.x+"px",y.top=n.y+"px",P.mouseXPrior=f.x,P.mouseYPrior=f.y,k=n.x-la,b=n.y-ma,I&&fa&&(Z.mobileDevice||Math.abs(k)>O/2||Math.abs(b)>K/2)&&w(I,Na,ta,"simple",!1,"Updating backfill oversize display"),b=h.calculateCurrentCenterCoordinates(n,Z.imageZ,Z.imageR),Z.Navigator&&Z.Navigator.z658(b),Z.Utils.setBookmarksURL(),
Z.Viewer.syncComparisonViewport(),Z.Viewer.syncOverlayViewports(null,a),Z.tracking&&h.syncTrackingToViewport())));else{if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction()&&("freehand"==Z.labelMode||"rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode))break;b=Z.Utils.arrayIndexOfObjectValue(hotspots,"internalID",hotspotCurrentID);b=-1!=b?hotspots[b].polyClosed:!1;"freehand"==Z.labelMode&&Z.mouseIsDown?(z511(Qb,Rb,k,d,q),Qb=k,Rb=d):!Z.measureVisible&&
!h.getLabelEditable(hotspotCurrentID)||"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||null===controlPointCurrent||!Z.mouseIsDown?"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||b||Z.mouseIsDown&&(!Z.mouseIsDown||null===controlPointCurrent)||z516(k,d,q):z672(hotspotCurrentID,controlPointCurrent,q)}break;case "mouseup":Z.mouseIsDown=!1;document.mousemove=null;document.mouseup=null;e=(new Date).getTime();Z.mouseOutDownPoint?(d=Z.mouseOutDownPoint,q=h.getClickCoordsInImage(b,
l,Z.mouseOutDownPoint)):d=new Z.Utils.Point(f.x,f.y);f=Z.Utils.calculatePointsDistance(sa.x,sa.y,d.x,d.y);l=e-$b;if(f<vd&&l<wd||!n&&("freehand"==Z.labelMode||"rectangle"==Z.labelMode))if(!t&&(null===Z.editMode&&"measure"==Z.labelMode||"view"!=Z.labelMode&&("addLabel"==Z.editing||"editLabel"==Z.editing))){if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction())break;"addLabel"!=Z.editing||n||"text"!=Z.labelMode&&"icon"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=
Z.labelMode||h.saveEditsLabel(!0,!1,!1);if(n&&!g||"freehand"!=Z.labelMode&&"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode)if(n)n&&("text"==Z.labelMode||"icon"==Z.labelMode)&&hotspotCurrent&&(h.modifyHotspot(hotspotCurrentID,"x",q.x,!0,!0),h.modifyHotspot(hotspotCurrentID,"y",q.y,!1,!0));else{b="undefined"!==typeof poiList&&0<poiList.options.length?b=poiList.options[poiList.selectedIndex].value:0;createdNewLabel=!1;if("text"==Z.labelMode)"addLabel"==Z.editing?(h.createLabelFromParameters(null,
null,"text",null,null,q.x.toString(),q.y.toString(),k,null,null,null,"0","0",null,null,null,null,null,null,captionTextColor,null,null,null,null,null,null,null,"5","0",null,b),createdNewLabel=!0):hotspotCurrent&&(h.modifyHotspot(hotspotCurrentID,"x",q.x,!0,!0),h.modifyHotspot(hotspotCurrentID,"y",q.y,!1,!0));else if("icon"==Z.labelMode){if(f=document.getElementById("labelIconList"+c)){f=f[f.selectedIndex].value;switch(f){case "shim":u=Z.labelIconsInternal?"circle":bc+"/circle.png";break;case "External Graphics File":u=
f;break;default:u=Z.labelIconsInternal?f:bc+"/"+f}"addLabel"==Z.editing?(h.createLabelFromParameters(null,null,"icon",u,null,q.x.toString(),q.y.toString(),k,null,null,null,"0","0",null,null,null,null,null,null,captionTextColor,null,lineStrokeColor,null,null,null,null,null,null,"0",null,b),createdNewLabel=!0):hotspotCurrent&&(h.modifyHotspot(hotspotCurrentID,"x",q.x,!0,!0),h.modifyHotspot(hotspotCurrentID,"y",q.y,!1,!0))}}else if("counter"==Z.labelMode&&"addLabel"==Z.editing){var n=Z.Utils.getResource("CONTENT_TRACKINGTEXTCOLOR"),
d=Z.Utils.getResource("CONTENT_TRACKINGLINECOLOR"),M=Z.Utils.getResource("CONTENT_TRACKINGFILLCOLOR"),c=Z.userName;m=Z.userInitials;k=Math.round(q.x).toString();f=Math.round(q.y).toString();var g=h.getTrackingCellIDFromCoordinates(k,f,"100"),p=e=l=null,u=Z.Utils.arrayIndexOfObjectValue(trackingTypesListDP,"value",Z.trackingTypeCurrent);-1!=u&&(u=trackingTypesListDP[u],l=u.text,p=u.text+" : "+Z.userName,e=u.value,M=u.fillColor);var fb=g+"   "+k+", "+f+", 100: "+c,x=Z.Utils.stringPadFront(g,6,"0")+
Z.Utils.stringPadFront("0",6,"0"),u="circle",ba=Z.Utils.getResource("CONTENT_COUNTERCAPTIONPOSITION"),D=Z.Utils.getCurrentUTCDateAsString();h.createLabelFromParameters("0",l,"counter",u,null,k,f,"100",null,null,40,"0","0",null,null,null,m,null,p,n,null,d,M,"1","0","1","1",ba,"0",null,b,null,null,null,null,null,null,null,null,e,null,null,null,null,c,Z.userInitials,D);createdNewLabel=!0;trackingInstancesListDP[trackingInstancesListDP.length]={text:fb,value:"0",sortKey:x,cell:g,typeID:e,x:k,y:f,zoom:"100",
user:c,name:l,mediaType:"counter",media:u,radius:(40).toString(),caption:m,captionPosition:ba,fillColor:M,initials:Z.userInitials,date:D};h.syncTrackingToViewport()}createdNewLabel&&(b=labelListDP[labelListDP.length-1],z611(b.poiID,b.value),createdNewLabel=!1,Z.annotationsAddMultiple||(Z.editing="editLabel"))}else if(n||g)z604(b,q);else{Z.Utils.addEventListener(document,"mousemove",L);var A=!1;C?(A=!0,clearTimeout(C),C=null,z604(b,q,A),Z.Utils.removeEventListener(document,"mousemove",L)):(C=setTimeout(function(a){C=
null;z604(a,q,A)},Z.doubleClickDelay),"polygon"!=Z.labelMode&&"measure"!=Z.labelMode&&Z.Utils.removeEventListener(document,"mousemove",L))}}else if(null!==t&&(Z.measureVisible||Z.tour||Z.hotspots||Z.annotations))t=null;else{if((null===Z.editing||"view"==Z.labelMode)&&!t)if(k=null,Z.labelClickSelect&&(k=z538(m)),null!==k)b=k.id.substring(3,k.id.length),u=Z.Utils.arrayIndexOfObjectValue(hotspots,"internalID",b),-1!=u&&(b=hotspots[u],h.zoomAndPanToView(b.x,b.y,b.z/100,b.rotation),Z.Utils.validateCallback("labelSelectedInViewportGetIDs")),
hotspotList&&(Z.hotspotListTitle||Z.tourListTitle)&&(hotspotList.selectedIndex=0);else{if(Z.clickZoom||Z.clickPan)var k=C&&Z.doubleClickZoom?!0:!1,r=h.getClickZoomCoords3D(b,sa,G,S,k);Z.clickZoom?Z.doubleClickZoom?C?(clearTimeout(C),C=null,h.zoomAndPanToView(r.x,r.y,r.z)):C=setTimeout(function(a){C=null;h.zoomAndPanToView(r.x,r.y,r.z)},Z.doubleClickDelay):window.setTimeout(function(){h.zoomAndPanToView(r.x,r.y,r.z)},1):Z.clickPan&&h.zoomAndPanToView(r.x,r.y,Z.imageZ);Z.zoomRectangle&&zoomRectangleDragging&&
(b=hotspots[hotspotCurrentID].polygonPts,h.deleteLabel(hotspotCurrentID),zoomRectangleDragging=null,Z.measureVisible||Z.tour||Z.hotspots||Z.annotations||(oc.display=Sa.display=Ra.display="none",Z.Utils.removeEventListener(Mc,"mousedown",Z.Utils.preventDefault)))}}else{if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction())break;Z.zoomRectangle&&zoomRectangleDragging&&"view"==Z.labelMode&&null===Z.editing?(b=hotspots[hotspotCurrentID].polygonPts,h.deleteLabel(hotspotCurrentID,
!0),zoomRectangleDragging=null,Z.measureVisible||Z.tour||Z.hotspots||Z.annotations||(oc.display=Sa.display=Ra.display="none",Z.Utils.removeEventListener(Mc,"mousedown",Z.Utils.preventDefault)),h.zoomAndPanToZoomRectangle(b)):"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||!controlPointDragging?t&&(h.getLabelEditable(hotspotCurrentID)&&(n=t.style,k=d.x-t.mouseXPrior,f=d.y-t.mouseYPrior,k=parseFloat(n.left)+k,f=parseFloat(n.top)+f,n.left=k+"px",n.top=f+"px",z670(b,t,d)),t.style.zIndex=
t.zIndex,t=null):(controlPointCurrent=null,controlPointDragging=!1,b=Z.Utils.arrayIndexOfObjectValue(hotspots,"internalID",hotspotCurrentID),-1!=b&&(b=hotspots[b],k=Z.Utils.polygonCenter(b.polygonPts,b.polyClosed),b.x=k.x,b.y=k.y,Z.Utils.clearDisplay(Va),k=new HotspotContext,displayHotspot(b,k)));ja=null;Z.mousePan&&!Z.smoothPan&&h.updateView()}Z.mouseOutDownPoint&&(Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.Navigator&&1<Z.navigatorVisible&&Z.Navigator.setVisibility(!1));break;
case "touchstart":if(e&&!qb){Z.mouseIsDown=!0;cc=!1;sa=new Z.Utils.Point(f.x,f.y);$b=(new Date).getTime();P.mouseXPrior=f.x;P.mouseYPrior=f.y;if(("rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&null!==hotspotCurrentID||"rectangle"==Z.labelMode&&null===hotspotCurrentID)controlPointCurrent=z534(b,q);if(!n&&"view"!=Z.labelMode&&("addLabel"==Z.editing||"editLabel"==Z.editing||null===Z.editMode&&"measure"==Z.labelMode)){"markup"!=Z.editMode&&h.toggleLabelColorPicker(!1);h.toggleLabelIconPicker(!1);
Z.Utils.hideMessage();if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction()&&("freehand"==Z.labelMode||"rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode))break;"addLabel"==Z.editing&&("freehand"==Z.labelMode||"rectangle"==Z.labelMode&&null===controlPointCurrent)&&h.saveEditsLabel(!0,!1,!1);"freehand"==Z.labelMode&&Z.mouseIsDown?("editLabel"==Z.editing&&hotspotCurrent&&Z.Utils.arrayClear(hotspotCurrent.polygonPts),b="editLabel"==Z.editing?
hotspotCurrentID:null,z489(b,!1,q),Qb=(q.x-Z.imageX)*l,Rb=(q.y-Z.imageY)*l,z474(hotspotCurrentID,!1)):"rectangle"==Z.labelMode&&null===controlPointCurrent&&(k=1,b=null,"editLabel"==Z.editing&&(b=hotspotCurrentID,hotspotCurrent&&null===controlPointCurrent&&Z.Utils.arrayClear(hotspotCurrent.polygonPts)),z489(b,!1,q),z489(hotspotCurrentID,!1,new Z.Utils.Point(q.x+k,q.y)),z489(hotspotCurrentID,!1,new Z.Utils.Point(q.x+k,q.y+k)),z489(hotspotCurrentID,!1,new Z.Utils.Point(q.x,q.y+k)),z474(hotspotCurrentID,
!0),controlPointCurrent=2)}else if(n&&("addLabel"==Z.editing||"editLabel"==Z.editing)&&(t=z538(m))){k=h.z480(b.clientX,b.clientY);f=new Z.Utils.Point(parseFloat(t.style.left),parseFloat(t.style.top));b=k.x-f.x;k=k.y-f.y;t.mouseXPrior=sa.x;t.mouseYPrior=sa.y;t.mouseXOffset=b;t.mouseYOffset=k;t.style.zIndex=hotspots.length+1;b=t.id.substring(3,t.id.length);if(hotspotCurrentID&&hotspotCurrentID!=b){if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction())break;z632("save",
"labels");u=Z.Utils.arrayIndexOfObjectValue(hotspots,"internalID",b);-1!=u&&(b=hotspots[u]);Z.Utils.validateCallback("labelSelectedInViewportGetIDs")}hotspotList&&(Z.hotspotListTitle||Z.tourListTitle)&&(hotspotList.selectedIndex=0)}}break;case "touchmove":if(e&&!qb&&!cc)if(ja=new Z.Utils.Point(f.x,f.y),k=(q.x-Z.imageX)*l,d=(q.y-Z.imageY)*l,C&&(clearTimeout(C),C=null,z604(b,q,A)),n||(null!==Z.editMode||"measure"!=Z.labelMode)&&("view"==Z.labelMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing))if(t){if("function"===
typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction())break;n=t.style;k=ja.x-t.mouseXPrior;f=ja.y-t.mouseYPrior;k=parseFloat(n.left)+k;f=parseFloat(n.top)+f;n.left=k+"px";n.top=f+"px";t.mouseXPrior=ja.x;t.mouseYPrior=ja.y;z670(b,t,ja)}else!n&&Z.mousePan&&(gb?Ib=f:(k=f.x-P.mouseXPrior,b=f.y-P.mouseYPrior,isNaN(k)||isNaN(b)||(k=parseFloat(y.left)+k,b=parseFloat(y.top)+b,n=ca(k,b,Z.imageZ,Z.imageR,"container"),y.left=n.x+"px",y.top=n.y+"px",P.mouseXPrior=f.x,P.mouseYPrior=f.y,
k=n.x-la,b=n.y-ma,I&&fa&&(Z.mobileDevice||Math.abs(k)>O/2||Math.abs(b)>K/2)&&w(I,Na,ta,"simple",!1,"Updating backfill oversize display"),b=h.calculateCurrentCenterCoordinates(n,Z.imageZ,Z.imageR),Z.Navigator&&Z.Navigator.z658(b),Z.Utils.setBookmarksURL(),Z.Viewer.syncComparisonViewport(),Z.Viewer.syncOverlayViewports(null,a),Z.tracking&&h.syncTrackingToViewport())));else{if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction()&&("freehand"==Z.labelMode||"rectangle"==
Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode))break;b=Z.Utils.arrayIndexOfObjectValue(hotspots,"internalID",hotspotCurrentID);b=-1!=b?hotspots[b].polyClosed:!1;"freehand"==Z.labelMode&&Z.mouseIsDown?(z511(Qb,Rb,k,d,q),Qb=k,Rb=d):"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||null===controlPointCurrent||!Z.mouseIsDown?"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||b||Z.mouseIsDown&&(!Z.mouseIsDown||null===controlPointCurrent)||z516(k,d,q):z672(hotspotCurrentID,
controlPointCurrent,q)}break;case "touchend":if(!qb&&!cc){Z.mouseIsDown=!1;document.mousemove=null;document.mouseup=null;e=(new Date).getTime();Z.mouseOutDownPoint?(d=Z.mouseOutDownPoint,q=h.getClickCoordsInImage(b,l,Z.mouseOutDownPoint)):d="undefined"!==typeof f&&null!==f?new Z.Utils.Point(f.x,f.y):"undefined"!==typeof ja&&null!==ja?ja:sa;f=Z.Utils.calculatePointsDistance(sa.x,sa.y,d.x,d.y);l=e-$b;if(f<fd&&l<gd||!n&&("rectangle"==Z.labelMode||"freehand"==Z.labelMode))if(t||(null!==Z.editMode||"measure"!=
Z.labelMode)&&("view"==Z.labelMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing))null!==t&&(Z.measureVisible||Z.tour||Z.hotspots||Z.annotations)?t=null:null!==Z.editing&&"view"!=Z.labelMode||t||(Z.clickZoom?(k=C&&Z.doubleClickZoom?!0:!1,r=h.getClickZoomCoords3D(b,sa,G,S,k),Z.doubleClickZoom?C?(clearTimeout(C),C=null,h.zoomAndPanToView(r.x,r.y,r.z)):C=setTimeout(function(a){C=null;h.zoomAndPanToView(r.x,r.y,r.z)},Z.doubleClickDelay):window.setTimeout(function(){h.zoomAndPanToView(r.x,r.y,r.z)},1)):
Z.clickPan&&h.zoomAndPanToView(r.x,r.y,Z.imageZ));else{if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction())break;"addLabel"!=Z.editing||n||"text"!=Z.labelMode&&"icon"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||h.saveEditsLabel(!0,!1,!1);if(n||"freehand"!=Z.labelMode&&"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode)if(n)n&&("text"==Z.labelMode||"icon"==Z.labelMode)&&hotspotCurrent&&(h.modifyHotspot(hotspotCurrentID,
"x",q.x,!0,!0),h.modifyHotspot(hotspotCurrentID,"y",q.y,!1,!0));else{b="undefined"!==typeof poiList&&0<poiList.options.length?b=poiList.options[poiList.selectedIndex].value:0;createdNewLabel=!1;if("text"==Z.labelMode)"addLabel"==Z.editing?(h.createLabelFromParameters(null,null,"text",null,null,q.x.toString(),q.y.toString(),k,null,null,null,"0","0",null,null,null,null,null,null,captionTextColor,null,null,null,null,null,null,null,"5","0",null,b),createdNewLabel=!0):hotspotCurrent&&(h.modifyHotspot(hotspotCurrentID,
"x",q.x,!0,!0),h.modifyHotspot(hotspotCurrentID,"y",q.y,!1,!0));else if("icon"==Z.labelMode&&(f=document.getElementById("labelIconList"+c))){f=f[f.selectedIndex].value;switch(f){case "shim":u=Z.labelIconsInternal?"circle":bc+"/circle.png";break;case "External Graphics File":u=f;break;default:u=Z.labelIconsInternal?f:bc+"/"+f}"addLabel"==Z.editing?(h.createLabelFromParameters(null,null,"icon",u,null,q.x.toString(),q.y.toString(),k,null,null,null,"0","0",null,null,null,null,null,null,captionTextColor,
null,lineStrokeColor,null,null,null,null,null,null,"0",null,b),createdNewLabel=!0):hotspotCurrent&&(h.modifyHotspot(hotspotCurrentID,"x",q.x,!0,!0),h.modifyHotspot(hotspotCurrentID,"y",q.y,!1,!0))}createdNewLabel&&(b=labelListDP[labelListDP.length-1],z611(b.poiID,b.value),createdNewLabel=!1)}else n||g?z604(b,q):(Z.Utils.addEventListener(document,"touchmove",L),A=!1,C?(A=!0,clearTimeout(C),C=null,z604(b,q,A),Z.Utils.removeEventListener(document,"touchmove",L)):(C=setTimeout(function(a){C=null;z604(a,
q,A)},Z.doubleClickDelay),"polygon"!=Z.labelMode&&"measure"!=Z.labelMode&&Z.Utils.removeEventListener(document,"touchmove",L)));z638("label",Z.editing)}else{if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction())break;"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||!controlPointDragging?t&&(n=t.style,k=d.x-t.mouseXPrior,f=d.y-t.mouseYPrior,k=parseFloat(n.left)+k,f=parseFloat(n.top)+f,n.left=k+"px",n.top=f+"px",z670(b,t,d),t.style.zIndex=
t.zIndex,t=null):(controlPointCurrent=null,controlPointDragging=!1,b=Z.Utils.arrayIndexOfObjectValue(hotspots,"internalID",hotspotCurrentID),-1!=b&&(b=hotspots[b],k=Z.Utils.polygonCenter(b.polygonPts,b.polyClosed),b.x=k.x,b.y=k.y,Z.Utils.clearDisplay(Va),k=new HotspotContext,displayHotspot(b,k)));ja=null;Z.mousePan&&!gb&&h.updateView()}Z.mouseOutDownPoint&&(Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.Navigator&&1<Z.navigatorVisible&&Z.Navigator.setVisibility(!1))}break;case "touchcancel":if(!qb&&
!cc){Z.mouseIsDown=!1;document.mousemove=null;document.mouseup=null;e=(new Date).getTime();Z.mouseOutDownPoint?(d=Z.mouseOutDownPoint,q=h.getClickCoordsInImage(b,l,Z.mouseOutDownPoint)):d="undefined"!==typeof f&&null!==f?new Z.Utils.Point(f.x,f.y):"undefined"!==typeof ja&&null!==ja?ja:sa;f=Z.Utils.calculatePointsDistance(sa.x,sa.y,d.x,d.y);l=e-$b;if(f<fd&&l<gd||!n&&("rectangle"==Z.labelMode||"freehand"==Z.labelMode))if(t||(null!==Z.editMode||"measure"!=Z.labelMode)&&("view"==Z.labelMode||"addLabel"!=
Z.editing&&"editLabel"!=Z.editing))null!==t&&(Z.measureVisible||Z.tour||Z.hotspots||Z.annotations)?t=null:null!==Z.editing&&"view"!=Z.labelMode||t||(Z.clickZoom?(k=C&&Z.doubleClickZoom?!0:!1,r=h.getClickZoomCoords3D(b,sa,G,S,k),Z.doubleClickZoom?C?(clearTimeout(C),C=null,h.zoomAndPanToView(r.x,r.y,r.z)):C=setTimeout(function(a){C=null;h.zoomAndPanToView(r.x,r.y,r.z)},Z.doubleClickDelay):window.setTimeout(function(){h.zoomAndPanToView(r.x,r.y,r.z)},1)):Z.clickPan&&h.zoomAndPanToView(r.x,r.y,Z.imageZ));
else{if("function"===typeof Z.externalEditPermissionFunction&&!Z.externalEditPermissionFunction())break;"addLabel"!=Z.editing||n||"text"!=Z.labelMode&&"icon"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||h.saveEditsLabel(!0,!1,!1);n||"freehand"!=Z.labelMode&&"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode?n?n&&("text"==Z.labelMode||"icon"==Z.labelMode)&&hotspotCurrent&&(h.modifyHotspot(hotspotCurrentID,"x",q.x,!0,!0),h.modifyHotspot(hotspotCurrentID,"y",q.y,
!1,!0)):(b="undefined"!==typeof poiList&&0<poiList.options.length?b=poiList.options[poiList.selectedIndex].value:0,createdNewLabel=!1,"text"==Z.labelMode?"addLabel"==Z.editing?(h.createLabelFromParameters(null,null,"text",null,null,q.x.toString(),q.y.toString(),k,null,null,null,"0","0",null,null,null,null,null,null,captionTextColor,null,null,null,null,null,null,null,"5","0",null,b),createdNewLabel=!0):hotspotCurrent&&(h.modifyHotspot(hotspotCurrentID,"x",q.x,!0,!0),h.modifyHotspot(hotspotCurrentID,
"y",q.y,!1,!0)):"icon"==Z.labelMode&&(f=document.getElementById("labelIconList"+c))&&(f=f[f.selectedIndex].value,u="shim"==f?"":"External Graphics File"==f?f:bc+"/"+f,"addLabel"==Z.editing?(h.createLabelFromParameters(null,null,"icon",u,null,q.x.toString(),q.y.toString(),k,null,null,null,"0","0",null,null,null,null,null,null,captionTextColor,null,lineStrokeColor,null,null,null,null,null,null,"0",null,b),createdNewLabel=!0):hotspotCurrent&&(h.modifyHotspot(hotspotCurrentID,"x",q.x,!0,!0),h.modifyHotspot(hotspotCurrentID,
"y",q.y,!1,!0))),createdNewLabel&&(b=labelListDP[labelListDP.length-1],z611(b.poiID,b.value),createdNewLabel=!1)):n||g?z604(b,q):(Z.Utils.addEventListener(document,"touchmove",L),A=!1,C?(A=!0,clearTimeout(C),C=null,z604(b,q,A),Z.Utils.removeEventListener(document,"touchmove",L)):(C=setTimeout(function(a){C=null;z604(a,q,A)},Z.doubleClickDelay),"polygon"!=Z.labelMode&&"measure"!=Z.labelMode&&Z.Utils.removeEventListener(document,"touchmove",L)));z638("label",Z.editing)}else{if("function"===typeof Z.externalEditPermissionFunction&&
!Z.externalEditPermissionFunction())break;"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||!controlPointDragging?t&&(n=t.style,k=d.x-t.mouseXPrior,f=d.y-t.mouseYPrior,k=parseFloat(n.left)+k,f=parseFloat(n.top)+f,n.left=k+"px",n.top=f+"px",z670(b,t,d),t.style.zIndex=t.zIndex,t=null):(controlPointCurrent=null,controlPointDragging=!1,b=Z.Utils.arrayIndexOfObjectValue(hotspots,"internalID",hotspotCurrentID),-1!=b&&(b=hotspots[b],k=Z.Utils.polygonCenter(b.polygonPts,b.polyClosed),
b.x=k.x,b.y=k.y,Z.Utils.clearDisplay(Va),k=new HotspotContext,displayHotspot(b,k)));ja=null;Z.mousePan&&!gb&&h.updateView()}Z.mouseOutDownPoint&&(Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.Navigator&&1<Z.navigatorVisible&&Z.Navigator.setVisibility(!1))}break;case "gesturestart":xd(b);qb||(qb=window.setInterval(yd,zd));break;case "gesturechange":Pc=Math.round(100*b.scale)/100;break;case "gestureend":qb&&(window.clearInterval(qb),cc=!0,qb=null),Z.mousePan&&h.updateView()}}}function Nc(a){null!==
gb&&a&&(window.clearInterval(gb),gb=null);ac=Qc=Rc=Ta=null;hb=ib=zb=Ab=0}function ud(){if(Z.animation&&h.getZoom()==Z.minZ)smoothAnimateStep();else{var a=parseFloat(y.left),b=parseFloat(y.top);if(Z.mouseIsDown||Ta){var c=(Ta?Qc:Ib.x)-Oc.x,d=(Ta?Rc:Ib.y)-Oc.y,e=a-ac.x,f=b-ac.y;if(!(isNaN(c)||isNaN(d)||isNaN(e)||isNaN(f)||0==c&&0==d&&0==e&&0==f)){var k=Ta?Z.smoothPanGlide:1,m=Ta?1:100;hb=Math.round((c-e)/(Z.smoothPanEasing*k)*m/m);ib=Math.round((d-f)/(Z.smoothPanEasing*k)*m/m);Z.mouseIsDown?(zb=hb,
Ab=ib):(Math.abs(hb)>Math.abs(zb)&&(hb=zb),Math.abs(ib)>Math.abs(Ab)&&(ib=Ab));a+=hb;b+=ib;c=ca(a,b,Z.imageZ,Z.imageR,"container");y.left=c.x+"px";y.top=c.y+"px";hb-=a-c.x;ib-=b-c.y;I&&fa&&w(I,Na,ta,"simple",!1,"Updating backfill oversize display");Ta&&0==Math.round(hb*m)/m&&0==Math.round(ib*m)/m&&(Ta=!1);m=h.calculateCurrentCenterCoordinates(c,Z.imageZ,Z.imageR);Z.comparison&&0!=Hb||Z.Navigator&&Z.Navigator.z658(m)}}else if(Z.mouseIsDown||null!==Ta||0==hb||0==ib)Nc(!0),h.updateView();else if(c=ca(a+
zb,b+Ab,Z.imageZ,Z.imageR,"container"),zb=c.x-a,Ab=c.y-b,0!=zb||0!=Ab)Qc=Ib.x+zb,Rc=Ib.y+Ab,Ta=!0}}function xd(a){a=Z.Utils.event(a);a.preventDefault();Pc=Math.round(100*a.scale)/100}function yd(a){if(Z.mousePan){a=F(G,sb*Pc);var b=cb(a);a!=Z.imageZ&&h.z633(b)}}var bc,Hc=null,Ic=null,Hb=0;"undefined"!==typeof a&&null!==a&&(Hb=a);var Jb;Jb="undefined"!==typeof b&&null!==b?b:Z.imagePath;var h=this,Kb=[],vb=parseInt(Z.Utils.getResource("z90"),10),$c=8*vb,ad=4*vb,tc=0,Ea=parseInt(Z.Utils.getResource("z221"),
10),Fa=parseInt(Z.Utils.getResource("z219"),10),Ad=parseFloat(Z.Utils.getResource("z218")),Mb=parseInt(Z.Utils.getResource("z220"),10),hd=1==Z.toolbarVisible?Z.toolbarH:0,vd=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDVIEWPORT"),10),wd=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDTIMEVIEWPORT"),10),fd=parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDVIEWPORT"),10),gd=parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDTIMEVIEWPORT"),10),dc,I,Wa,na,jb,P,y,Sc,V,H,rb,
ec,aa,ha,oa,Tc,za,Sb,Bb,Vb,Mc,Yc,oc,Cb,Ra,qc,Va,Sa,rc,md,nd,Qb,Rb,fc,sc,Vc;(function(a){if("undefined"===typeof a||null===a)a=0;a=a.toString();Z.useCanvas&&!I&&(dc=Z.Utils.createContainerElement("canvas","oversizeDisplay"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Z.ViewerDisplay.appendChild(dc),I=dc,Wa=I.style);P||(jb=Z.Utils.createContainerElement("div","viewportContainer"+a,"inline-block","absolute","visible","1px","1px",
"0px","0px","none","0px","transparent none","0px","0px","normal"),Z.comparison?(void 0).appendChild(jb):Z.ViewerDisplay.appendChild(jb),P=jb,y=P.style);V||(Sc=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportBackfillDisplay"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),jb.appendChild(Sc),V=Sc,H=V.style);aa||(ec=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportDisplay"+a,"inline-block","absolute",
"visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),jb.appendChild(ec),aa=ec,ha=aa.style);Z.useCanvas&&!za&&(Tc=Z.Utils.createContainerElement("canvas","transitionCanvas","none","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),jb.appendChild(Tc),za=Tc,Sb=za.style);Z.useCanvas||(V.innerHTML="",aa.innerHTML="")})(Hb);var Ba,wa=1,G=0,ka=0,fa=!1,Na=0,yc=!1,S,sb,Xa,Ia,va=[],Ga=[],pa=[],Ha=[],Ma=[],Db=[];tierTileOffsetsCount=
[];tierTileOffsetChunks=[];tierTileOffsetLast=[];var tb=[];tierTileByteCountsCount=[];tierTileByteCountChunks=[];tierTileByteCountLast=[];var kb=[],ta=[],qa=[],Ua=[],ub=[],jc=0,bd=0,Bc=0,Cc=0,Dc=0,Fc=0,jd,zc=0,Ac=0,mc=0,Fb=0,lc=0,Pb=0,Ob=0,Gc=0,lb=[],W=[],xa=[],bb=[],mb=[],Ya=[],Nb=null,nc=0,td=parseInt(Z.Utils.getResource("DEFAULT_VALIDATEVIEWRETRYLIMIT"),10),cd=parseInt(Z.Utils.getResource("DEFAULT_VALIDATEVIEWRETRYDELAY"),10),$a=[],ra=[],nb=[],Qa=[],sd=new Z.NetConnector,Xc=parseInt(Z.Utils.getResource("z81"),
10),Bd=parseInt(Z.Utils.getResource("z78"),10),kd=parseInt(Z.Utils.getResource("z80"),10),Wb=parseInt(Z.Utils.getResource("z77"),10),Na=Wb,ld=parseInt(Z.Utils.getResource("z79"),10),ic=parseInt(Z.Utils.getResource("z76"),10),hc=parseInt(Z.Utils.getResource("z75"),10),wc=null,vc=null,uc=null,Cd=parseFloat(Z.Utils.getResource("z173UNCONVERTED"),10),Dd=null!==Z.panBuffer?Z.panBuffer:parseFloat(Z.Utils.getResource("z173"),10),Zc="unconverted"!=Z.tileSource?Dd:Cd,ed=parseFloat(Z.Utils.getResource("z74"),
10),rd=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXBROWSER"),10),qd=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXFIREFOX"),10),pd=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXMOBILE"),10),od=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXIMAGESET"),10),O,K,Wc,gc,da,ea,Ja,Ka,la,ma,db,eb,Kc,Lc,Oa,Pa;O=Z.viewerW;K=Z.viewerH;Wc=gc=0;K-=hd;0==Z.toolbarPosition&&(gc+=hd);var C=null,sa,ja,$b,qb=null,Pc=null,cc=!1,zd=parseInt(Z.Utils.getResource("z122"),10),pc=Math.round(parseFloat(Z.Utils.getResource("z176"))*
Z.panSpeed),Ca=0,Da=0;parseInt(Z.Utils.getResource("DEFAULT_ANIMATIONOPTIMALMOTIONIMAGES"),10);parseInt(Z.Utils.getResource("DEFAULT_ANIMATIONOPTIMALPOSITIONDELTA"),10);var gb=null,Oc=null,ac=null,Ib=null,hb=0,ib=0,zb=0,Ab=0,Ta=null,Qc=null,Rc=null,Tb=parseFloat(Z.Utils.getResource("z242"))*Z.zoomSpeed;Z.mobileDevice&&(Tb/=2);var La=0,pb=null,dd=0,Jc=parseInt(Z.Utils.getResource("z238"),10),Ec=parseFloat(Z.Utils.getResource("z112"))*Z.fadeInSpeed,kc=null;parseInt(Z.Utils.getResource("DEFAULT_ROTATIONSTEPDEGREES"),
10);parseInt(Z.Utils.getResource("DEFAULT_ROTATIONSTEPDURATION"),10);var Ed=parseFloat(Z.Utils.getResource("z239")),Uc=parseFloat(Z.Utils.getResource("z240"));Z.mobileDevice&&(Uc/=2);var xb=null,Zb=0,t=!1;if(null!==Z.imagePath&&"null"!=Z.imagePath){if(1==Z.localUse&&"ZoomifyImageFile"==Z.tileSource){Z.Utils.showMessage(Z.Utils.getResource("z290"),!1,Z.messageDurationShort,"center");return}1==Z.localUse&&(Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA||Z.browser==Z.browsers.IE&&11==Z.browserVersion||
Z.browser==Z.browsers.SAFARI&&7<=Z.browserVersion)&&Z.Utils.showMessage(Z.Utils.getResource("z288"),!1,Z.messageDurationStandard,"center");if(-1==Z.imagePath.indexOf("zComparisonPath")&&-1==Z.imagePath.indexOf("zSlidePath")&&-1==Z.imagePath.indexOf("zOverlayPath")&&-1==Z.imagePath.indexOf("zAnimationPath")&&-1==Z.imagePath.indexOf("zSlidestackPath")){var Fd=new Z.NetConnector;B(Jb,Fd,Hb)}}this.clearAll=function(a,b,c,d){a&&(jc=0,"undefined"!==typeof ta&&Z.Utils.arrayClear(ta),"undefined"!==typeof qa&&
Z.Utils.arrayClear(qa),"undefined"!==typeof kb&&Z.Utils.arrayClear(kb),"undefined"!==typeof lb&&Z.Utils.arrayClear(lb),"undefined"!==typeof W&&Z.Utils.arrayClear(W),"undefined"!==typeof xa&&Z.Utils.arrayClear(xa),"undefined"!==typeof bb&&Z.Utils.arrayClear(bb),"undefined"!==typeof mb&&Z.Utils.arrayClear(mb),"undefined"!==typeof Ya&&Z.Utils.arrayClear(Ya),"undefined"!==typeof Ua&&Z.Utils.arrayClear(Ua),"undefined"!==typeof ub&&Z.Utils.arrayClear(ub),"undefined"!==typeof nb&&Z.Utils.arrayClear(nb),
"undefined"!==typeof ra&&Z.Utils.arrayClear(ra),"undefined"!==typeof $a&&Z.Utils.arrayClear($a),"undefined"!==typeof Qa&&Z.Utils.arrayClear(Qa));b&&p();d&&(I&&Z.Utils.clearDisplay(I),V&&Z.Utils.clearDisplay(V),aa&&Z.Utils.clearDisplay(aa),za&&Z.Utils.clearDisplay(za))};this.setSizeAndPosition=function(a,b,c,d){v(a,b,c,d)};this.resizeViewport=function(a,b,c,d){h.validateXYZDefaults();h.setView(a,b,c,d)};this.loadImageProperties=function(a,b,c){B(a,b,c)};this.parseZIFHeader=function(a){p();if(73==a[0]&&
73==a[1]&&43==a[2]&&0==a[3]&&8==a[4]&&0==a[5]&&0==a[6]&&0==a[7]&&16==a[8]&&0==a[9]&&0==a[10]&&0==a[11]&&0==a[12]&&0==a[13]&&0==a[14]&&0==a[15]){for(var b=Z.Utils.longValue(a,8),c=Z.Utils.longValue(a,b),d=1,e=null,f=null,k=null,m=null,g=null,u=null,u=2;0!=b;){for(e=0;e<c;e++)switch(f=b+8+20*e,Z.Utils.shortValue(a,f)){case 256:va[d-1]=Z.Utils.intValue(a,f+12);break;case 257:Ga[d-1]=Z.Utils.intValue(a,f+12);break;case 322:k=Z.Utils.intValue(a,f+12);break;case 323:m=Z.Utils.intValue(a,f+12);break;case 324:var A=
tierTileOffsetsCount[d-1]=Z.Utils.longValue(a,f+4);Db[d-1]=Z.Utils.longValue(a,f+12);g+=A;break;case 325:A=tierTileByteCountsCount[d-1]=Z.Utils.longValue(a,f+4),tb[d-1]=1==A?Z.Utils.intValue(a,f+12):2==A?Z.Utils.intValue(a,f+12)+","+Z.Utils.intValue(a,f+16):Z.Utils.longValue(a,f+12)}b=Z.Utils.longValue(a,b+20*c+8);c=Z.Utils.longValue(a,b);d++}e=va[0];f=Ga[0];wa=d-1;va.reverse();Ga.reverse();tierTileOffsetsCount.reverse();Db.reverse();tierTileByteCountsCount.reverse();tb.reverse();!isNaN(e)&&0<e&&
!isNaN(f)&&0<f&&!isNaN(k)&&0<k&&!isNaN(m)&&0<m&&0<g?h.getStatus("initializedViewport")||l(e,f,k,m,g,u,null,null,null,null,null):"ZoomifyImageFolder"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z252"),!1,Z.messageDurationStandard,"center"):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}};this.parseZIFOffsetChunk=function(a,b){var c=Z.Utils.arrayIndexOfObjectValue(tierTileOffsetChunks,"chunkID",b);-1!=c&&(tierTileOffsetChunks[c].chunk=a,ua(b,"offset"))};
this.parseZIFByteCountChunk=function(a,b){var c=Z.Utils.arrayIndexOfObjectValue(tierTileByteCountChunks,"chunkID",b);-1!=c&&(tierTileByteCountChunks[c].chunk=a,ua(b,"byteCount"))};this.parseZIFImage=function(a,b,c){a="data:image/jpeg;base64,"+Z.Utils.encodeBase64(a);var d;"image-display"==c?d=h.getStatus("imageSaving")?ab:E:"image-backfill"==c?d=h.getStatus("imageSaving")?z599ToSave:Q:"navigator"==c?d=Z.Navigator.z556:"gallery"==c&&(d=Z.Gallery.initializeGallery);b=Z.Utils.createCallback(null,d,b);
Z.Utils.createImageElementFromBytes(a,b)};this.z602=function(a,b){D(a,b)};this.validateXYZDefaults=function(a){a&&Z.Utils.resetParametersXYZ(Z.parameters);var b=parseFloat(Z.Utils.getResource("z143")),c=parseFloat(Z.Utils.getResource("z144")),d=parseFloat(Z.Utils.getResource("z145")),e=parseFloat(Z.Utils.getResource("DEFAULT_INITIALR")),f=parseFloat(Z.Utils.getResource("z163"));a=parseFloat(Z.Utils.getResource("z153"));b=isNaN(b)?null:b;c=isNaN(c)?null:c;d=isNaN(d)?null:d;e=isNaN(e)?null:e;f=isNaN(f)?
null:f;a=isNaN(a)?null:a;Z.parameters?(Z.parameters.zInitialX||(Z.initialX=b),Z.parameters.zInitialY||(Z.initialY=c),Z.parameters.zInitialZoom||(Z.initialZ=d),Z.parameters.zInitialRotation||(Z.initialR=e),Z.parameters.zMinZoom||(Z.minZ=f),Z.parameters.zMaxZoom||(Z.maxZ=a)):(Z.initialX=b,Z.initialY=c,Z.initialZ=d,Z.initialR=e,Z.minZ=f,Z.maxZ=a);null===Z.initialX&&(Z.initialX=Z.imageW/2);null===Z.initialY&&(Z.initialY=Z.imageH/2);Z.fitZ=h.z468(null,null,0);Z.fillZ=h.calculateZoomToFill(null,null,0);
b=h.getStatus("initializedViewport")?h.getRotation():Z.initialR;a=h.z468(null,null,b);b=h.calculateZoomToFill(null,null,b);1<Z.fitZ&&(null!==Z.maxZ?Z.fitZ>Z.maxZ&&(Z.fitZ=Z.maxZ):"unconverted"==Z.tileSource&&(Z.fitZ=1));1<Z.fillZ&&(null!==Z.maxZ?Z.fillZ>Z.maxZ&&(Z.fillZ=Z.maxZ):"unconverted"==Z.tileSource&&(Z.fillZ=1));null===Z.minZ||-1==Z.minZ?Z.minZ=Z.fitZ:0==Z.minZ&&(Z.minZ=Z.fillZ);if(null===Z.maxZ||-1==Z.maxZ)Z.maxZ=1;null===Z.initialZ||-1==Z.initialZ?Z.initialZ=a:0==Z.initialZ&&(Z.initialZ=
b);Z.initialZ<Z.minZ&&(Z.initialZ=Z.minZ);Z.initialZ>Z.maxZ&&(Z.initialZ=Z.maxZ)};this.getViewW=function(){return O};this.getViewH=function(){return K};this.getDisplayW=function(){return da};this.getDisplayH=function(){return ea};this.getImagePath=function(){return Jb};this.getViewportID=function(){return Hb};this.getTierCount=function(){return wa};this.getTileW=function(){return Ea};this.getTileH=function(){return Fa};this.getTierCurrent=function(){return G};this.getTierBackfill=function(){return ka};
this.getTierBackfillDynamic=function(){return fa};this.getTierBackfillOversize=function(){return Na};this.getTierScale=function(){return S};this.getX=function(a){var b=parseFloat(y.left)-la;a=h.getZoom(a);return Hc-b/a};this.getY=function(a){var b=parseFloat(y.top)-ma;a=h.getZoom(a);return Ic-b/a};this.getZoom=function(a){var b=S;a&&(b=S*parseFloat(ha.width)/da);return F(G,b)};this.getRotation=function(a){return Z.imageR};this.getCoordinates=function(){new Z.Utils.Point(h.getX(),h.getY())};this.getViewCoordinatesString=
function(a){var b="x="+Math.round(h.getX(a)).toString(),c="&y="+Math.round(h.getY(a)).toString(),d="&z="+Math.round(100*h.getZoom(a)).toString();a=Math.round(h.getRotation(a));return b+c+d+(0==a?"":"&r="+a.toString())};this.getCoordinatesFull=function(a){return new Z.Utils.Coordinates(h.getX(a),h.getY(a),h.getZoom(a),h.getRotation(a))};this.setVisibility=function(a){a=a?"inline-block":"none";dc&&!Wa&&(Wa=dc.style);Wa&&(Wa.display=a);jb&&!y&&(y=jb.style);y&&(y.display=a)};this.setOpacity=function(a){Z.Utils.setOpacity(jb,
2<=a?a/100:0>a?0:1<a?1:a)};this.showLists=function(a){};this.z619=function(b){b||(X(hc,qa),wc=!0);(!Z.imageSet||Z.comparison||a==Z.imageSetStart||b)&&wa>ld&&(X(ic,qa),vc=!0,wa>kd&&(X(Wb,qa),uc=!0),h.setStatus("backfillPrecachedViewport",!0));qa.sort();qa=Z.Utils.arrayUnique(qa);kb=qa.slice(0);h.traceDebugValues("tilesBackfillToPrecache",null,kb.length);A(qa,Q,"simple","image-backfill")};this.prez581s=function(a){if(Z.imageSet)Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGIMAGESET-LOADINGTILES"),
!1,Z.messageDurationLong,"center"),h.updateView(!0,!0);else{Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGONEIMAGE-LOADINGTILES"),!1,Z.messageDurationLong,"center");Z.Utils.arrayClear(W);a=0;for(var b=wa;a<b;a++)for(var c=h.z542(a,null,!0,!0),d=c.l,e=c.r;d<=e;d++)for(var f=c.t,k=c.b;f<=k;f++){var m=a+"-"+d+"-"+f;W[W.length]=m}if(0<W.length)for(c=(new Date).getTime(),a=0,b=W.length;a<b;a++)if(m=W[a])m=new M(m,"image-display"),T(m,c,E)}};this.updateView=function(b,c){if("undefined"===typeof a||
null===a)a=0;if(a!=Z.viewportCurrentID&&!b){var d=Z["Viewport"+a.toString()];Z.imageX=d.getX(!0);Z.imageY=d.getY(!0);Z.imageZ=d.getZoom(!0);Z.imageR=d.getRotation(!0)}var e=Z.mouseIsDown||Z.buttonIsDown||Z.keyIsDown||Z.mouseWheelIsDown,d=S!=sb||h.getZoom()!=Z.imageZ||Z.imageZ!=Z.priorZ,k=parseFloat(y.left)!=la||parseFloat(y.top)!=ma||h.getX()!=Z.imageX||h.getY()!=Z.imageY,f=Z.fullViewPrior;if(d||k||f||"undefined"!==typeof b&&b&&(!e||Z.animation)||"undefined"!==typeof c&&c){ob();if(Z.comparison||Z.overlays||
!Z.imageSet||!Z.Viewer.getStatus("readyViewer")||a>Z.viewportCurrentID-1&&a<Z.viewportCurrentID+1||c){var m=!1;if(b||parseFloat(ha.width)!=aa.width){if(Z.useCanvas){ha.width=aa.width+"px";ha.height=aa.height+"px";ha.left="0px";ha.top="0px";oa.restore();oa.save();try{oa.scale(S,S)}catch(g){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE")),console.log("In function z630 scaling canvas:  "+g)}Cb&&(Ra.width=Cb.width+"px",Ra.height=Cb.height+"px",Ra.left="0px",Ra.top="0px");
Va&&(Sa.width=Va.width+"px",Sa.height=Va.height+"px",Sa.left="0px",Sa.top="0px");V&&(fa?(H.width=V.width+"px",H.height=V.height+"px",H.left=Oa+"px",H.top=Pa+"px",rb.restore(),rb.save(),rb.scale(Xa,Xa)):(H.width=db+"px",H.height=eb+"px",H.left=Oa+"px",H.top=Pa+"px"))}m=!0}if(b||parseFloat(y.left)!=la||parseFloat(y.top)!=ma)m=parseFloat(y.left)-la,e=parseFloat(y.top)-ma,0!=Z.imageR&&(e=Z.Utils.rotatePoint(m,e,Z.imageR),m=e.x,e=e.y),y.left=la+"px",y.top=ma+"px",fa||(Oa=parseFloat(H.left)+m,Pa=parseFloat(H.top)+
e,H.left=Oa+"px",H.top=Pa+"px"),f=h.getZoom(),Z.imageX=Hc=Z.imageX-m/f,Z.imageY=Ic=Z.imageY-e/f,m=!0;m&&(w(aa,G,xa,"centerOut",!1,"1a. Updating view: resetting display positions"),Z.maskingSelection&&fc&&displayMask(),fa&&w(V,ka,ta,"simple",!1,"1b. Updating view: resetting backfill positions"));m=!1;if("undefined"!==typeof b&&b||S!=sb||h.getZoom()!=Z.imageZ||!h.getStatus("initializedViewport")||c){S!=sb&&(Z.imageZ=h.getZoom());Z.imageZ<Z.minZ&&(Z.imageZ=Z.minZ);Z.imageZ>Z.maxZ&&(Z.imageZ=Z.maxZ);
f=Ad;for(e=wa;0<e&&f/2>=Z.imageZ;)e--,f/=2;e=0>e-1?0:e-1;f=x(e,Z.imageZ);if(e!=G||f!=S)Z.useCanvas&&(oa.restore(),oa.save(),oa.scale(f,f)),G!=e&&(yc=!0),G=e,S=f;sb=S;if("unconverted"!=Z.tileSource){fa=!1;G>Xc?(ka=G-Bd,fa=!0):ka=G>kd?Wb:G>ld?ic:hc;tierBackfillScalePrior=Xa=x(ka,Z.imageZ);var e=va[ka],f=Ga[ka],l=Z.imageX*Z.imageZ,u=Z.imageY*Z.imageZ;fa?(e=ed,db=da*e,eb=ea*e,Oa=-(da/e),Pa=-(ea/e),Kc=Ja*e,Lc=Ka*e,V.width=db,V.height=eb,H.width=V.width+"px",H.height=V.height+"px",H.left=Oa+"px",H.top=
Pa+"px",Z.useCanvas&&(I&&(Ia=x(Na,Z.imageZ),na.restore(),na.save(),na.scale(Ia,Ia),0!=Z.imageR&&na.rotate(Z.imageR*Math.PI/180)),rb.restore(),rb.translate(Kc,Lc),rb.save(),rb.scale(Xa,Xa))):(db=e*Xa,eb=f*Xa,Oa=Ja-l,Pa=Ka-u,V.width=e,V.height=f,Z.useCanvas&&(H.width=db+"px",H.height=eb+"px"),H.left=Oa+"px",H.top=Pa+"px");w(V,ka,ta,"simple",!1,"2. Updating view: changing tier - backfill")}!b&&0<Mb&&(m=!0)}else h.traceDebugValues("updateView-noChange");"unconverted"!=Z.tileSource&&fa?N(!0):I&&Z.Utils.clearDisplay(I)}a==
Z.viewportCurrentID||Z.comparison||Z.overlays||!Z.imageSet||c?("unconverted"!=Z.tileSource?(N(),w(aa,G,null,"centerOut",m,"3. Updating view: prior to loading of any new tiles")):"undefined"!==typeof Ba&&(m=-Z.imageX,e=-Z.imageY,Z.Utils.clearDisplay(aa),oa.drawImage(Ba,m,e),h.setStatus("displayLoadedViewport",!0),h.setStatus("displayDrawnViewport",!0),Z.Utils.validateCallback("viewUpdateComplete"),Z.Utils.validateCallback("viewUpdateCompleteGetLabelIDs")),Z.maskingSelection&&setMask(),0<W.length&&
A(W,E,"centerOut","image-display"),h.syncViewportRelated(!0,!0,!0,!0,!0,!0,Z.comparison&&a==Z.viewportCurrentID,Z.overlays&&a==Z.viewportCurrentID,Z.bookmarksSet,Z.tracking)):(h.setStatus("displayLoadedViewport",!0),h.setStatus("displayDrawnViewport",!0));c&&(m=(h.getViewportID()+1).toString()+" of "+Z.imageSetLength.toString(),Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGIMAGESET-UPDATINGVIEW")+"  "+m,!1,Z.messageDurationLong,"center"));k&&Z.Utils.validateCallback("viewPanned");d&&Z.Utils.validateCallback("viewZoomed");
(k||d)&&Z.Utils.validateCallback("viewChanged")}};syncTransitionCanvas=function(){za&&Sb&&Bb&&(za.width=aa.width,za.height=aa.height,Sb.width=ha.width,Sb.height=ha.height,Sb.left=ha.left,Sb.top=ha.top,Bb.restore(),Bb.save(),Bb.translate(Ja,Ka),Bb.scale(S,S))};this.loadUnconvertedImage=function(a){Ba=null;Ba=new Image;Ba.onload=k;Ba.onerror=u;Ba.src=a};this.getUnconvertedImage=function(){return Ba};this.createUnconvertedImageThumbnail=function(){if(Z.useCanvas){if("undefined"!==typeof Ba){var a=null,
a=150/Z.imageW,b=Z.Utils.createContainerElement("canvas","tempCanvas","inline-block","absolute","visible",Z.imageW*a+"px",Z.imageH*a+"px","0px","0px","none","0px","transparent none","0px","0px","normal"),c=b.getContext("2d");try{c.scale(a,a),c.drawImage(Ba,0,0)}catch(d){console.log("In function initializeViewportContinue scaling canvas:  "+d)}a=new Image;a.src=b.toDataURL("image/jpeg",Z.saveImageCompression);return a}window.setTimeout(function(){createUnconvertedImageThumbnail()},100)}};this.formatTilePath=
function(a,b,c,d){var e;if("ZoomifyImageFile"==Z.tileSource){e="offsetLoading";var f="loading",k="loading",m;if(1==tierTileOffsetsCount[a])f=Db[a];else{var g=new Za(a,b,c),l=g.chunkID+","+a+","+b+","+c+","+d+",offset";m=Z.Utils.arrayIndexOfObjectValue(tierTileOffsetChunks,"chunkID",g.chunkID);-1==m?(h.traceDebugValues("z532",g.chunkID+","+a+","+b+","+c+","+d),-1==Z.Utils.arrayIndexOf(ra,l)&&(ra[ra.length]=l),tierTileOffsetChunks[tierTileOffsetChunks.length]={chunkID:g.chunkID,chunk:"loading"},m=new Z.NetConnector,
m.loadByteRange(Jb,g.chunkStart,g.chunkEnd,"offset",null,g.chunkID)):"loading"==tierTileOffsetChunks[m].chunk?-1==Z.Utils.arrayIndexOf(ra,l)&&(ra[ra.length]=l):"loading"!=tierTileOffsetChunks[m].chunk&&(m=tierTileOffsetChunks[m].chunk,f=Z.Utils.longValue(m,g.offsetStartInChunk))}1==tierTileByteCountsCount[a]?k=tb[a]:(m=b+c*pa[a],2==tierTileByteCountsCount[a]?(a=tb[a],k=0==m?a.substring(0,a.indexOf(",")):a.substring(a.indexOf(",")+1,a.length)):(g=new ga(a,b,c),a=g.chunkID+","+a+","+b+","+c+","+d+",byteCount",
m=Z.Utils.arrayIndexOfObjectValue(tierTileByteCountChunks,"chunkID",g.chunkID),-1==m?(-1==Z.Utils.arrayIndexOf(ra,a)&&(ra[ra.length]=a),tierTileByteCountChunks[tierTileByteCountChunks.length]={chunkID:g.chunkID,chunk:"loading"},m=new Z.NetConnector,m.loadByteRange(Jb,g.chunkStart,g.chunkEnd,"byteCount",null,g.chunkID)):"loading"==tierTileByteCountChunks[m].chunk?-1==Z.Utils.arrayIndexOf(ra,a)&&(ra[ra.length]=a):"loading"!=tierTileByteCountChunks[m].chunk&&(m=tierTileByteCountChunks[m].chunk,k=Z.Utils.intValue(m,
g.bcStartInChunk))));"loading"==f||isNaN(f)||"loading"==k||isNaN(k)||(e=Jb+"?"+f.toString()+","+k.toString())}else if("ZoomifyImageFolder"==Z.tileSource){e=c*pa[a]+b;for(f=0;f<a;f++)e+=Ma[f];a=Jb+"/TileGroup"+Math.floor(e/256)+"/"+a+"-"+b+"-"+c+"."+Z.tileType;if(Z.browser==Z.browsers.IE&&9>Z.browserVersion||0==Mb)a=Z.Utils.cacheProofPath(a);e=a}return e};this.getClickCoordsAtZoom=function(a,b){var c=this.getClickCoordsInImage(a,b);return new Z.Utils.Point(c.x*b,c.y*b)};this.getClickCoordsInImage=
function(a,b,c){a=Z.Utils.event(a);var d=null;if(a){var e=a.type;if("undefined"===typeof b||null==b)b=h.getZoom();if("undefined"===typeof c||null===c)"touchstart"==e||"touchend"==e||"touchcancel"==e?(touch=Z.Utils.getFirstTouch(a),"undefined"!==typeof touch&&(target=touch.target,c=new Z.Utils.Point(touch.pageX,touch.pageY))):(target=Z.Utils.target(a),relatedTarget=Z.Utils.relatedTarget(a),c=Z.Utils.getMousePosition(a));"undefined"!==typeof c&&null!==c&&(a=h.z479(c.x,c.y),d=h.z485(a.x,a.y,b))}return d};
this.getClickZoomCoords3D=function(a,b,c,d,e){var f=parseFloat(Z.Utils.getResource("z93TIERSKIPTHRESHOLD"));b=h.z479(b.x,b.y);b=h.z485(b.x,b.y,Z.imageZ);var k=F(c,d);a=a.altKey;e?a?k=Z.fitZ:(e=x(c,Z.fitZ),d-e<f?k=Z.fitZ:d>1+f?k=F(c,1):0<c?k=F(c-1,1):"unconverted"==Z.tileSource&&(k=Z.fitZ)):a?k=Z.maxZ:d<1-f?k=F(c,1):c<wa-1?k=F(c+1,1):1<Z.maxZ&&(k=Z.maxZ);return new Z.Utils.Point3D(b.x,b.y,k)};this.calculateCurrentCenterCoordinates=function(a,b,c){if("undefined"===typeof a||null===a)a=new Z.Utils.Point(parseFloat(y.left),
parseFloat(y.top));if("undefined"===typeof c||null===c)c=h.getRotation();0>c&&(c+=360);if("undefined"===typeof b||null===b)b=h.getZoom();var d=Math.round(Z.imageX-(a.x-la)/b);a=Math.round(Z.imageY-(a.y-ma)/b);c=Z.Utils.getPositionRotated(d,a,Z.imageX,Z.imageY,-c);return new Z.Utils.Point(c.x,c.y)};this.z542=function(a,b,c,d){if("undefined"===typeof a||null===a)a=G;if("undefined"===typeof b||null===b)b=!1;return new ia(h.z541(b,c?a:null,d),a)};this.z541=function(a,b,c){var d=parseFloat(y.left)-la,
e=parseFloat(y.top)-ma;if(Z.useCanvas)var f=parseFloat(y.width)/P.width,d=d/f,e=e/f;f=h.getZoom();0!=d&&(d/=f);0!=e&&(e/=f);var d=Z.imageX-d,e=Z.imageY-e,k,m,g;a?(a=-(O/2),m=O/2,k=-(K/2),g=K/2):(a=-(da/2),m=da/2,k=-(ea/2),g=ea/2);return new r(d,e,a,m,k,g,f,b,c)};this.z480=function(a,b){var c=h.z479(a,b);return new Z.Utils.Point(c.x-la,c.y-ma)};this.convertViewportDisplayCoordsToPageCoords=function(a,b){var c=h.convertViewportCoordsToPageCoords(a+la,b+ma);return new Z.Utils.Point(c.x,c.y)};this.z479=
function(a,b){var c=Z.Utils.getElementPosition(ec);return new Z.Utils.Point(a-c.x+la,b-c.y+ma)};this.convertViewportCoordsToPageCoords=function(a,b){var c=Z.Utils.getElementPosition(ec);return new Z.Utils.Point(a+c.x-la,b+c.y-ma)};this.convertPageCoordsToImageCoords=function(a,b){var c=h.z479(a,b),c=h.z485(c.x,c.y,Z.imageZ);return new Z.Utils.Point(c.x,c.y)};this.convertImageCoordsToPageCoords=function(a,b,c,d){a=h.z478(a,b,c,d);a=h.convertViewportCoordsToPageCoords(a.x,a.y,Z.imageZ);return new Z.Utils.Point(a.x,
a.y)};this.z485=function(a,b,c,d){if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);var e=parseFloat(y.left)+Ja,f=parseFloat(y.top)+Ka;a-=e;b-=f;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,d),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(a/c+Z.imageX,b/c+Z.imageY)};this.z478=function(a,b,c,d){if("center"==a||isNaN(parseFloat(a)))a=Z.imageCtrX;if("center"==b||isNaN(parseFloat(b)))b=Z.imageCtrY;if("undefined"===
typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);a=(a-Z.imageX)*c;b=(b-Z.imageY)*c;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-d),a=viewportClickPt.x,b=viewportClickPt.y);d=parseFloat(y.left)+Ja;c=parseFloat(y.top)+Ka;return new Z.Utils.Point(a+d,b+c)};this.convertImageCoordsToViewportEdgeCoords=function(a,b,c,d){if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);a=(Z.imageX-a)*c;b=(Z.imageY-
b)*c;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-d),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(la+a,ma+b)};this.convertViewportEdgeCoordsToImageCoords=function(a,b,c,d){if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);a-=la;b-=ma;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-d),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(Z.imageX-a/c,Z.imageY-b/c)};this.z468=function(a,b,c){if("undefined"===
typeof a||null===a)a=Z.imageW;if("undefined"===typeof b||null===b)b=Z.imageH;var d=a/b>O/K?O/a:K/b;if(90==c||270==c)d=a/b>O/K?O/b:K/a;return d};this.calculateZoomToFill=function(a,b,c){if("undefined"===typeof a||null===a)a=Z.imageW;if("undefined"===typeof b||null===b)b=Z.imageH;var d=a/b>O/K?K/b:O/a;if(90==c||270==c)d=a/b>O/K?K/a:O/b;return d};this.calculateZoomForResize=function(a,b,c,d,e){var f=a,k=Z.imageW*a,m=Z.imageH*a;b=d/b;c=e/c;k<d&&m<e?f=a:k==d&&m<e?f=-1:k<d&&m==e?f=-1:k>d&&m<=e?f=a*b:k<=
d&&m>e?f=a*c:k>d&&m>e&&(d=1,1<=b&&1<=c?d=b>c?b:c:1>=b&&1>=c&&(d=b<c?b:c),f=a*d);f<Z.minZ&&(f=Z.minZ);f>Z.maxZ&&(f=Z.maxZ);return f};this.z482=function(a,b){return F(a,b)};this.syncViewportToNavigator=function(a){var b=Z.imageR;0>b&&(b+=360);var c=ca(a.x,a.y,Z.imageZ,b,"image");a=Z.imageY;var d=c.y,c=dX=Z.imageX-c.x;a=dY=a-d;0!=b&&(270<=b?(c=dY,a=-dX):180<=b?(c=-dX,a=-dY):90<=b&&(c=-dY,a=dX));b=c*Z.imageZ;a*=Z.imageZ;d=a+ma;y.left=b+la+"px";y.top=d+"px";I&&fa&&(Z.mobileDevice||Math.abs(b)>O/2||Math.abs(a)>
K/2)&&w(I,Na,ta,"simple",!1,"Updating backfill oversize display")};this.getStatus=function(a){a=Z.Utils.arrayIndexOfObjectValue(Kb,"state",a);return-1==a?!1:Kb[a].status};this.setStatus=function(a,b){var c=!1,d=Z.Utils.arrayIndexOfObjectValue(Kb,"state",a);-1==d?(c=b,Kb[Kb.length]={state:a,status:b}):(!Kb[d].status&&b&&(c=!0),Kb[d].status=b);c&&(Z.Utils.validateCallback(a),Z.Viewer.validateViewerStatus(a))};this.traceDebugValues=function(a,b,c,d){c="undefined"!==typeof c&&null!==c?c:null;b=null!==
b?b:"";switch(a){case "tilesToDisplay":zc=c;lc=Fb=mc=Ac=0;Pb=c;Ob=0;tilesTimeStart=(new Date).getTime();Gc=0;window.clearTimeout(Nb);Nb=null;Nb=window.setTimeout(Xb,cd);break;case "tilesInCache":Ac=c;break;case "z581-image-display":mc+=1;break;case "onTileLoad":Fb+=1;Ob=((new Date).getTime()-c)/1E3;Gc=Fb/Ob;break;case "z507":c=Z.Utils.arrayIndexOf(lb,b);-1!=c&&(lb.splice(c,1),lc+=1,--Pb);break;case "tilesBackfillToPrecache":bd=c;break;case "onTileBackfillPrecache":Bc+=1;break;case "tilesBackfillToDisplay":jd=
Cc=c;break;case "z599":Dc+=1;break;case "displayBackfillTile":c=Z.Utils.arrayIndexOf(kb,b),-1!=c&&(kb.splice(c,1),Fc+=1,--jd)}if(2==Z.debug){var e="undefined"!==typeof d&&null!==d&&0<d.length?d.join(", "):"none";c=!0;var f="";switch(a){case "updateView-noChange":f="Updating view: no change of tier.";break;case "tilesToDisplay":f="Tiles to display: "+e;break;case "tilesInCache":f="Tiles in cache: "+e;break;case "tilesToLoad":f="Tiles to load: "+e;break;case "tilesToLoad-backfill":f="Tiles to load-backfill: "+
e;break;case "z622-viewportDisplay":a=[];e=0;for(f=d.length;e<f;e++)a[a.length]=d[e].name;f="Tiles from cache-"+b+": "+a.join(", ");break;case "z622-backfillDisplay":a=[];e=0;for(f=d.length;e<f;e++)a[a.length]=d[e].name;f="Tiles from cache-"+b+": "+a.join(", ");break;case "z577-image-display":f="Tile requests for display: "+b+e;break;case "z577-image-backfill":f="Tile requests for backfill: "+b+e;break;case "imageRequestTimeout":f="Image request for "+b;break;case "z581-image-display":f="Tile request-display: "+
b;c=!1;break;case "z581-image-backfill":f="Tile request-backfill: "+b;c=!1;break;case "z581DelayForOffset":f="Tile not yet being loaded - offset chunk loading in progress: "+b;break;case "onTileLoad":f="Tiles received-display: "+b;c=!1;break;case "z599":f="Tiles received-backfill: "+b;0==qa.length&&(f+="\n\nTile loading complete for backfill: all requested tiles received.");c=!1;break;case "z532":f="Tile request recorded for after load offset chunk: "+b;break;case "z637":f="Requesting tiles after offset chunk received: "+
e;break;case "z577Retry":f=b;break;case "z507":f="Tile displaying: "+b;c=!1;break;case "blankLine":f=" "}""!=f&&Z.Utils.trace(f,!1,c)}};h.parseGeoCoordinatesXML=function(a){if(a=a.getElementsByTagName("SETUP")[0]){geoTop=a.getAttribute("GEOTOP");geoBottom=a.getAttribute("GEOBOTTOM");geoLeft=a.getAttribute("GEOLEFT");geoRight=a.getAttribute("GEORIGHT");var b=geoLeft,c=geoRight,d=geoTop;a=geoBottom;var e=b.substring(0,b.indexOf(",",0)),f=b.substring(b.indexOf(",",0)+1,b.indexOf(",",e.length+1)),k=1;
"W"==b.substring(b.indexOf(",",e.length+1+f.length)+1,b.length)&&(k=-1);geoLeftDec=(parseFloat(e)+parseFloat(f)/60)*k;b=c.substring(0,c.indexOf(",",0));e=c.substring(c.indexOf(",",0)+1,c.indexOf(",",b.length+1));f=1;"W"==c.substring(c.indexOf(",",b.length+1+e.length)+1,c.length)&&(f=-1);c=(parseFloat(b)+parseFloat(e)/60)*f;b=d.substring(0,d.indexOf(",",0));e=d.substring(d.indexOf(",",0)+1,d.indexOf(",",b.length+1));f=1;"S"==d.substring(d.indexOf(",",b.length+1+e.length)+1,d.length)&&(f=-1);geoTopDec=
(parseFloat(b)+parseFloat(e)/60)*f;d=a.substring(0,a.indexOf(",",0));b=a.substring(a.indexOf(",",0)+1,a.indexOf(",",d.length+1));e=1;"S"==a.substring(a.indexOf(",",d.length+1+b.length)+1,a.length)&&(e=-1);a=(parseFloat(d)+parseFloat(b)/60)*e;geoXSpan=c<geoLeftDec?180-geoLeftDec+(180+c):c-geoLeftDec;geoYSpan=geoTopDec-a}};this.setViewNoUpdate=function(a,b,c,d,e,f,k,m,h,g,l){y.left=a;y.top=b;ha.width=c;ha.height=d;ha.left=e;ha.top=f;H.width=k;H.height=m;H.left=h;H.top=g;y.rotation=l};this.setView=function(a,
b,c,d,e,f){Lb(a,b,c,d,e,f)};this.zoom=function(a){if("stop"!=a||"stop"!=Z.zooming){switch(a){case "out":0<=La&&(La-=Tb);break;case "in":0>=La&&(La+=Tb);break;case "stop":La=0}Z.zooming=0==La?"stop":0<La?"in":"out";0!=La?pb||(Z.useCanvas||Z.Utils.clearDisplay(Vb),pb=window.setTimeout(Gb,Jc)):(yb(),h.updateView())}};this.pan=function(a){if("horizontalStop"!=a||"stop"!=Z.panningX)if("verticalStop"!=a||"stop"!=Z.panningY){if(!Z.tracking)switch(a){case "left":0>=Ca&&(Ca+=pc);break;case "up":0>=Da&&(Da+=
pc);break;case "down":0<=Da&&(Da-=pc);break;case "right":0<=Ca&&(Ca-=pc);break;case "horizontalStop":Ca=0;break;case "verticalStop":Da=0;break;case "stop":Da=Ca=0}Z.panningX=0==Ca?"stop":0<Ca?"left":"right";Z.panningY=0==Da?"stop":0<Da?"up":"down";F(G,1);F(G,1);0!=Ca||0!=Da?pb||(Z.useCanvas||Z.Utils.clearDisplay(Vb),pb=window.setTimeout(Gb,Jc)):(yb(),h.updateView())}};this.zoomAndPanToView=function(a,b,c,d,e,f,k){h.zoomAndPanAllStop();if(Z.clickZoomAndPanBlock)Z.clickZoomAndPanBlock=!1;else{if("undefined"===
typeof a||null===a)a=Z.imageX;if("undefined"===typeof b||null===b)b=Z.imageY;if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;if("undefined"===typeof e||null===e)e=Ed;if("undefined"===typeof f||null===f)f=Uc;if("center"==a||isNaN(parseFloat(a)))a=Z.imageCtrX;if("center"==b||isNaN(parseFloat(b)))b=Z.imageCtrY;if(-1==c||isNaN(parseFloat(c)))c=Z.fitZ;Z.useCanvas||Z.Utils.clearDisplay(Vb);if("undefined"===typeof a||null===a)a=Z.initialX;if("undefined"===typeof b||
null===b)b=Z.initialY;if("undefined"===typeof d||null===d)d=Z.imageR;"undefined"===typeof c||null===c?c=Z.initialZ:100<c?c/=100:c>Z.maxZ?c=Z.maxZ:c<Z.maxZ&&c>Z.maxZ-.01&&(c=Z.maxZ);b=ca(a,b,c,d,"image");a=b.x;b=b.y;c=cb(c);if(Math.round(a)!=Math.round(Z.imageX)||Math.round(b)!=Math.round(Z.imageY)||Math.round(1E5*c)!=Math.round(1E5*Z.imageZ)||Math.round(d)!=Math.round(Z.imageR))Z.interactive=!1,Zb=0,Yb(a,b,c,d,e,f,k)}};this.zoomAndPanAllStop=function(a,b){Z.interactive&&(xb&&xb&&(window.clearTimeout(xb),
xb=null),Z.tourPlaying&&b&&(h.tourStop(),a=!1),Z.slideshowPlaying&&b&&(h.slideshowStop(),a=!1),Z.smoothPan&&null!==gb&&(Z.mouseIsDown||Nc(!0),a=!0),a||h.updateView())};this.syncViewportRelated=function(a,b,c,d,e,f,k,m,h,g){Z.Navigator&&("undefined"===typeof d||null===d||d)&&(Z.comparison&&0!=Hb?Z.Navigator2&&Z.Navigator2.syncToViewport():Z.Navigator&&Z.Navigator.syncToViewport());Z.Utils.validateCallback("viewChanging")};this.z633=function(a,b){m(a,b)&&h.syncViewportRelated()};this.reset=function(a){Z.maskingSelection&&
Z.maskClearOnUserAction&&h.clearMask();a?(Z.Utils.setButtonDefaults(buttonReset),h.zoomAndPanToView(Z.priorX,Z.priorY,Z.priorZ,Z.priorR)):h.zoomAndPanToView(Z.initialX,Z.initialY,Z.initialZ,Z.initialR);ob(!0)};this.getSmoothPanGliding=function(){return Ta};this.setSmoothPanGliding=function(a){Ta=a};this.mouseWheelHandler=function(a,b){Z.mouseWheelIsDown=!0;Z.mouseWheelCompleteTimer&&window.clearTimeout(Z.mouseWheelCompleteTimer);Z.mouseWheelCompleteTimer=window.setTimeout(Z.Viewer.z586,Z.mouseWheelCompleteDuration);
if(!("zoom"!=Z.sliderFocus||Z.imageSet&&b)){var c=h.z482(G,S*(1+(0<a?Tb:-Tb)));constrainedZ=cb(c);constrainedZ!=Z.imageZ&&(Z.zooming=0<a?"in":0>a?"out":"stop",h.z633(constrainedZ))}}};
Z.ZoomifyToolbar=function(a){function b(a){tbS&&(tbS.display=a?"inline-block":"none")}function c(b){if(b=Z.Utils.event(b)){var c=b.type,d=Z.Utils.target(b);if(d){e.background=B;g.background=B;l.background=B;var w=d.id;b=b.altKey;switch(c){case "mouseover":d.style.background=p;break;case "mousedown":d.style.background=v;"buttonZoomInInternal"==w?b||a.zoom("in"):"buttonZoomOutInternal"==w&&(b||a.zoom("out"));break;case "mouseup":d.style.background=p,a.zoom("stop"),"buttonResetInternal"==w&&a.reset(b)}}}}
var d=!1;a.getViewportID();var e,g,l,p=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONOVERCOLOR"),v=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONDOWNCOLOR"),B=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONUPCOLOR");(function(){var a=parseFloat(Z.Utils.getResource("UI_TOOLBARINTERNALBACKGROUNDALPHA")),b=Z.Utils.getResource("UI_TOOLBARINTERNALBACKGROUNDCOLOR"),p=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONUPCOLOR"),w=Z.viewerW/2-50,v=Z.viewerH-25-10,k=Math.round(25),u=Math.round(25/1.5),A=(100-3*k)/4,
M=(25-u)/2;Z.ToolbarDisplay=Z.Utils.createContainerElement("div","ToolbarDisplay","inline-block","absolute","visible","100px","25px",w+"px",v+"px","none","0px","transparent none","0px","0px","normal");tbS=Z.ToolbarDisplay.style;w=Z.Utils.createContainerElement("div","toolbarBackgroundInternal","inline-block","absolute","visible","100px","25px","0px","0px","solid","1px",b,"0px","0px","normal");Z.Utils.setOpacity(w,a,b);Z.ToolbarDisplay.appendChild(w);a=Z.Utils.createContainerElement("div","buttonZoomOutInternal",
"inline-block","absolute","visible",k+"px",u+"px",A+1+"px",M+1+"px","none","0px",p,"0px","0px","normal");Z.Utils.setOpacity(a,.4,b);w=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONZOOMOUTTEXT");w=document.createTextNode(w);a.appendChild(w);Z.ToolbarDisplay.appendChild(a);l=a.style;Z.Utils.setTextNodeStyle(w,"black","verdana","15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(w);w=Z.Utils.createContainerElement("div","buttonResetInternal","inline-block",
"absolute","visible",k+"px",u+"px",2*A+k+1+"px",M+1+"px","none","0px",p,"0px","0px","normal");Z.Utils.setOpacity(w,.4,b);v=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONRESETTEXT");v=document.createTextNode(v);w.appendChild(v);Z.ToolbarDisplay.appendChild(w);g=w.style;Z.Utils.setTextNodeStyle(v,"blue","verdana","15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(v);p=Z.Utils.createContainerElement("div","buttonZoomInInternal","inline-block","absolute",
"visible",k+"px",u+"px",3*A+2*k+1+"px",M+1+"px","none","0px",p,"0px","0px","normal");Z.Utils.setOpacity(p,.4,b);b=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONZOOMINTEXT");b=document.createTextNode(b);p.appendChild(b);Z.ToolbarDisplay.appendChild(p);e=p.style;Z.Utils.setTextNodeStyle(b,"black","verdana","15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(b);Z.Utils.addEventListener(a,"mouseover",c);Z.Utils.addEventListener(a,"mousedown",c);Z.Utils.addEventListener(a,
"mouseup",c);Z.Utils.addEventListener(a,"mouseout",c);Z.Utils.addEventListener(w,"mouseover",c);Z.Utils.addEventListener(w,"mousedown",c);Z.Utils.addEventListener(w,"mouseup",c);Z.Utils.addEventListener(w,"mouseout",c);Z.Utils.addEventListener(p,"mouseover",c);Z.Utils.addEventListener(p,"mousedown",c);Z.Utils.addEventListener(p,"mouseup",c);Z.Utils.addEventListener(p,"mouseout",c);tbS.zIndex=(Z.baseZIndex+2).toString();Z.ViewerDisplay.appendChild(Z.ToolbarDisplay);Z.Utils.addEventListener(Z.ToolbarDisplay,
"mouseover",Z.Utils.stopPropagation);d||(d=!0,Z.Utils.validateCallback("toolbarInitialized"),Z.Viewer.validateViewerReady("toolbarInitialized"))})();this.getInitialized=function(){return d};this.show=function(a){4>Z.toolbarVisible&&!Z.mobileDevice||8==Z.toolbarVisible||Z.toolbarInternal?b(a):minimize(!a)};this.setVisibility=function(a){b(a)}};
Z.ZoomifyNavigator=function(a){function b(c,d){var e="undefined"!==typeof d&&null!==d?!1:!0,k=e?a:d;if("unconverted"!=Z.tileSource)"ZoomifyImageFile"==Z.tileSource?yb=k.formatTilePath(0,0,0):"ZoomifyImageFolder"==Z.tileSource&&(yb=Z.Utils.cacheProofPath(k.getImagePath()+"/TileGroup0/0-0-0."+Z.tileType)),ca=null,ca=new Image,ca.onload=c,ca.onerror=w,"offsetLoading"!=yb?(e||(cb[cb.length]={id:d.getViewportID().toString(),image:ca}),"ZoomifyImageFile"==Z.tileSource?(new Z.NetConnector).loadImage(yb,
Z.Utils.createCallback(null,c),"navigator",null):ca.src=yb):window.setTimeout(function(){b(c)},100);else{var g=k.getUnconvertedImage();"undefined"!==typeof g&&null!==g?(ca=k.createUnconvertedImageThumbnail(g),e&&"function"===typeof c?c():cb[cb.length]="undefined"!==typeof d?{id:d.getViewportID().toString(),image:ca}:{id:null,image:null}):window.setTimeout(function(){b(c,d)},100)}}function c(a,b){"ZoomifyImageFile"==Z.tileSource&&(ca=b);var d=Z.Utils.createContainerElement("div","testImageContainer",
"inline-block","absolute","hidden",ab+"px",ob+"px","0px","0px","none","0px","transparent none","0px","0px","normal",null,!0);d.appendChild(ca);d.removeChild(ca);d=null;d=ca.height;if(0!=ca.width&&0!=d){T=Z.Utils.createContainerElement("div","navigatorDisplay"+ua,"inline-block","absolute","hidden",ab+"px",ob+"px",Lb+"px",Gb+"px","solid","1px","transparent none","0px","0px","normal",null,!0);E=Z.NavigatorDisplay=T;Q=E.style;Z.slideshow&&Z.Utils.setOpacity(Z.NavigatorDisplay,0);Q.zIndex=(Z.baseZIndex+
4).toString();var d=parseFloat(Z.Utils.getResource("z82")),k=Z.Utils.getResource("z83"),g=Z.Utils.getResource("z83NOALPHA"),k=Z.Utils.createContainerElement("div","navigatorBackground","inline-block","absolute","hidden",ab+"px",ob+"px","0px","0px","none","0px",k,"0px","0px","normal",null,!0);Z.Utils.setOpacity(k,d,g);T.appendChild(k);Eb=k;Aa=Eb.style;d=Z.Utils.createContainerElement("div","navigatorImageContainer","inline-block","absolute","hidden",ab+"px",ob+"px","0px","0px","none","0px","transparent none",
"0px","0px","normal",null,!0);d.appendChild(ca);ca.alt=Z.Utils.getResource("z439");T.appendChild(d);wb=d;ia=wb.style;r=ca;d=r.width;g=r.height;k=Z.Utils.createContainerElement("div","navigatorRectangle","inline-block","absolute","hidden",ab+1+"px",ob+1+"px",Lb+"px",Gb+"px","solid","1px","transparent none","0px","0px","normal",null,!0);k.style.borderColor=Z.Utils.stringValidateColorValue(Z.navigatorRectangleColor);T.appendChild(k);F=k;x=F.style;Z.ViewerDisplay.appendChild(T);e(ab,ob,Lb,Gb,Yb,d,g);
p(1==Z.navigatorVisible||2==Z.navigatorVisible);Z.Utils.addEventListener(E,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(E,"mousedown",U);Z.Utils.addEventListener(E,"touchstart",A);Z.Utils.addEventListener(E,"touchmove",M);Z.Utils.addEventListener(E,"touchend",ba);Z.Utils.addEventListener(E,"touchcancel",Za);ga||(ga=!0,Z.Utils.validateCallback("navigatorInitialized"),Z.Viewer.validateViewerReady("navigatorInitialized"));v()}else window.setTimeout(function(){c(a,b)},100)}function d(){ga&&
(ya&&(window.clearInterval(ya),ya=null),E&&Q&&Eb&&Aa&&wb&&ia&&r&&F&&x||(E=T,Q=E.style,Eb=T.firstChild,Aa=Eb.style,wb=T.childNodes[1],ia=wb.style,r=T.childNodes[1].firstChild,F=T.childNodes[2],x=F.style))}function e(a,b,c,d,e,k,l){e||(e=Yb);if("undefined"===typeof a||null===a)a=Z.navigatorW;if("undefined"===typeof b||null===b)b=Z.navigatorH;if("undefined"===typeof c||null===c)c=0;if("undefined"===typeof d||null===d)d=0;E||(E=T);Q||(Q=E.style);r=E.childNodes[1].firstChild;0==r.width&&"undefined"!==
k&&null!==k&&(r.width=k);0==r.height&&"undefined"!==l&&null!==l&&(r.height=l);E&&Q&&r&&(Z.tracking&&(e=0),"undefined"!==typeof e&&null!==e&&(k=r.width/r.height,l=Z.viewerW/Z.viewerH,e=0==e?l:k,1<k?b=a/e:(a=b,a*=e)),Q.width=a+"px",Q.height=b+"px",Q.left=c+"px",Q.top=d+"px",g(a,b));Z.navigatorW=a;Z.navigatorH=b}function g(a,b){r||(r=T.childNodes[1].firstChild);r&&0!=r.width&&0!=r.height?(Aa||(Aa=T.firstChild.style),ia||(ia=T.childNodes[1].style),Aa&&ia&&(Aa.width=a+"px",Aa.height=b+"px",l(a,b),ia.width=
r.width+"px",ia.height=r.height+"px",ia.left=(a-r.width)/2+"px",ia.top=(b-r.height)/2+"px",v())):window.setTimeout(function(){g(a,b)},100)}function l(a,b){r||(r=T.childNodes[1].firstChild);if(r){var c=r.width,d=r.height,e=c/d,k=a/c,g=b/d;k<=g?(c=a,d=a/e,navImageT=(b-a/c*d)/2):g<k&&(d=b,c=b*e,navImageL=(a-b/d*c)/2);r.width=c;r.height=d}}function p(a){!Q&&T&&(Q=T.style);Q&&(Q.display=a?"inline-block":"none")}function v(){if(a&&a.getStatus("initializedViewport")){D();B();var b=a.calculateCurrentCenterCoordinates();
X(b)}}function B(){if(r&&x){var b=r.width/Z.imageW,c=r.height/Z.imageH,d=a.getZoom(Z.comparison&&ua!=Z.viewportCurrentID),c=Z.viewerH*c/d;x.width=Z.viewerW*b/d+"px";x.height=c+"px"}}function D(){!ia&&T&&(ia=T.childNodes[1].style);if(ia){var b=a.getRotation();Z.Utils.rotateElement(ia,b,!0)}}function X(a){if(r&&x&&ia){if("undefined"===typeof a||null===a||0==a.x&&0==a.y)a=new Z.Utils.Point(Z.imageX,Z.imageY);if("undefined"===typeof z||null===z)z=Z.imageZ;var b=Z.imageR;0>b&&(b+=360);var c=parseFloat(r.width),
d=parseFloat(r.height),b=Z.Utils.rotatePoint(c/Z.imageW*a.x-c/2,d/Z.imageH*a.y-d/2,-b);a=b.x-parseFloat(x.width)/2;c=b.y-parseFloat(x.height)/2;b=parseFloat(Q.width)/2;c=parseFloat(Q.height)/2+c-1;x.left=b+a+(Z.comparison?-1:0)+"px";x.top=c+"px"}}function N(b){if(r&&x&&ia){var c=Z.imageZ,d=Z.imageR;0>d&&(d+=360);var e=parseFloat(r.width),k=parseFloat(r.height),g=e/Z.imageW,l=k/Z.imageH,u=Z.imageX*g,A=Z.imageY*l,p=Z.Utils.getPageScroll(),M=b?p.x:0,p=b?p.y:0,M=parseFloat(x.left)+M,p=parseFloat(x.top)+
p,e=M-parseFloat(Q.width)/2+parseFloat(x.width)/2+e/2,k=p-parseFloat(Q.height)/2+parseFloat(x.height)/2+k/2,u=Z.Utils.getPositionRotated(e,k,u,A,-d),g=Math.round(u.x/g),l=Math.round(u.y/l);b?a.zoomAndPanToView(g,l,c,d):(b=new Z.Utils.Point(g,l),a.syncViewportToNavigator(b));Z.tracking&&a.syncTrackingToViewport()}}function w(){Z.Utils.showMessage(Z.Utils.getResource("z271"))}function U(b){Z.interactive&&(a.zoomAndPanAllStop(!1,!0),Z.mouseIsDown=!0,E&&F&&x&&(b=Z.Utils.event(b),F.mouseXPrior=b.clientX,
F.mouseYPrior=b.clientY,dragPtStart=new Z.Utils.Point(b.clientX,b.clientY),Z.Utils.addEventListener(E,"mousemove",k),Z.Utils.addEventListener(E,"mouseup",u),Z.Utils.addEventListener(document,"mouseup",u)))}function k(a){if(Z.interactive&&F&&x){var b=parseFloat(x.left),c=parseFloat(x.top);x.left=b+(a.clientX-F.mouseXPrior)+"px";x.top=c+(a.clientY-F.mouseYPrior)+"px";F.mouseXPrior=a.clientX;F.mouseYPrior=a.clientY;N(!1);return!1}}function u(b){if(Z.interactive&&(Z.mouseIsDown=!1,E&&F&&x)){document.mousemove=
null;document.mouseup=null;Z.Utils.removeEventListener(E,"mousemove",k);Z.Utils.removeEventListener(E,"mouseup",u);Z.Utils.removeEventListener(document,"mouseup",u);b=Z.Utils.event(b);var c=new Z.Utils.Point(b.clientX,b.clientY);if(c=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,c.x,c.y)<xc){var d=Z.Utils.getElementPosition(T);x.left=b.clientX-d.x-parseFloat(x.width)/2+"px";x.top=b.clientY-d.y-parseFloat(x.height)/2+"px"}N(c);Z.comparison&&c||a.updateView()}}function A(a){Z.interactive&&
(Z.mouseIsDown=!0,a.preventDefault(),E&&F&&x&&(a=Z.Utils.getFirstTouch(a)))&&(a=new Z.Utils.Point(a.pageX,a.pageY),dragPtStart=new Z.Utils.Point(a.x,a.y),F.mouseXPrior=a.x,F.mouseYPrior=a.y)}function M(a){if(Z.interactive&&(a.preventDefault(),Z.mousePan)){if(F&&x&&(a=Z.Utils.getFirstTouch(a))){a=new Z.Utils.Point(a.pageX,a.pageY);var b=parseFloat(x.left),c=parseFloat(x.top);x.left=b+(a.x-F.mouseXPrior)+"px";x.top=c+(a.y-F.mouseYPrior)+"px";F.mouseXPrior=a.x;F.mouseYPrior=a.y;N(!1)}return!1}}function ba(b){if(Z.interactive&&
(Z.mouseIsDown=!1,E&&F&&x)){if(b=Z.Utils.getFirstTouch(b)){b=new Z.Utils.Point(b.pageX,b.pageY);var c=new Z.Utils.Point(b.x,b.y);if(c=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,c.x,c.y)<Xb){var d=Z.Utils.getElementPosition(T);x.left=b.x-d.x-parseFloat(x.width)/2+"px";x.top=b.y-d.y-parseFloat(x.height)/2+"px"}}N(c);a.updateView()}}function Za(b){if(Z.interactive&&(Z.mouseIsDown=!1,E&&F&&x)){if(b=Z.Utils.getFirstTouch(b)){b=new Z.Utils.Point(b.pageX,b.pageY);var c=new Z.Utils.Point(b.x,
b.y);if(c=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,c.x,c.y)<Xb){var d=Z.Utils.getElementPosition(T);x.left=b.x-d.x-parseFloat(x.width)/2+"px";x.top=b.y-d.y-parseFloat(x.height)/2+"px"}}N(c);a.updateView()}}var ga=!1,ua=a.getViewportID().toString(),ya,T,E,Q,Eb,Aa,wb,ia,r,F,x,ca,cb=[],xc=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDNAVIGATOR"),10),Xb=parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDNAVIGATOR"),10),ab=Z.navigatorW,ob=Z.navigatorH,Lb=Z.navigatorL,
Gb=Z.navigatorT,Yb=Z.navigatorFit,yb;("multiple"!=Z.imagePath||Z.comparison||Z.overlays&&"0"==a.getViewportID())&&b(c);this.z556=function(a,b){c(a,b)};this.getInitialized=function(){return ga};this.setVisibility=function(a){p(a)};this.setSelected=function(a){if(!b)var b=document.getElementById("navigatorBorder"+ua);b&&(b.style.display=a?"inline-block":"none")};this.syncToViewport=function(){v()};this.z657=function(){B()};this.z659=function(){D()};this.z658=function(a){X(a)};this.z682=function(){ga?
d():ya=window.setInterval(d,300)};this.setSizeAndPosition=function(a,b,c,d,k,g,l){e(a,b,c,d,k,g,l)};this.getSizeAndPositionNavigatorImage=function(){r||(r=T.childNodes[1].firstChild);var a=null;"undefined"!==typeof r.parentNode&&null!==r.parentNode&&(a=r.parentNode.style,a={width:r.width,height:r.height,left:parseFloat(a.left)-1,top:parseFloat(a.top)-1});return a}};
Z.NetConnector=function(){function a(a,c,d){var g=a.substring(0,a.indexOf("?")),l=parseFloat(a.substring(a.indexOf("?")+1,a.indexOf(",")));a=parseFloat(a.substring(a.indexOf(",")+1,a.length));l=new Z.Utils.Range(l,l+a);b(g,e,l,c,d)}function b(a,b,e,g,l,p,w){var v=c();if(null===v)Z.Utils.showMessage(Z.Utils.getResource("z295"));else{var B="function"===typeof b;if(B){var D=b;b=function(){window.setTimeout(Z.Utils.createCallback(null,D,v),1)};v.onreadystatechange=function(){4==v.readyState&&(v.onreadystatechange=
new Function,b())}}try{if("undefined"===typeof e||null===e)v.open("GET",a,B),"loadHTML"==g&&v.setRequestHeader("Content-Type","text/html"),v.send(null);else if("undefined"!==typeof g&&null!==g)if(!Z.localUse||"postXML"!=g&&"postImage"!=g)if("postXML"==g)if(l=null,"annotation"!=w||"undefined"!==typeof Z.annotationPath&&Z.Utils.stringValidate(Z.annotationPath)?"tracking"!=w||"undefined"!==typeof Z.trackingPath&&Z.Utils.stringValidate(Z.trackingPath)||(l=Z.Utils.getResource("ERROR_TRACKINGPATHMISSING")):
l=Z.Utils.getResource("ERROR_ANNOTATIONPATHMISSING"),null!==l)Z.Utils.showMessage(l,!1,Z.messageDurationStandard,"center");else{var E,Q,N,X,U;"annotation"==w?(E=Z.annotationPath,N=E.toLowerCase(),U=Z.Utils.getResource("z69")):"tracking"==w&&(E=Z.trackingPath,N=E.toLowerCase(),U=Z.Utils.getResource("DEFAULT_TRACKINGXMLFILE"));Q=N.length;".json"!=N.substring(Q-5,Q)&&".xml"!=N.substring(Q-4,Q)&&(X="/"+U);w=E+X;Z.postingXML=!0;v.open("POST",a+"?file="+w,!0);Z.Utils.defineObjectProperty(v,"file",{value:w,
writable:!1,enumerable:!1,configurable:!1});v.setRequestHeader("Content-Type","application/xml");v.send(e)}else if("postImage"==g){Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVEUPLOADING"),!1,"none","center");Z.postingImage=!0;var ia=new FormData;ia.append("fileToUpload",e);Z.Utils.addEventListener(v.upload,"progress",Z.Utils.uploadProgress);v.open("POST",a,!0);Z.Utils.defineObjectProperty(v,"zType",{value:"postingImage",writable:!1,enumerable:!1,configurable:!1});v.setRequestHeader("Content-Type",
"application/upload");v.send(ia)}else"ZoomifyImageFile"==Z.tileSource&&("tile"!=g&&(a=Z.Utils.cacheProofPath(a)),v.open("GET",a,!0),v.responseType="arraybuffer",Z.Utils.defineObjectProperty(v,"zType",{value:g,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.defineObjectProperty(v,"zTile",{value:l,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.defineObjectProperty(v,"zChunkNumber",{value:p,writable:!1,enumerable:!1,configurable:!1}),Z.browser==Z.browsers.SAFARI&&v.setRequestHeader("If-Modified-Since",
"Thu, 01 Dec 1994 16:00:00 GMT"),v.setRequestHeader("Range","bytes="+e.start.toString()+"-"+e.end.toString()),v.send(null));else Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALSAVING"),!1,Z.messageDurationStandard,"center",!0)}catch(r){d(r,a,g),v=null,console.log(r)}}}function c(){var a=null;switch(Z.xmlHttpRequestSupport){case "XMLHttpRequest":a=new XMLHttpRequest;break;case "Msxml2.XMLHTTP.6.0":a=new ActiveXObject("Msxml2.XMLHTTP.6.0");break;case "Msxml2.XMLHTTP.3.0":a=new ActiveXObject("Msxml2.XMLHTTP.3.0");
break;case "Microsoft.XMLHTTP":a=new ActiveXObject("Microsoft.XMLHTTP")}return a}function d(a,b,c){1==Z.localUse&&(Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA||Z.browser==Z.browsers.IE&&11==Z.browserVersion||Z.browser==Z.browsers.SAFARI&&7<=Z.browserVersion)?Z.Utils.showMessage(Z.Utils.getResource("z288"),!1,Z.messageDurationStandard,"center"):1==Z.localUse&&"ZoomifyImageFile"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z290"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf(".zif")?
Z.Utils.showMessage(Z.Utils.getResource("z256-ZIFBYTERANGE")+c+".",!1,Z.messageDurationShort,"center"):-1!=b.indexOf("ImageProperties.xml")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEXML"),!0,null,"left"):-1!=b.toLowerCase().indexOf(".pff")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEHEADER"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf("reply_data")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEOFFSET"),!1,Z.messageDurationShort,"center"):Z.Utils.showMessage(Z.Utils.getResource("z256"),
!1,Z.messageDurationShort,"center")}function e(a,b){if(a)if(200!==a.status&&0!==a.status&&206!==a.status){var c=a.status,d=404==c?"Not Found":a.statusText;Z.xmlParametersParsing?Z.Utils.showMessage(Z.Utils.getResource("z256-PARAMETERSXML"),!0,null,"left"):Z.Toolbar&&!Z.Toolbar.getInitialized()?Z.Utils.showMessage(Z.Utils.getResource("z256-TOOLBARSKINSXML"),!0,null,"left"):"ZoomifyImageFile"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z273RANGEREQUESTS")+c+" - "+d,!0,null,"left"):Z.Utils.showMessage(Z.Utils.getResource("z273")+
c+" - "+d,!1,Z.messageDurationShort,"center")}else if(c=null,c="undefined"!==typeof Z.annotationPath&&Z.Utils.stringValidate(Z.annotationPath)&&".json"==Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-5,Z.annotationPath.length),Z.postingImage&&a.zType&&"postingImage"==a.zType)Z.postingImage=!1,Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVESUCCESSFUL"),!1,Z.messageDurationShort,"center");else if(a.response&&a.zType&&"ZoomifyImageFile"==Z.tileSource){if(Z.Viewport)if(c=new Z.Utils.createUint8Array(a.response,
0),"header"==a.zType)if("undefined"===typeof b||null===b)Z.Viewport.parseZIFHeader(c);else for(var d=0,e=Z.imageSetLength;d<e;d++)b==d&&Z["Viewport"+d.toString()].parseZIFHeader(c);else if("offset"==a.zType)if("undefined"===typeof b||null===b)Z.Viewport.parseZIFOffsetChunk(c,a.zChunkNumber);else for(d=0,e=Z.imageSetLength;d<e;d++)b==d&&Z["Viewport"+d.toString()].parseZIFOffsetChunk(c,a.zChunkNumber);else if("byteCount"==a.zType)if("undefined"===typeof b||null===b)Z.Viewport.parseZIFByteCountChunk(c,
a.zChunkNumber);else for(d=0,e=Z.imageSetLength;d<e;d++)b==d&&Z["Viewport"+d.toString()].parseZIFByteCountChunk(c,a.zChunkNumber);else if("image"==a.zType.substring(0,5))B--,Z.Viewport.parseZIFImage(c,a.zTile,a.zType);else if("navigator"==a.zType)if("undefined"===typeof b||null===b)Z.viewportCurrent.parseZIFImage(c,a.zTile,a.zType);else for(d=0,e=Z.imageSetLength;d<e;d++)b==d&&Z["Viewport"+d.toString()].parseZIFImage(c,a.zTile,a.zType);else if("gallery"==a.zType)if("undefined"===typeof b||null===
b)Z.viewportCurrent.parseZIFImage(c,a.zTile,a.zType);else for(d=0,e=Z.imageSetLength;d<e;d++)b==d&&Z["Viewport"+d.toString()].parseZIFImage(c,a.zTile,a.zType);else Z.Utils.showMessage(Z.Utils.getResource("z256-ZIFBYTES"),!1,Z.messageDurationShort,"center")}else a.responseXML&&a.responseXML.documentElement&&!c?(c=a.responseXML,g(c,b)):a.responseText&&(d=a.responseText,-1!=d.indexOf("ZAS")&&c?z680(d,b):"ZoomifyImageFolder"==Z.tileSource?(c=Z.Utils.xmlConvertTextToDoc(d),g(c,b)):"ZoomifyImageFile"==
Z.tileSource&&(c=Z.Utils.xmlConvertTextToDoc(d),g(c,b)));else Z.Utils.showMessage(Z.Utils.getResource("z272"),!1,Z.messageDurationShort,"center")}function g(a,b){if(a&&a.documentElement){var c=a.documentElement.tagName;if("IMAGE_PROPERTIES"==c||"ZIFHEADER"==c||"PFFHEADER"==c){if("ZoomifyImageFile"==Z.tileSource||"ZoomifyImageFolder"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource||"ImageServer"==Z.tileSource)if("multiple"!=Z.imagePath)("undefined"===typeof b||null===b||0==b?Z.Viewport:Z["Viewport"+
b.toString()]).z602(a);else for(var c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].z602(a)}else Z.Utils.showMessage(Z.Utils.getResource("z296"),!0)}else Z.Utils.showMessage(Z.Utils.getResource("z293"),!0)}function l(b,c,d,e){if(B<D)return B++,"ZoomifyImageFile"==Z.tileSource&&("undefined"!==typeof e&&null!==e||"navigator"==d)?a(b,d,e):(c=Z.Utils.createCallback(null,p,c),(new v(b,c,d)).start()),!0;-1==Z.Utils.arrayIndexOfObjectValue(U,"sc",b)&&(U[U.length]={sc:b,cb:c,ct:d,t:e},w||
(w=window.setInterval(function(){var a=U[0];l(a.sc,a.cb,a.ct,a.t)&&(U=Z.Utils.arraySplice(U,0,1));0==U.length&&w&&(window.clearInterval(w),w=null)},N)));return!1}function p(a,b,c){B--;if("function"===typeof a)try{a(c)}catch(d){Z.Utils.showMessage(d.name+Z.Utils.getResource("z245")+b+" "+d.message,!0)}}function v(a,b,c){function d(c){e.onload=null;e.onabort=null;e.onerror=null;g&&window.clearTimeout(g);window.setTimeout(function(){b(a,c?e:null)},1)}var e=null,g=null;this.start=function(){e=new Image;
var b=function(){d(!1)};e.onload=function(){d(!0)};e.onabort=b;e.onerror=b;g=window.setTimeout(function(){console.log(Z.Utils.getResource("z253"));d(!1);Z.Viewport.traceDebugValues("imageRequestTimeout",c+" timeout: "+a)},X);e.src=a}}var B=0,D=parseInt(Z.Utils.getResource("z140"),10),X=parseFloat(Z.Utils.getResource("z139")),N=Z.Utils.getResource("DEFAULT_IMAGELOADQUEUEDELAY"),w,U=[];this.loadHTML=function(a,c){b(a,c,null)};this.loadXML=function(a,c){"undefined"===typeof c||null===c?b(a,e,null):b(a,
function(a){e(a,c)},null)};this.loadJSON=function(a){b(a,e,null)};this.loadByteRange=function(a,c,d,g,l,p){c=new Z.Utils.Range(c,d);b(a,e,c,g,l,p)};this.postXML=function(a,c,d){b(a,e,c,"postXML",null,null,d)};this.postImage=function(a,c){b(a,e,c,"postImage")};this.loadImage=function(a,b,c,d){l(a,b,c,d)}};
Z.Utils={addCrossBrowserMethods:function(){document.addEventListener?(this.disableTextInteraction=function(a){if(a){var b=a.parentNode.style;b&&(a.parentNode.unselectable="on",b.userSelect="none",b.MozUserSelect="none",b.webkitUserSelect="none",b.webkitTouchCallout="none",b.webkitTapHighlightColor="transparent")}},this.renderQuality=function(a,b){b&&a.style.setProperty("image-rendering","high"==b?"optimizeQuality":"optimizeSpeed",null)},this.setOpacity=function(a,b,c){Z.alphaSupported?a.style.opacity=
b:c&&(a.style.backgroundColor=c)}):document.attachEvent&&(this.disableTextInteraction=function(a){a&&(a.parentNode.unselectable="on",a.parentNode.onselectstart=function(){return!1})},this.renderQuality=function(a,b){b&&(a.style.msInterpolationMode="high"==b?"bicubic":"nearest-neighbor")},this.setOpacity=function(a,b,c){Z.alphaSupported?(b*=100,a.style.zoom=1,a.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+b+")",a.style.filter="alpha(opacity="+b+")",100==b&&(a.style.filter="")):c&&
(a.style.backgroundColor=c)})},addCrossBrowserEvents:function(){document.addEventListener?(this.addEventListener=function(a,b,c){a&&("mousewheel"==b&&a.addEventListener("DOMMouseScroll",c,!1),a.addEventListener(b,c,!1))},this.removeEventListener=function(a,b,c){a&&("mousewheel"==b&&a.removeEventListener("DOMMouseScroll",c,!1),a.removeEventListener(b,c,!1))},this.event=function(a){return a},this.target=function(a){return a.target},this.relatedTarget=function(a){return a.relatedTarget},this.isRightMouseButton=
function(a){var b=!1;if(2==a.which||3==a.which)b=!0;return b},this.preventDefault=function(a){a.preventDefault()},this.stopPropagation=function(a){a.stopPropagation()}):document.attachEvent&&(this.addEventListener=function(a,b,c){if(-1==this._findListener(a,b,c)){var d=function(){var b=window.event;Function.prototype.call?c.call(a,b):(a._currentListener=c,a._currentListener(b),a._currentListener=null)};a.attachEvent("on"+b,d);b={target:a,eventName:b,handler:c,handler2:d};var d=(a.document||a).parentWindow,
e="l"+this._listenerCounter++;d._allListeners||(d._allListeners={});d._allListeners[e]=b;a._listeners||(a._listeners=[]);a._listeners[a._listeners.length]=e;d._unloadListenerAdded||(d._unloadListenerAdded=!0,d.attachEvent("onunload",this._removeAllListeners))}},this.removeEventListener=function(a,b,c){if(a&&(c=this._findListener(a,b,c),-1!=c)){var d=(a.document||a).parentWindow,e=a._listeners[c];a.detachEvent("on"+b,d._allListeners[e].handler2);a._listeners=Z.Utils.arraySplice(a._listeners,c,1);delete d._allListeners[e]}},
this.event=function(a){return window.event},this.target=function(a){return a.srcElement},this.relatedTarget=function(a){var b=null;"mouseover"==a.type?b=a.fromElement:"mouseout"==a.type&&(b=a.toElement);return b},this.isRightMouseButton=function(a){var b=!1;2==a.button&&(b=!0);return b},this.preventDefault=function(a){a&&(a.returnValue=!1)},this.stopPropagation=function(a){a.cancelBubble=!0},this._findListener=function(a,b,c){var d=a._listeners;if(!d)return-1;a=(a.document||a).parentWindow;for(var e=
d.length-1;0<=e;e--){var g=a._allListeners[d[e]];if(g&&g.eventName==b&&g.handler==c)return e}return-1},this._removeAllListeners=function(){for(id in this._allListeners){var a=this._allListeners[id];a.target.detachEvent("on"+a.eventName,a.handler2);delete this._allListeners[id]}},this._listenerCounter=0)},declareGlobals:function(){Z.pageContainerID=null;Z.imagePath=null;Z.imagePath2=null;Z.parameters=null;Z.xmlParametersPath=null;Z.xMLParametersPath=null;Z.xmlParametersParsing=null;Z.xMLParametersParsing=
null;Z.skinPath=null;Z.skinMode=null;Z.cacheProofCounter=0;Z.timerCounter=0;Z.browsers=null;Z.browser=null;Z.browserVersion=null;Z.scaleThreshold=null;Z.canvasSupported=null;Z.cssTransformsSupported=null;Z.cssTransformProperty=null;Z.cssTransformNoUnits=null;Z.alphaSupported=null;Z.renderQuality=null;Z.rotationSupported=null;Z.fullScreenSupported=null;Z.arrayMapSupported=null;Z.arraySpliceSupported=null;Z.float32ArraySupported=null;Z.uInt8ArraySupported=null;Z.xmlHttpRequestSupport=null;Z.definePropertySupported=
null;Z.responseArraySupported=null;Z.responseArrayPrototyped=!1;Z.touchSupport=null;Z.mobileDevice=null;Z.localUse=null;Z.zifSupported=null;Z.onReady=null;Z.onAnnotationReady=null;Z.initialX=null;Z.initialY=null;Z.initialZ=null;Z.initialZoom=null;Z.minZ=null;Z.minZoom=null;Z.maxZ=null;Z.maxZoom=null;Z.zoomSpeed=null;Z.panSpeed=null;Z.smoothPan=null;Z.smoothPanEasing=null;Z.smoothZoom=null;Z.smoothZoomEasing=null;Z.smoothPanGlide=null;Z.autoResize=null;Z.fadeIn=null;Z.fadeInSpeed=null;Z.toolbarInternal=
null;Z.toolbarVisible=null;Z.toolbarAutoShowHide=null;Z.toolbarW=null;Z.toolbarH=null;Z.toolbarPosition=null;Z.navigatorVisible=null;Z.navigatorW=null;Z.navigatorWidth=null;Z.navigatorH=null;Z.navigatorHeight=null;Z.navigatorL=null;Z.navigatorLeft=null;Z.navigatorT=null;Z.navigatorTop=null;Z.navigatorFit=null;Z.navigatorRectangleColor=null;Z.GalleryScrollPanel=null;Z.galleryVisible=null;Z.galleryAutoShowHide=null;Z.galleryW=null;Z.galleryH=null;Z.galleryL=null;Z.galleryT=null;Z.galleryPosition=null;
Z.galleryRectangleColor=null;Z.mouseIsDownGallery=null;Z.clickZoom=null;Z.doubleClickZoom=null;Z.doubleClickDelay=null;Z.clickPan=null;Z.clickZoomAndPanBlock=!1;Z.mousePan=null;Z.keys=null;Z.constrainPan=null;Z.constrainPanLimit=null;Z.constrainPanStrict=null;Z.panBuffer=null;Z.tooltipsVisible=null;Z.helpVisible=0;Z.helpPath=null;Z.helpCustom=!1;Z.helpContent=null;Z.helpW=null;Z.helpWidth=null;Z.helpH=null;Z.helpHeight=null;Z.helpL=null;Z.helpLeft=null;Z.helpT=null;Z.helpTop=null;Z.minimizeVisible=
null;Z.sliderZoomVisible=null;Z.sliderVisible=null;Z.panButtonsVisible=null;Z.resetVisible=null;Z.fullViewVisible=null;Z.fullScreenVisible=null;Z.fullPageVisible=null;Z.initialFullPage=null;Z.fullPageInitial=null;Z.fullScreenEntering=null;Z.progressVisible=null;Z.messagesVisible=null;Z.logoVisible=null;Z.logoLink=null;Z.logoLinkURL=null;Z.logoCustomPath=null;Z.bookmarksGet=null;Z.bookmarksSet=null;Z.copyrightPath=null;Z.watermarkPath=null;Z.watermarks=null;Z.virtualPointerVisible=null;Z.crosshairsVisible=
null;Z.zoomRectangle=null;Z.rulerVisible=null;Z.units=null;Z.unitsPerImage=null;Z.pixelsPerUnit=null;Z.sourceMagnification=null;Z.magnification=null;Z.rulerListType=null;Z.rulerW=null;Z.rulerWidth=null;Z.rulerH=null;Z.rulerHeight=null;Z.rulerL=null;Z.rulerLeft=null;Z.rulerT=null;Z.rulerTop=null;Z.measureVisible=!1;Z.rotationVisible=null;Z.rotationFree=null;Z.initialR=null;Z.initialRotation=null;Z.imageListPath=null;Z.imageList=null;Z.imageListTitle=null;Z.imageListFolder=null;Z.imageListFileShared=
!1;Z.imageSetImageListPath=null;Z.imageListTimeout=null;Z.screensaver=!1;Z.screensaverSpeed=null;Z.tour=!1;Z.tourPath=null;Z.tourListTitle=null;Z.tourPlaying=null;Z.tourStop=!1;Z.comparison=!1;Z.comparisonPath=null;Z.syncVisible=null;Z.initialSync=null;Z.syncComparison=null;Z.slideshow=!1;Z.slidePath=null;Z.slideListTitle=null;Z.slideshowPlaying=null;Z.slideTransitionTimeout=null;Z.slideTransitionSpeed=null;Z.slideOpacity=0;Z.audioContent=!1;Z.audioMuted=!1;Z.hotspots=!1;Z.hotspotPath=null;Z.hotspotFolder=
null;Z.hotspotListTitle=null;Z.hotspotsDrawOnlyInView=!0;Z.captionBoxes=!1;Z.captionsColorsDefault=!0;Z.annotations=!1;Z.annotationPath=null;Z.annotationFolder=null;Z.annotationXMLText=null;Z.annotationJSONObject=null;Z.annotationsAddMultiple=null;Z.annotationsAutoSave=null;Z.annotationPanelVisible=null;Z.annotationPanelVisibleState=!1;Z.saveButtonVisible=null;Z.labelClickSelect=null;Z.simplePath=!1;Z.noPost=!1;Z.noPostDefaults=!1;Z.unsavedEditsTest=!0;Z.maskVisible=null;Z.maskingSelection=!1;Z.maskFadeTimeout=
null;Z.maskFadeSpeed=null;Z.maskOpacity=0;Z.maskClearOnUserAction=null;Z.externalEditPermissionFunction=null;Z.annotationSort="none";Z.saveHandlerPath=null;Z.saveImageHandlerPath=null;Z.saveImageFull=null;Z.postingXML=!1;Z.postingImage=!1;Z.coordinatesVisible=null;Z.geoCoordinatesPath=null;Z.geoCoordinatesVisible=null;Z.geoCoordinatesFolder=null;Z.preloadVisible=null;Z.imageFilters=null;Z.imageFiltersVisible=null;Z.initialImageFilters=null;Z.brightnessVisible=null;Z.contrastVisible=null;Z.sharpnessVisible=
null;Z.blurrinessVisible=null;Z.colorRedVisible=null;Z.colorGreenVisible=null;Z.colorBlueVisible=null;Z.colorRedRangeVisible=null;Z.colorGreenRangeVisible=null;Z.colorBlueRangeVisible=null;Z.colorRedRangeMin=null;Z.colorRedRangeMax=null;Z.colorGreenRangeMin=null;Z.colorGreenRangeMax=null;Z.colorBlueRangeMin=null;Z.colorBlueRangeMax=null;Z.saveImageFull=null;Z.saveImageFilename=null;Z.saveImageFormat=null;Z.saveImageCompression=null;Z.saveImageBackColor=null;Z.tracking=!1;Z.trackingPath=null;Z.trackingFolder=
null;Z.trackingPathProvided=!1;Z.trackingEditMode=!1;Z.trackingFileShared=!1;Z.imageSetTrackingPath=null;Z.trackingPanelPosition=null;Z.trackingCounts=[];Z.trackingTypeCurrent="0";Z.trackingOverlayVisible=!1;Z.initialTrackingOverlayVisible=null;Z.trackingCellCurrent=null;Z.trackingPanelVisible=null;Z.trackingPanelVisibleState=!1;Z.userName=null;Z.userInitials=null;Z.userLogin=null;Z.userNamePrompt=null;Z.userNamePromptRetry=null;Z.userPath=null;Z.userFolder=null;Z.userPathProvided=!1;Z.userList=[];
Z.userLogging=!1;Z.UserPanel=null;Z.userPanelVisible=null;Z.userPanelVisibleState=!1;Z.canvas=null;Z.baseZIndex=null;Z.debug=null;Z.imageProperties=null;Z.serverIP=null;Z.serverPort=null;Z.tileHandlerPath=null;Z.tileHandlerPathFull=null;Z.iiifInfoJSONObject=null;Z.iiifScheme=null;Z.iIIFScheme=null;Z.iiifServer=null;Z.iIIFServer=null;Z.iiifPrefix=null;Z.iIIFPrefix=null;Z.iiifIdentifier=null;Z.iIIFIdentifier=null;Z.iiifRegion=null;Z.iIIFRegion=null;Z.iiifSize=null;Z.iIIFSize=null;Z.iiifRotation=null;
Z.iIIFRotation=null;Z.iiifQuality=null;Z.iIIFQuality=null;Z.iiifFormat=null;Z.iIIFFormat=null;Z.tileW=null;Z.tileH=null;Z.tileType="jpg";Z.tilesPNG=null;Z.freehandVisible=null;Z.textVisible=null;Z.iconVisible=null;Z.rectangleVisible=null;Z.polygonVisible=null;Z.captionTextColor=null;Z.captionBackColor=null;Z.polygonLineColor=null;Z.polygonFillColor=null;Z.captionTextVisible=!0;Z.captionBackVisible=!0;Z.polygonFillVisible=!1;Z.polygonLineVisible=!0;Z.annotationPathProvided=!1;Z.saveHandlerProvided=
!1;Z.imageSetPathProvided=!1;Z.slidePathProvided=!1;Z.saveImageHandlerProvided=!1;Z.tileSource=null;Z.tileSourceMultiple=null;Z.focal=null;Z.quality=null;Z.markupMode=null;Z.editMode=null;Z.editAdmin=!1;Z.editing=null;Z.labelMode="view";Z.editModePrior=Z.editMode;Z.xmlCallbackFunction=null;Z.labelsClickDrag=!1;Z.sliderFocus="zoom";Z.overlayPath=null;Z.overlays=!1;Z.overlayJSONObject=null;Z.overlaysInitialVisibility=null;Z.animation=!1;Z.animationPath=null;Z.animationCount=0;Z.animationAxis=null;Z.animator=
null;Z.animationFlip=null;Z.slidestack=!1;Z.slidestackPath=null;Z.imageSet=!1;Z.imageSetPath=null;Z.imageSetLength=null;Z.imageSetListPosition=null;Z.imageSetListTitle=null;Z.imageSetStart=null;Z.imageSetLoop=null;Z.sliderImageSetVisible=null;Z.mouseWheelParmeterProvided=null;Z.mouseWheel=null;Z.imageSetHotspotPath=null;Z.hotspotFileShared=!1;Z.imageSetAnnotationPath=null;Z.annotationFileShared=!1;Z.messageDurationLong=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONLONG"),10);Z.messageDurationStandard=
parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONSTANDARD"),10);Z.messageDurationShort=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONSHORT"),10);Z.messageDurationVeryShort=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONVERYSHORT"),10);Z.Viewer=null;Z.ViewerDisplay=null;Z.Viewport=null;Z.Toolbar=null;Z.ToolbarDisplay=null;Z.ToolbarMinimized=!1;Z.TooltipDisplay=null;Z.Navigator=null;Z.Navigator2=null;Z.NavigatorDisplay=null;Z.MessageDisplay=null;Z.messages=null;Z.messageDisplayList=
[];Z.overlayMessage=null;Z.CoordinatesDisplay=null;Z.coordinates=null;Z.coordinatesSave=null;Z.CopyrightDisplay=null;Z.AnnotationPanelDisplay=null;Z.imageW=null;Z.imageH=null;Z.imageD=null;Z.imageCtrX=null;Z.imageCtrY=null;Z.imageX=0;Z.imageY=0;Z.imageZ=0;Z.imageR=0;Z.priorX=0;Z.priorY=0;Z.priorZ=0;Z.priorR=0;Z.preventDupCall=!1;Z.fitZ=null;Z.fillZ=null;Z.zooming="stop";Z.panningX="stop";Z.panningY="stop";Z.rotating="stop";Z.fullView=!1;Z.fullViewPrior=!1;Z.interactive=!0;Z.useCanvas=!0;Z.expressParamsEnabled=
null;Z.proParamsEnabled=null;Z.specialStorageEnabled=null;Z.enterpriseParamsEnabled=null;Z.updateViewPercent=0;Z.TraceDisplay=null;Z.traces=null;Z.mouseIsDown=!1;Z.buttonIsDown=!1;Z.keyIsDown=!1;Z.mouseWheelIsDown=!1;Z.mouseWheelCompleteDuration=null;Z.mouseWheelCompleteTimer=null;Z.mouseOutDownPoint=null;Z.viewportCurrentID=0;Z.viewportCurrent=null;Z.viewportChangeTimeout=null},detectBrowserFeatures:function(){Z.browsers={UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6};var a=Z.browsers.UNKNOWN,
b=0,c=1E4,d=navigator.appName,e=navigator.appVersion,g=!1,l=!1,p=navigator.userAgent.toLowerCase();if(-1!=p.indexOf("edge"))a=Z.browsers.EDGE,b=e;else if("Microsoft Internet Explorer"==d&&window.attachEvent&&window.ActiveXObject)b=p.indexOf("msie"),a=Z.browsers.IE,b=parseFloat(p.substring(b+5,p.indexOf(";",b))),g="undefined"!==typeof document.documentMode;else if("Netscape"==d&&-1!=p.indexOf("trident"))a=Z.browsers.IE,b=11;else if("Netscape"==d&&window.addEventListener){var v=p.indexOf("firefox"),
d=p.indexOf("safari"),e=p.indexOf("chrome");0<=v?(a=Z.browsers.FIREFOX,b=parseFloat(p.substring(v+8)),c=1E4):0<=d&&(c=p.substring(0,d).lastIndexOf("/"),a=0<=e?Z.browsers.CHROME:Z.browsers.SAFARI,b=parseFloat(p.substring(c+1,d)),c=1E4);d=new Image;d.style.getPropertyValue&&(l=d.style.getPropertyValue("image-rendering"))}else"Opera"==d&&window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera)&&(a=Z.browsers.OPERA,b=parseFloat(e));var B;if(window.XMLHttpRequest)netReq=new XMLHttpRequest,
B="XMLHttpRequest";else if(window.ActiveXObject)for(d=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],e=0,v=d.length;e<v;e++)try{netReq=new ActiveXObject(d[e]);B=d[e];break}catch(D){}var d="response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype,e=document.createElement("canvas"),e=!(!e.getContext||!e.getContext("2d")),v=!(a==Z.browsers.SAFARI&&4>b||a==Z.browsers.CHROME&&
2>b),e=e&&v,v=!(a==Z.browsers.CHROME&&2>b),l=g||l?"high":null,X=(document.documentElement||{}).style||{},g=!1,N=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],w,U;for(;w=N.shift();)if("undefined"!==typeof X[w]){g=!0;U=/webkit/i.test(w);break}var X=g,N="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,k=-1<p.indexOf("iphone")||-1<p.indexOf("ipad")||-1<p.indexOf("ipod"),p=-1<p.indexOf("android")||
k,k=!1;if("undefined"!==typeof document.cancelFullScreen||"undefined"!==typeof document.webkitCancelFullScreen||"undefined"!==typeof document.mozCancelFullScreen||"undefined"!==typeof document.oCancelFullScreen||"undefined"!==typeof document.msCancelFullScreen||"undefined"!==typeof document.msExitFullscreen)k=!0;var u=Array.prototype.map,A=Array.prototype.splice,M=!1;try{new Float32Array(1),M=!0}catch(D){}var ba=!1;try{new Uint8Array(1),ba=!0}catch(D){}var Za=!1;if("function"==typeof Object.defineProperty)try{Object.defineProperty({},
"x",{}),Za=!0}catch(D){}var ga;switch(window.location.protocol){case "http:":ga=!1;break;case "https:":ga=!1;break;case "file:":ga=!0;break;default:ga=null}var ua=!(Z.browser==Z.browsers.IE&&9>Z.browserVersion||Z.browser==Z.browsers.OPERA&&15>Z.browserVersion||Z.browser==Z.browsers.CHROME&&25>Z.browserVersion&&Z.browser==Z.browsers.FIREFOX&&20>Z.browserVersion&&Z.browser==Z.browsers.SAFARI&&5>Z.browserVersion);Z.browser=a;Z.browserVersion=b;Z.scaleThreshold=c;Z.xmlHttpRequestSupport=B;Z.responseArraySupported=
d;Z.canvasSupported=e;Z.useCanvas=Z.canvasSupported;Z.imageFilters=!Z.useCanvas&&Z.imageFilters?!1:Z.imageFilters;Z.cssTransformsSupported=g;Z.cssTransformProperty=w;Z.cssTransformNoUnits=U;Z.alphaSupported=v;Z.renderQuality=l;Z.rotationSupported=X;Z.fullScreenSupported=k;Z.arrayMapSupported=u;Z.arraySpliceSupported=A;Z.float32ArraySupported=M;Z.uInt8ArraySupported=ba;Z.definePropertySupported=Za;Z.touchSupport=N;Z.mobileDevice=p;Z.localUse=ga;Z.zifSupported=ua},parseParameters:function(a){var b=
[];if("object"===typeof a)b=a;else if("string"===typeof a){a=a.split("&");for(var c=0,d=a.length;c<d;c++){var e=a[c],g=e.indexOf("=");if(0<g){var l=e.substring(0,g),e=e.substring(g+1);b[l]=e}}}return b},setParameters:function(a){var b=this.getResource("z110"),c=this.getResource("z109"),d=this.getResource("z108");Z.expressParamsEnabled=b!=c?!0:!1;Z.expressParamsEnabled||(Z.toolbarInternal=!0,Z.logoLinkURL=Z.Utils.getResource("z427"));var c=this.getResource("z187"),e=this.getResource("z186"),b=this.getResource("z185");
Z.proParamsEnabled=c!=e?!0:!1;c=this.getResource("z215");e=this.getResource("z214");this.getResource("z213");Z.specialStorageEnabled=c!=e?!0:!1;var e=this.getResource("z107"),g=this.getResource("z106"),c=this.getResource("z105");Z.enterpriseParamsEnabled=e!=g?!0:!1;Z.skinPath=this.getResource("z201");Z.skinMode=this.getResource("z199");isNaN(parseFloat(this.getResource("z143")))||(Z.initialX=parseFloat(this.getResource("z143")));isNaN(parseFloat(this.getResource("z144")))||(Z.initialY=parseFloat(this.getResource("z144")));
isNaN(parseFloat(this.getResource("z145")))||(Z.initialZ=parseFloat(this.getResource("z145")));isNaN(parseFloat(this.getResource("z163")))||(Z.minZ=parseFloat(this.getResource("z163")));isNaN(parseFloat(this.getResource("z153")))||(Z.maxZ=parseFloat(this.getResource("z153")));isNaN(parseFloat(this.getResource("z241")))||(Z.zoomSpeed=parseFloat(this.getResource("z241")));isNaN(parseFloat(this.getResource("z175")))||(Z.panSpeed=parseFloat(this.getResource("z175")));isNaN(parseFloat(this.getResource("z111")))||
(Z.fadeInSpeed=parseFloat(this.getResource("z111")));Z.fadeIn=0<Z.fadeInSpeed;Z.navigatorVisible=parseInt(this.getResource("z171"),10);null===Z.navigatorW&&(Z.navigatorW=parseInt(this.getResource("z172"),10));null===Z.navigatorH&&(Z.navigatorH=parseInt(this.getResource("z167"),10));null===Z.navigatorL&&(Z.navigatorL=parseInt(this.getResource("z168"),10));null===Z.navigatorT&&(Z.navigatorT=parseInt(this.getResource("z170"),10));null===Z.navigatorFit&&(Z.navigatorFit=this.getResource("z166"));null===
Z.navigatorRectangleColor&&(Z.navigatorRectangleColor=this.getResource("z169"));Z.clickZoom="0"!=this.getResource("z93");Z.doubleClickZoom="0"!=this.getResource("DEFAULT_DOUBLECLICKZOOM");Z.doubleClickDelay=parseFloat(this.getResource("DEFAULT_DOUBLECLICKDELAY"));Z.clickPan="0"!=this.getResource("z92");Z.mousePan="0"!=this.getResource("z164");Z.constrainPan="0"!=this.getResource("z95");Z.constrainPanLimit=parseInt(this.getResource("z95LIMIT"),10);Z.constrainPanStrict="0"!=this.getResource("z95STRICT");
Z.panBuffer=parseFloat(this.getResource("z173"));Z.smoothPan=Z.useCanvas&&!Z.comparison&&"0"!=this.getResource("DEFAULT_SMOOTHPAN");Z.smoothPanEasing=parseInt(this.getResource("DEFAULT_SMOOTHPANEASING"),10);Z.smoothPanGlide=parseInt(this.getResource("DEFAULT_SMOOTHPANGLIDE"),10);Z.smoothZoom="0"!=this.getResource("DEFAULT_SMOOTHZOOM");Z.smoothZoomEasing=parseInt(this.getResource("DEFAULT_SMOOTHZOOMEASING"),10);Z.keys="0"!=this.getResource("z146");Z.canvas="0"!=this.getResource("z88");Z.baseZIndex=
parseInt(this.getResource("DEFAULT_BASEZINDEX"),10);Z.debug=parseInt(this.getResource("z104"),10);Z.toolbarVisible=parseInt(this.getResource("z223"),10);Z.toolbarAutoShowHide=0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&6!=Z.toolbarVisible&&7!=Z.toolbarVisible&&8!=Z.toolbarVisible;Z.toolbarPosition=parseFloat(this.getResource("z222"));Z.mouseWheel=parseInt(this.getResource("DEFAULT_MOUSEWHEEL"),10);Z.zoomButtonsVisible="0"!=this.getResource("DEFAULT_ZOOMBUTTONSVISIBLE");Z.panButtonsVisible="0"!=this.getResource("z174");
Z.resetVisible="0"!=this.getResource("DEFAULT_RESETVISIBLE");Z.tooltipsVisible="0"!=this.getResource("z224");Z.messagesVisible="0"!=this.getResource("DEFAULT_MESSAGESVISIBLE");(e=document.getElementById(Z.pageContainerID))&&Z.Utils.getElementStyle(e);if("object"===typeof a&&null!==a){e=this.getResource("z287");Z.mouseWheelParmeterProvided=void 0!==a.zMouseWheel;Z.slidePathProvided=Z.imagePath&&-1!=Z.imagePath.indexOf("zSlidePath")||void 0!==a.zSlidePath;var g=Z.slidePathProvided||Z.comparison||Z.overlays||
Z.slideshow||Z.imageSetPathProvided||Z.animation||Z.slidestack,l;for(l in a)if(!("function"===typeof a[l]&&"zOnAnnotationReady"!==l&&"zOnReady"!==l||g&&("each"==l||"eachSlice"==l||"all"==l||"any"==l||"collect"==l||"detect"==l||"findAll"==l||"select"==l||"grep"==l||"include"==l||"member"==l||"inGroupsOf"==l||"inject"==l||"invoke"==l||"max"==l||"min"==l||"partition"==l||"pluck"==l||"reject"==l||"sortBy"==l||"toArray"==l||"zip"==l||"size"==l||"inspect"==l||"_reverse"==l||"_each"==l||"clear"==l||"first"==
l||"last"==l||"compact"==l||"flatten"==l||"without"==l||"uniq"==l||"intersect"==l||"clone"==l)||-1!=l.indexOf("this.indexOf")))if("undefined"===typeof Z[Z.Utils.stringLowerCaseFirstLetter(l.substr(1))])g?console.log(e+" "+l):alert(e+" "+l);else if(pValue=a[l],Z.expressParamsEnabled||"zNavigatorVisible"==l)switch(l){case "zNavigatorVisible":Z.navigatorVisible=parseInt(pValue,10);break;default:if(Z.proParamsEnabled)switch(l){default:Z.enterpriseParamsEnabled||alert(c+" "+l)}else alert(b+" "+l)}else alert(d+
" "+l)}Z.Utils.validateImagePath()},resetParametersXYZ:function(a){isNaN(parseFloat(this.getResource("z143")))||(Z.initialX=parseFloat(this.getResource("z143")));isNaN(parseFloat(this.getResource("z144")))||(Z.initialY=parseFloat(this.getResource("z144")));isNaN(parseFloat(this.getResource("z145")))||(Z.initialZ=parseFloat(this.getResource("z145")));isNaN(parseFloat(this.getResource("z163")))||(Z.minZ=parseFloat(this.getResource("z163")));isNaN(parseFloat(this.getResource("z153")))||(Z.maxZ=parseFloat(this.getResource("z153")));
if(this.stringValidate(a))for(var b=0,c=a.length;b<c;b++){var d=a[b],e=d.indexOf("=");if(0<e){var g=d.substring(0,e),d=d.substring(e+1);if(this.stringValidate(d))switch(g){case "zInitialX":isNaN(parseFloat(d))||(Z.initialX=parseFloat(d));break;case "zInitialY":isNaN(parseFloat(d))||(Z.initialY=parseFloat(d));break;case "zInitialZoom":"fit"==d&&(d="-1");"fill"==d&&(d="0");isNaN(parseFloat(d))||(Z.initialZ=parseFloat(d),Z.initialZ&&0<Z.initialZ&&100>=Z.initialZ&&(Z.initialZ/=100));break;case "zMinZoom":"fit"==
d&&(d="-1");"fill"==d&&(d="0");isNaN(parseFloat(d))||(Z.minZ=parseFloat(d),Z.minZ&&0<Z.minZ&&100>=Z.minZ&&(Z.minZ/=100));break;case "zMaxZoom":isNaN(parseFloat(d))||(Z.maxZ=parseFloat(d),Z.maxZ&&-1!=Z.maxZ&&(Z.maxZ/=100))}}}},validateImagePath:function(a){a="undefined"!==typeof a&&Z.Utils.stringValidate(a)?a:Z.imagePath;if(null!==a){var b=this.getResource("z213");-1!=a.toLowerCase().indexOf(".zif")?Z.zifSupported?(Z.tileSource="ZoomifyImageFile",Z.Utils.validateResponseArrayFunctionality()):alert(this.getResource("z16")):
-1!=a.toLowerCase().indexOf(".jpg")||-1!=a.toLowerCase().indexOf(".png")?Z.tileSource="unconverted":Z.Utils.stringValidate(Z.tileHandlerPath)?Z.Utils.stringValidate(Z.tileHandlerPath)&&(Z.specialStorageEnabled?(Z.tileSource="ImageServer",Z.tileHandlerPathFull=Z.tileHandlerPath):alert(b)):Z.tileSource="ZoomifyImageFolder"}else if(Z.imageSet||Z.slideshow)Z.tileSourceMultiple=!0},clearImageParameters:function(){Z.imagePath=null;Z.imagePath2=null;Z.parameters=null;Z.xmlParametersPath=null;Z.xmlParametersParsing=
null;Z.initialX=null;Z.initialY=null;Z.initialZ=null;Z.minZ=null;Z.maxZ=null;Z.geoCoordinatesPath=null;Z.geoCoordinatesVisible=null;Z.geoCoordinatesFolder=null;Z.tour=!1;Z.tourPath=null;Z.tourPlaying=null;Z.tourStop=!1;Z.hotspots=!1;Z.hotspotPath=null;Z.hotspotFolder=null;Z.annotations=!1;Z.annotationPath=null;Z.annotationPanelVisible=null;Z.annotationFolder=null;Z.annotationJSONObject=null;Z.annotationXMLText=null;Z.labelIconsInternal=null;Z.annotationsAddMultiple=null;Z.annotationsAutoSave=null;
Z.postingXML=!1;Z.postingImage=!1;Z.initialR=null;Z.unitsPerImage=null;Z.pixelsPerUnit=null;Z.sourceMagnification=null;Z.imageProperties=null;Z.annotationPathProvided=!1;Z.imageSetPathProvided=!1;Z.slidePathProvided=!1;Z.tileSource=null;Z.tileSourceMultiple=null;Z.focal=null;Z.quality=null;Z.tracking||(Z.markupMode=null,Z.editMode=null,Z.editAdmin=!1,Z.editing=null,Z.labelMode="view",Z.editModePrior=Z.editMode);Z.sliderFocus="zoom";Z.animation=!1;Z.animationPath=null;Z.animationCount=0;Z.animationAxis=
null;Z.animator=null;Z.animationFlip=null;Z.slidestack=!1;Z.slidestackPath=null;Z.mouseWheelParmeterProvided=null;Z.mouseWheel=null;Z.imageSetHotspotPath=null;Z.hotspotFileShared=!1;Z.imageSetAnnotationPath=null;Z.annotationFileShared=!1;Z.imageW=null;Z.imageH=null;Z.imageD=null;Z.imageCtrX=null;Z.imageCtrY=null;Z.imageX=0;Z.imageY=0;Z.imageZ=0;Z.imageR=0;Z.fitZ=null;Z.fillZ=null;Z.zooming="stop";Z.panningX="stop";Z.panningY="stop";Z.rotating="stop";Z.fullView=!1;Z.fullViewPrior=!1},getResource:function(a){var b=
"";switch(a){case "z110":b="Changing This Violates License Agreement";break;case "z109":b="Changing This Violates License Agreement";break;case "z108":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Express, Pro, and Enterprise editions: ";break;case "z187":b="Changing This Violates License Agreement";break;case "z186":b="Changing This Violates License Agreement";break;case "z185":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Pro and Enterprise editions: ";
break;case "z215":b="Changing this violates License Agreement";break;case "z214":b="Changing this violates License Agreement";break;case "z213":b="Support for Zoomify Image File (PFF) storage and other special storage options is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Enterprise edition.";break;case "z107":b="Changing this violates License Agreement";break;case "z106":b="Changing this violates License Agreement";break;case "z105":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Enterprise edition: ";
break;case "z125":b="0";break;case "z124":b="8192";break;case "z90":b="ZoomifyImageFile"==Z.tileSource?"1024":"256";break;case "z221":b="IIIFImageServer"!=Z.tileSource?"256":"512";break;case "z219":b="IIIFImageServer"!=Z.tileSource?"256":"512";break;case "z140":b="300";break;case "z139":b="60000";break;case "DEFAULT_IMAGELOADQUEUEDELAY":b="100";break;case "z218":b="1.15";break;case "z220":b="300";break;case "z81":b="6";break;case "z78":b="3";break;case "z80":b="5";break;case "z77":b="3";break;case "z79":b=
"3";break;case "z76":b="2";break;case "z75":b="0";break;case "z173":b=Z.mobileDevice?"1":"1.5";Z.rotationVisible&&(b="2");break;case "z173UNCONVERTED":b=Z.mobileDevice?Z.rotationVisible?"2":"1":"10";break;case "DEFAULT_z310SIZEMAXBROWSER":b="10000";break;case "DEFAULT_z310SIZEMAXFIREFOX":b="4000";break;case "DEFAULT_z310SIZEMAXMOBILE":b="3000";break;case "DEFAULT_z310SIZEMAXIMAGESET":b="1000";break;case "z74":reTxt=Z.mobileDevice?"1":"2";break;case "z88":b="1";break;case "DEFAULT_BASEZINDEX":b="2000";
break;case "DEFAULT_VALIDATEVIEWRETRYLIMIT":b="2";break;case "DEFAULT_VALIDATEVIEWRETRYDELAY":b="1000";break;case "z104":b="0";break;case "DEFAULT_MOUSECLICKTHRESHOLDVIEWPORT":b=4;break;case "DEFAULT_MOUSECLICKTHRESHOLDTIMEVIEWPORT":b=500;break;case "DEFAULT_MOUSECLICKTHRESHOLDHOTSPOT":b=4;break;case "DEFAULT_TOUCHTAPTHRESHOLDVIEWPORT":b=Z.mobileDevice?6:4;break;case "DEFAULT_TOUCHTAPTHRESHOLDTIMEVIEWPORT":b=500;break;case "DEFAULT_MOUSECLICKTHRESHOLDNAVIGATOR":b=4;break;case "DEFAULT_TOUCHTAPTHRESHOLDNAVIGATOR":b=
Z.mobileDevice?6:3;break;case "z175":b="5";break;case "z176":b="10";break;case "z241":b="5";break;case "z242":b="0.02";break;case "z238":b="30";break;case "z240":b="20";break;case "z239":b="800";break;case "z93TIERSKIPTHRESHOLD":b="0.2";break;case "DEFAULT_ROTATIONSTEPDEGREES":b="1";break;case "DEFAULT_ROTATIONSTEPDURATION":b="1";break;case "z122":b="10";break;case "DEFAULT_AUTORESIZESKIPDURATION":b="10";break;case "DEFAULT_MOUSEWHEEL":b="1";break;case "DEFAULT_MOUSEWHEELANIMATION":b="1";break;case "DEFAULT_MOUSEWHEELSLIDESTACK":b=
"1";break;case "z165":b="300";break;case "z111":b="5";break;case "z112":b="0.067";break;case "z146":b="1";break;case "z164":b="1";break;case "z92":b="1";break;case "z93":b="1";break;case "DEFAULT_DOUBLECLICKZOOM":b="1";break;case "DEFAULT_DOUBLECLICKDELAY":b="250";break;case "z95":b="1";break;case "z95LIMIT":b="2";break;case "z95STRICT":b="0";break;case "DEFAULT_SMOOTHPAN":b="1";break;case "DEFAULT_SMOOTHPANEASING":b="2";break;case "DEFAULT_SMOOTHPANGLIDE":b="2";break;case "DEFAULT_SMOOTHZOOM":b=
"1";break;case "DEFAULT_SMOOTHZOOMEASING":b="2";break;case "z143":b=null;break;case "z144":b=null;break;case "z145":b=null;break;case "z163":b=null;break;case "z153":b="1";break;case "z83":b="#FBFAFA";break;case "z83NOALPHA":b="#FBFAFA";break;case "z83LIGHT":b="#FEFEFE";break;case "z82":b="0.75";break;case "DEFAULT_BACKGROUNDSMALLDALPHA":b="0.75";break;case "z87":b="#C0C0C0";break;case "z200":b="skinFiles.xml";break;case "z201":b="Assets/Skins/Default";break;case "z199":b="0";break;case "z171":b=
"2";break;case "z172":b="150";break;case "z167":b="100";break;case "z168":b="-1";break;case "z170":b="-1";break;case "z166":b=null;break;case "z169":b="#0000FF";break;case "DEFAULT_NAVIGATORBORDERCOLOR":b="#FFFFFF";break;case "z223":b="4";break;case "z222":b="1";break;case "z224":b="1";break;case "DEFAULT_ZOOMBUTTONSVISIBLE":b="1";break;case "z174":b="1";break;case "DEFAULT_RESETVISIBLE":b="1";break;case "DEFAULT_MESSAGESVISIBLE":b="1";break;case "z159":b="lightgray";break;case "z158":b="white";break;
case "DEFAULT_MESSAGEDURATIONLONG":b="5000";break;case "DEFAULT_MESSAGEDURATIONSTANDARD":b="3000";break;case "DEFAULT_MESSAGEDURATIONSHORT":b="1500";break;case "DEFAULT_MESSAGEDURATIONVERYSHORT":b="750";break;case "z16":b="Viewing Zoomify Images stored in the ZIF format requires a newer browser version. Please consider upgrading to the current release of your browser.";break;case "ERROR_ERROR":b="error";break;case "z287":b="Parameter unrecognized or deprecated - see the Parameters List documentation: ";
break;case "z275":b="Parameter deprecated - please replace: ";break;case "z288":b="Use Firefox for local viewing or see READ ME FIRST\nfile for optional settings for other browsers.";break;case "z290":b="Browsers allow ZIF file viewing only from a web server.\nPlease use Zoomify Image folders for local viewing.";break;case "z249":b="Image failed to load: possible invalid path, missing image, or network error.";break;case "z280":b="Sorry!  Part of this view is not refreshing.  The network may be slow, or the website may be missing a file:  ";
break;case "ERROR_VALIDATEVIEW":b="Sorry!  Part of this view is not refreshing. The network\nmay be slow, or the website may be missing a file.  ";break;case "z280-ZIF":b="Sorry!  Part of this view is not refreshing.  The network may be slow, or the ZIF file may be faulty:  ";break;case "z256-ZIFBYTERANGE":b="Error loading image: ZIF file data request failed. Request content type: ";break;case "z256-ZIFBYTES":b="Error loading image: ZIF file invalid.";break;case "z295":b="Browser does not support XMLHttpRequest.";
break;case "z256-IMAGEXML":b="Error loading image: please make sure image path in web page matches image folder location on webserver.";break;case "z256-PARAMETERSXML":b="Error loading parameters XML: please make sure the zXMLParametersPath value is correct.";break;case "z256-TOOLBARSKINSXML":b="Error loading toolbar - skin files not found: please verify that the folders 'Assets/Skins/Default' are in same folder as the web page displaying the Viewer, or add zSkinPath parameter to web page. The zSkinPath parameter may be required if using a content management system such as Drupal, Joomla, or WordPress.";
break;case "z256":b="Error making network request:\npossible invalid path or network error.";break;case "z272":b="Error related to network security: ";break;case "z273":b="Error related to network status: ";break;case "z273RANGEREQUESTS":b="Network error. If using ZIF storage, setting MIME type on web server may be necessary. See READ ME FIRST file in ZIF Storage folder or contact Support: ";break;case "z294":b="Browser does not support XML DOM.";break;case "z293":b="XML Doc invalid.";break;case "z296":b=
"XML invalid.";break;case "z255":b="Image XML invalid.";break;case "z252":b="Image properties XML invalid.";break;case "z250":b="Image properties invalid.";break;case "z251":b="Image properties parameter invalid.";break;case "z254":b="Image tile count does not match value in image XML. If the count is invalid display problems can result.";break;case "z245":b=" while executing callback: ";break;case "z253":b="\nImage tile request not fulfilled within time period expected";break;case "z271":b="Navigator image failed to load: possible invalid path, missing image, or network error.";
break;case "z283":b="Unknown element style - no known method to identify.";break;case "z284":b="Unknown mouse position - no known method to calculate.";break;case "z285":b="Unknown mouse scroll - no known method to calculate.";break;case "z286":b="Unknown window size - no known method to calculate.";break;case "z362":b="Accept And Close Message";break;case "z361":b="Decline And Close Message";break;case "z427":b="http://www.zoomify.com";break;case "UI_TOOLBARINTERNALBACKGROUNDALPHA":b="0.75";break;
case "UI_TOOLBARINTERNALBACKGROUNDCOLOR":b="lightgray";break;case "UI_TOOLBARINTERNALBUTTONUPCOLOR":b="white";break;case "UI_TOOLBARINTERNALBUTTONOVERCOLOR":b="lightgray";break;case "UI_TOOLBARINTERNALBUTTONDOWNCOLOR":b="darkgray";break;case "UI_TOOLBARINTERNALBUTTONZOOMINTEXT":b="+";break;case "UI_TOOLBARINTERNALBUTTONRESETTEXT":b="Z";break;case "UI_TOOLBARINTERNALBUTTONZOOMOUTTEXT":b="-";break;case "z439":b="Navigator Bird's Eye View";break;case "z437":b="430";break;case "z436":b="84";break;case "z435":b=
"Cancel";break;case "z438":b="OK";break;case "UI_TRACEDISPLAYTITLE":b="Trace Values\n\n";break;case "z445":b="";break;default:b="Unexpected resource request"}return b},clearDisplay:function(a){if(a)if(Z.useCanvas&&"CANVAS"==a.tagName)Z.Utils.clearCanvas(a);else for(;a.hasChildNodes();)a.removeChild(a.lastChild)},clearCanvas:function(a){a=a.getContext("2d");a.save();try{a.setTransform(1,0,0,1,0,0)}catch(b){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SETTINGTRANSFORMONCANVASFORUNCONVERTEDIMAGE")),
console.log("In function clearCanvas setting transform on canvas:  "+b)}a.clearRect(0,0,a.canvas.width,a.canvas.height);a.restore()},colorCanvas:function(a,b){var c=a.getContext("2d");c.save();c.setTransform(1,0,0,1,0,0);c.fillStyle=b;c.fillRect(0,0,c.canvas.width,c.canvas.height);c.restore()},deleteDiv:function(a){if(a=document.getElementById(a)){for(;a.hasChildNodes();)a.removeChild(a.lastChild);a.parentNode.removeChild(a)}},createCallback:function(a,b){for(var c=[],d=2,e=arguments.length;d<e;d++)c[c.length]=
arguments[d];return function(){for(var d=c.concat([]),e=0,p=arguments.length;e<p;e++)d[d.length]=arguments[e];return b.apply(a,d)}},validateCallback:function(a){"undefined"===typeof Z.callbacks&&(Z.callbacks=[]);var b=Z.callbacks.slice(0);Z.Utils.functionCallWithDelay(function(){Z.Utils.validateCallbackDelayed(a,b)},10)},validateCallbackDelayed:function(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c];if(e&&e.callbackEvent==a&&"object"===typeof e&&"function"===typeof e.callbackFunction)switch(a){case "viewChanging":e.callbackFunction();
break;case "viewPanningGetCurrentCoordinates":var g=Z.Viewport.getCoordinates();e.callbackFunction(g);break;case "viewZoomingGetCurrentZoom":g=Z.Viewport.getZoom();e.callbackFunction(g);break;case "viewChangingGetCurrentCoordinatesFull":g=Z.Viewport.getCoordinatesFull();e.callbackFunction(g);break;default:e.callbackFunction()}}Z.Utils.arrayClear(b)},getContainerSize:function(a,b){var c=Z.Utils.getElementStyle(a),d=parseFloat(c.width),e=parseFloat(c.height);Z.Utils.stringValidate(c.width)&&-1!=c.width.indexOf("%")&&
(d=parseFloat(Z.Utils.getElementStyleProperty(a,"width")));Z.Utils.stringValidate(c.height)&&-1!=c.height.indexOf("%")&&(e=parseFloat(Z.Utils.getElementStyleProperty(a,"height")));isNaN(d)&&(d=b.clientWidth);isNaN(e)&&(e=b.clientHeight);if(0==d||0==e)winDimensions=Z.Utils.getWindowSize(),0==d&&(a.parentNode.style.width=winDimensions.x+"px",d=a.clientWidth),0==e&&(a.parentNode.style.height=winDimensions.y+"px",e=a.clientHeight);if(isNaN(d)||0==d)d=800;if(isNaN(e)||0==e)e=400;return new Z.Utils.Point(d,
e)},createContainerElement:function(a,b,c,d,e,g,l,p,v,B,D,X,N,w,U,k,u){var A=document.createElement(a);this.stringValidate(b)&&(A.id=b);b=A.style;b.display=this.stringValidate(c)?c:"inline-block";b.position=this.stringValidate(d)?d:"static";b.overflow=this.stringValidate(e)?e:"hidden";"canvas"==a?(this.stringValidate(g)&&A.setAttribute("width",g),this.stringValidate(l)&&A.setAttribute("height",l)):(this.stringValidate(g)&&(b.width=g),this.stringValidate(l)&&(b.height=l));this.stringValidate(p)&&(b.left=
p);this.stringValidate(v)&&(b.top=v);b.borderStyle=this.stringValidate(B)?B:"none";b.borderWidth=this.stringValidate(D)?D:"0px";b.borderColor="#696969";b.background=this.stringValidate(X)?X:"transparent none";b.margin=this.stringValidate(N)?N:"0px";b.padding=this.stringValidate(w)?w:"0px";b.whiteSpace=this.stringValidate(U)?U:"normal";this.stringValidate(k)&&(b.cursor=k);"undefined"!==u&&u&&(Z.Utils.addEventListener(A,"touchstart",Z.Utils.preventDefault),Z.Utils.addEventListener(A,"mousedown",Z.Utils.preventDefault),
Z.Utils.addEventListener(A,"contextmenu",Z.Utils.preventDefault));return A},createCenteredElement:function(a,b){var c=this.createContainerElement("div"),d=[];d[d.length]='<div style="#position:relative; display:table; height:100%; width:100%; border:none; margin:0px; padding:0px; overflow:hidden; text-align:left;">';d[d.length]='<div style="#position:absolute; display:table-cell; #top:50%; width:100%; border:none; margin:0px; padding:0px; vertical-align:middle;">';d[d.length]='<div id="'+b+'"; style="#position:relative; width:100%; #top:-50%; border:none; margin:0px; padding:0px; text-align:center;"></div></div></div>';
c.innerHTML=d.join("");for(var d=c=c.firstChild,e=c.getElementsByTagName("div");0<e.length;)d=e[0],e=d.getElementsByTagName("div");d.appendChild(a);return c},createTextElement:function(a,b,c,d,e,g,l,p,v,B,D,X,N,w,U,k,u,A){c=Z.Utils.createContainerElement("div","textBoxFor-"+a,"inline-block","absolute","hidden",c,d,e,g,p,v,"white","0px",l,"normal");d=document.createElement("textarea");c.appendChild(d);e=d.style;d.id=a;d.value=b;d.readOnly=B;e.width="100%";e.height="100%";e.margin="0";e.border="0";
this.stringValidate(D)&&(e.fontFamily=D);this.stringValidate(X)&&(e.fontSize=X);this.stringValidate(N)&&(e.resize=N);this.stringValidate(w)&&(d.columns=w);this.stringValidate(U)&&(d.rows=U);this.stringValidate(k)&&(e.overflowX=k);this.stringValidate(u)&&(e.overflowY=u);this.stringValidate(A)&&(d.wrap=A,"off"==A&&(e.whiteSpace="nowrap"));return c},getChildElementByID:function(a,b){for(var c=null,d=0,e=a.childNodes.length;d<e&&(c=a.childNodes[d],c.id!=b)&&(c=Z.Utils.getChildElementByID(c,b),null===
c);d++);return c},getElementPosition:function(a){for(var b=0,c=0,d="fixed"==this.getElementStyle(a).position,e=this.getOffsetParent(a,d);e;)b+=a.offsetLeft,c+=a.offsetTop,d&&(a=this.getPageScroll(),b+=a.x,c+=a.y),a=e,d="fixed"==this.getElementStyle(a).position,e=this.getOffsetParent(a,d);return new this.Point(b,c)},getOffsetParent:function(a,b){return b&&a!=document.body?document.body:a.offsetParent},getElementSize:function(a){return new this.Point(a.clientWidth,a.clientHeight)},getElementStyle:function(a){if(a.currentStyle)return a.currentStyle;
if(window.getComputedStyle)return window.getComputedStyle(a,"");this.showMessage(this.getResource("z283"))},getElementStyleProperty:function(a,b){if(window.getComputedStyle)return window.getComputedStyle(a,null).getPropertyValue(b);if(a.currentStyle)return a.currentStyle[b];this.showMessage(this.getResource("z283"))},getElementStylePropertyZIndex:function(a){var b=0;window.document.defaultView.getComputedStyle?b=window.document.defaultView.getComputedStyle(a,null).getPropertyValue("z-index"):a.currentStyle?
b=a.currentStyle["z-index"]:this.showMessage(this.getResource("z283"));return b},isElementFluid:function(a){var b=null,c=a.cloneNode(!1),d=!1,e=!1,g=null,l=null,p=0,v=0,B=Z.Utils.getElementStyle(a);B&&(p=B.width,v=B.height,b=-1!=p.indexOf("px")&&-1!=v.indexOf("px"));if(Z.browser!=Z.browsers.IE||9<=Z.browserVersion&&!b)window.getComputedStyle?value=window.getComputedStyle(c,null).width:c.currentStyle&&(value=c.currentStyle.width),"undefined"!==typeof value&&null!==value&&""!==value&&(d=-1!=value.toString().indexOf("%")||
"auto"==value),d||(window.getComputedStyle?value=window.getComputedStyle(c,null).height:c.currentStyle&&(value=c.currentStyle.height),"undefined"!==typeof value&&null!==value&&""!=value&&(e=-1!=value.toString().indexOf("%")||"auto"==value)),d||e||(g=Z.Utils.isElementFluidNew(a)),d||e||(l=0!=parseFloat(p)%1||0!=parseFloat(v)%1);return d||e||g||l},isElementFluidNew:function(a){var b=a.cloneNode(!1),c,d,e,g,l;e=d=!1;b.style.margin="0";b.style.padding="0";b.style.maxWidth="none";b.style.minWidth="none";
c=document.createElement("testContainer");c.style.display="block";c.style.width="800px";c.style.padding="0";c.style.margin="0";c.appendChild(b);a.parentNode.insertBefore(c,a);d=b.offsetWidth;c.style.width="900px";b.offsetWidth==d?(a.parentNode.removeChild(c),d=!1):(g=Math.floor(.125*d),l=Math.floor(100/900*b.offsetWidth),a.parentNode.removeChild(c),d=g==l?!0:!1);d||(b.style.margin="0",b.style.padding="0",b.style.maxHeight="none",b.style.minHeight="none",c=document.createElement("testContainer"),c.style.display=
"block",c.style.height="800px",c.style.padding="0",c.style.margin="0",c.appendChild(b),a.parentNode.insertBefore(c,a),e=b.offsetHeight,c.style.height="900px",b.offsetHeight==e?(a.parentNode.removeChild(c),e=!1):(g=Math.floor(.125*e),l=Math.floor(100/900*b.offsetHeight),a.parentNode.removeChild(c),e=g==l?!0:!1));return d||e},getEventTargetCoords:function(a){return getElementPosition(Z.Utils.target(a))},getFirstTouch:function(a){var b=null,c=a.touches;a=a.changedTouches;"undefined"!==typeof c?b=c[0]:
"undefined"!==typeof a&&(b=a[0]);return b},getMousePosition:function(a){var b=0,c=0;"DOMMouseScroll"==a.type&&Z.browser==Z.browsers.FIREFOX&&3>Z.browserVersion?(b=a.screenX,c=a.screenY):"number"===typeof a.pageX?(b=a.pageX,c=a.pageY):"number"===typeof a.clientX?(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c=a.clientY+document.body.scrollTop+document.documentElement.scrollTop):console.log(this.getResource("z284"));return new this.Point(b,c)},getMouseScroll:function(a){var b=
0;"number"===typeof a.wheelDelta?b=a.wheelDelta:"number"===typeof a.detail?b=-1*a.detail:this.showMessage(this.getResource("z285"));return b?b/Math.abs(b):0},getPageScroll:function(){var a=0,b=0,c=document.documentElement||{},d=document.body||{};if("number"===typeof window.pageXOffset)a=window.pageXOffset,b=window.pageYOffset;else if(d.scrollLeft||d.scrollTop)a=d.scrollLeft,b=d.scrollTop;else if(c.scrollLeft||c.scrollTop)a=c.scrollLeft,b=c.scrollTop;return new this.Point(a,b)},getScreenSize:function(){return new this.Point(screen.width,
screen.height)},getWindowSize:function(){var a=0,b=0,c=document.documentElement||{},d=document.body||{};"number"===typeof window.innerWidth?(a=window.innerWidth,b=window.innerHeight):c.clientWidth||c.clientHeight?(a=c.clientWidth,b=c.clientHeight):d.clientWidth||d.clientHeight?(a=d.clientWidth,b=d.clientHeight):this.showMessage(this.getResource("z286"));return new this.Point(a,b)},Button:function(a,b,c,d,e,g,l,p,v,B,D,X,N,w,U,k,u,A,M,ba){a=Z.Utils.createContainerElement("span",a,"inline-block","absolute",
"hidden",l,p,v,B,w,U,k,u,A,M,ba);if(Z.Utils.stringValidate(b)){var Za=document.createTextNode(b);a.appendChild(Z.Utils.createCenteredElement(Za));Z.Utils.setTextNodeStyle(Za,"black","verdana","13px","none","normal","normal","normal","normal","1em","center","none")}else{c=Z.Utils.stringRemoveTrailingSlashCharacters(c);var ga=Z.Utils.createGraphicElement(c+"/"+d),ua=Z.Utils.createGraphicElement(c+"/"+e),ya=Z.Utils.createGraphicElement(c+"/"+g);ga.style.width=ua.style.width=ya.style.width=l;ga.style.height=
ua.style.height=ya.style.height=p;ga.style.position=ua.style.position=ya.style.position="absolute";Z.browser==Z.browsers.FIREFOX&&3>Z.browserVersion&&(ga.style.top=ua.style.top=ya.style.top="");ua.style.visibility=ya.style.visibility="hidden";ga.alt=ua.alt=ya.alt="";"undefined"!==typeof N&&Z.Utils.stringValidate(N)&&(ga.alt=Z.Utils.getResource(N));a.appendChild(ga);a.appendChild(ua);a.appendChild(ya)}Z.Utils.addEventListener(a,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"mouseover",
Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mousedown",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mouseup",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mouseout",Z.Utils.stopPropagation);"undefined"!==typeof imageUp&&(Z.Utils.addEventListener(ga,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(ua,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(ya,"contextmenu",Z.Utils.preventDefault));Z.Utils.addEventListener(a,"touchstart",Z.Utils.preventDefault);
Z.Utils.addEventListener(a,"touchend",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"touchcancel",Z.Utils.preventDefault);Z.Utils.stringValidate(b)||(Z.Utils.disableTextInteraction(Za),Z.Utils.addEventListener(a,"contextmenu",Z.Utils.preventDefault));Z.tooltipsVisible&&Z.Utils.stringValidate(N)&&(a.title=Z.Utils.getResource(N));Z.Utils.setButtonHandler(a,D,X);this.elmt=a},buttonSize:function(a,b,c){var d=a.style;d.width=b+"px";d.height=c+"px";c=a.firstChild;d=a.childNodes[1];a=a.childNodes[2];
c&&d&&a&&(c.style.width=d.style.width=a.style.width=b+"px",c.style.height=d.style.height=a.style.height=b+"px")},setButtonDefaults:function(a){Z.Utils.clearButtonSettings(a);Z.Utils.setButtonState(a,"up");Z.Utils.setButtonHandler(a,"mouseover",Z.Toolbar.z457)},clearButtonSettings:function(a){var b=a.firstChild,c=a.childNodes[1],d=a.childNodes[2];b&&c&&d&&(b.style.visibility=c.style.visibility=d.style.visibility="hidden",Z.Utils.removeEventListener(b,"mouseover",Z.Toolbar.z457),Z.Utils.removeEventListener(c,
"mousedown",Z.Toolbar.z457),Z.Utils.removeEventListener(c,"mouseout",Z.Toolbar.z457),Z.Utils.removeEventListener(d,"mouseup",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchstart",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchend",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchcancel",Z.Toolbar.z457));Z.Utils.removeEventListener(a,"mouseover",Z.Toolbar.z457);Z.Utils.removeEventListener(a,"mousedown",Z.Toolbar.z457);Z.Utils.removeEventListener(a,"mouseout",Z.Toolbar.z457);Z.Utils.removeEventListener(a,
"mouseup",Z.Toolbar.z457)},setButtonState:function(a,b){var c="up"==b?a.firstChild:"down"==b?a.childNodes[1]:a.childNodes[2];c&&(c.style.visibility="visible")},setButtonHandler:function(a,b,c){c="undefined"!==c?c:Z.Toolbar.z457;var d="undefined"!==b?b:"mouseover";if("mouseover"==b&&"undefined"!==typeof a.firstChild)a=a.firstChild;else if("mousedown"!=b||"undefined"===typeof a.childNodes[1])"mouseup"==b&&"undefined"!==typeof a.childNodes[2]?a=a.childNodes[2]:"mouseout"==b&&"undefined"!==typeof a.childNodes[1]&&
(a=a.childNodes[1]);Z.Utils.addEventListener(a,"mousedown"==b?"touchstart":"touchend",c);Z.Utils.addEventListener(a,d,c)},Checkbox:function(a,b,c,d,e,g,l,p,v){var B=Z.Utils.createContainerElement("div","containerFor-"+a,"inline-block","absolute","hidden",c,d,e,g,"none","0px","transparent none","0px","0px","normal"),D=document.createElement("input");B.appendChild(D);D.type="checkbox";D.id=a;D.value=b;D.width=c;D.height=d;a=B.style;a.width=c+"px";a.height=d+"px";a.left=e+"px";a.top=g+"px";Z.Utils.addEventListener(D,
l,p);Z.Utils.addEventListener(D,"touchstart",p);Z.tooltipsVisible&&Z.Utils.stringValidate(v)&&(D.title=Z.Utils.getResource(v));return B},Graphic:function(a,b,c,d,e,g,l,p){b=Z.Utils.stringRemoveTrailingSlashCharacters(b);b=Z.Utils.createGraphicElement(c?b+"/"+c:b);c=b.style;c.width=d;c.height=e;"undefined"!==typeof p&&Z.Utils.stringValidate(p)?b.alt=Z.Utils.getResource(p):b.alt="";c=Z.Utils.createContainerElement("span",a,"inline-block","absolute","hidden",d,e,g,l,"none","0px","transparent none","0px",
"0px","normal");c.appendChild(b);this.elmt=c;Z.Utils.addEventListener(b,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(b,"touchstart",Z.Utils.preventDefault);Z.Utils.addEventListener(b,"contextmenu",Z.Utils.preventDefault)},createGraphicElement:function(a){var b=this.createContainerElement("img"),c=null;Z.browser==Z.browsers.IE&&7>Z.browserVersion?(c=this.createContainerElement("span",null,"inline-block"),b.onload=function(){c.style.width=c.style.width||b.width+"px";c.style.height=c.style.height||
b.height+"px";b=b.onload=null},c.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'", sizingMethod="scale")'):(c=b,c.src=a);return c},graphicSize:function(a,b,c){var d=a.style;d.width=b+"px";d.height=c+"px";a=a.firstChild.style;a.width=b+"px";a.height=c+"px"},Point:function(a,b){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0},Point3D:function(a,b,c){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0;this.z="number"===typeof c?c:0},Coordinates:function(a,
b,c,d){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0;this.z="number"===typeof c?c:0;this.r="number"===typeof d?d:0},Pair:function(a,b){this.a=a;this.b=b},Trio:function(a,b,c){this.a=a;this.b=b;this.c=c},Range:function(a,b){this.start="number"===typeof a?a:0;this.end="number"===typeof b?b:0},RangeScale:function(a,b){this.min="number"===typeof a?a:0;this.max="number"===typeof b?b:0},swapZIndices:function(a,b){var c=Z.Utils.getElementStylePropertyZIndex(a),d=Z.Utils.getElementStylePropertyZIndex(b);
if("auto"==c||"auto"==d)c=(Z.baseZIndex-101).toString(),d=(Z.baseZIndex-100).toString();a.style.zIndex=d;b.style.zIndex=c},stringValidate:function(a){return"undefined"!==typeof a&&null!==a&&""!==a&&"null"!==a},stringReadable:function(a){return a.replace(RegExp("%20","g")," ")},stringLowerCaseFirstLetter:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},stringUpperCaseFirstLetter:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},stringMultiply:function(a,b){var c=Math.ceil(Math.log(b)/
Math.LN2),d=a;do d+=d;while(0<--c);return d.slice(0,a.length*b)},stringPadFront:function(a,b,c){return a=Z.Utils.stringMultiply(c,b-a.length)+a},stringRemoveTrailingSlashCharacters:function(a){return"/"==a.slice(-1,a.length)?a.slice(0,a.length-1):a},stringRemoveFileExtension:function(a){var b=a.length;"."==a.slice(b-4,b-3)&&(a=a.slice(0,b-4));return a},stringUnescapeAmpersandCharacters:function(a){a=a.replace(/\n/g,"");a=a.replace(/&#38;/g,"&");a=a.replace(/&#038;/g,"&");return a=a.replace(/&amp;/g,
"&")},setTextNodeStyle:function(a,b,c,d,e,g,l,p,v,B,D,X){a=a.parentNode.style;a.color=b;a.fontFamily=c;a.fontSize=d;a.fontSizeAdjust=e;a.fontStyle=g;a.fontStretch=l;a.fontVariant=p;a.fontWeight=v;a.lineHeight=B;a.textAlign=D;a.textDecoration=X},stringValidateColorValue:function(a){Z.Utils.stringValidate(a)||(a="#000000");0!=a.indexOf("#")&&(a="#"+a);return a},hexToRGB:function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,c,d,e){return c+c+d+d+e+e});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?
{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},xmlConvertTextToDoc:function(a){var b=null;if(window.ActiveXObject)try{b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)}catch(c){this.showMessage(c.name+this.getResource("z244")+c.message)}else if(window.DOMParser)try{b=(new DOMParser).parseFromString(a,"text/xml")}catch(c){this.showMessage(c.name+this.getResource("z244")+c.message)}else this.showMessage(this.getResource("z294"));return b},xmlConvertDocToText:function(a){var b=
null;if(window.ActiveXObject)try{b=a.xml}catch(c){this.showMessage(c.name+this.getResource("z243")+c.message)}else if(window.DOMParser)try{b=(new XMLSerializer).serializeToString(a)}catch(c){this.showMessage(c.name+this.getResource("z243")+c.message)}else this.showMessage(this.getResource("z294"));return b},xmlEscapeMinimal:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\r?\n/g,
"%0A"));return b},xmlUnescapeMinimal:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/%0A/g,"\n").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"));return b},arrayClear:function(a){if(a)for(;0<a.length;)a.pop()},arrayClearObjectValue:function(a,b){for(var c=0,d=a.length;c<d;c++)a[c][b]=null},arrayClone:function(a,b,c){c=[];switch(a){case "pois":a=0;for(var d=b.length;a<d;a++)c[c.length]={text:b[a].text,value:b[a].value,
id:b[a].id,x:b[a].x,y:b[a].y,z:b[a].z,user:b[a].user,date:b[a].date,editable:b[a].editable};break;case "labels":a=0;for(d=b.length;a<d;a++)c[c.length]={text:b[a].text,value:b[a].value,poiID:b[a].poiID,editable:b[a].editable};break;case "hotspots":a=0;for(d=b.length;a<d;a++)c[c.length]={id:b[a].id,name:b[a].name,mediaType:b[a].mediaType,media:b[a].media,audio:b[a].audio,x:b[a].x,y:b[a].y,z:b[a].z,xScale:b[a].xScale,yScale:b[a].yScale,radius:b[a].radius,zMin:b[a].zMin,zMax:b[a].zMax,clickURL:b[a].clickURL,
urlTarget:b[a].urlTarget,rollover:b[a].rollover,caption:b[a].caption,tooltip:b[a].tooltip,textColor:b[a].textColor,backColor:b[a].backColor,lineColor:b[a].lineColor,fillColor:b[a].fillColor,textVisible:b[a].textVisible,backVisible:b[a].backVisible,lineVisible:b[a].lineVisible,fillVisible:b[a].fillVisible,captionPosition:b[a].captionPosition,saved:b[a].saved,visibility:b[a].visibility,internalID:b[a].internalID,poiID:b[a].poiID,captionHTML:b[a].captionHTML,tooltipHTML:b[a].tooltipHTML,polyClosed:b[a].polyClosed,
polygonPts:b[a].polygonPts,showFor:b[a].showFor,transition:b[a].transition,changeFor:b[a].changeFor,rotation:b[a].rotation,editable:b[a].editable,popup:b[a].popup,popupOffsetX:b[a].popupOffsetX,popupOffsetY:b[a].popupOffsetY,comment:b[a].comment,user:b[a].user,date:b[a].date,iW:b[a].iW,iH:b[a].iH,image:b[a].image};break;case "polygon":a=0;for(d=b.length;a<d;a++)c[c.length]={x:b[a].x,y:b[a].y};break;case "notes":a=0;for(d=b.length;a<d;a++)c[c.length]={text:b[a].text,value:b[a].value,noteText:b[a].noteText,
poiID:b[a].poiID,id:b[a].id,user:b[a].user,date:b[a].date,editable:b[a].editable};break;case "magnifications":for(a=0,d=b.length;a<d;a++)c[c.length]={text:b[a].text,value:b[a].value}}return c},arrayImageLoadingValidate:function(a){var b=!1;if(a&&0<a.length)for(var b=!0,c=0,d=a.length;c<d;c++)if(null===a[c]||0==a[c].image.width||0==a[c].image.height)b=!1;return b},arrayIndexOf:function(a,b,c){c?0>c&&(c=Math.max(0,a.length+c)):c=0;for(var d=a.length;c<d;c++)if(a[c]===b)return c;return-1},arrayIndexOfObjectValue:function(a,
b,c,d){if("undefined"!==typeof a){d?0>d&&(d=Math.max(0,a.length+d)):d=0;for(var e=a.length;d<e;d++)if(a[d][b]===c)return d}return-1},arrayIndexOfObjectTwoValues:function(a,b,c,d,e,g){if("undefined"!==typeof a){d?0>d&&(d=Math.max(0,a.length+d)):d=0;for(var l=a.length;d<l;d++)if(a[d][b]===c&&a[d][e].toString()===g.toString())return d}return-1},arrayIndexOfSubstring:function(a,b,c){c?0>c&&(c=Math.max(0,a.length+c)):c=0;for(var d=a.length;c<d;c++)if(-1!=a[c].indexOf(b))return c;return-1},arrayIndexOfObjectValueSubstring:function(a,
b,c,d,e){d?0>d&&(d=Math.max(0,a.length+d)):d=0;for(var g=a.length;d<g;d++)if(e){if(-1!=a[d][b].toLowerCase().indexOf(c))return d}else if(-1!=a[d][b].indexOf(c))return d;return-1},arrayIntersect:function(a,b){for(var c,d,e,g=[],l=0,p=a.length;l<p;l++){c=a[l];e=!1;for(var v=0,B=b.length;v<B&&c>=(d=b[v]);v++)if(d==c){e=!0;break}e&&(g[g.length]=a[l])}return g},arrayMap:function(a,b){var c=[];if(Z.arrayMapSupported)c=a.map(b);else for(var d=0,e=a.length;d<e;d++)c[d]=b(a[d]);return c},arraySplice:function(a,
b,c){if(Z.arraySpliceSupported)if(3<arguments.length)for(var d=3,e=arguments.length;d<e;d++)a.splice(b,c,arguments[d]);else a.splice(b,c);else{0>c&&(c=0);var g=[];if(3<arguments.length)for(d=3,e=arguments.length;d<e;d++)g[g.length]=arguments[d];for(var d=Z.Utils.arraySubarray(a,0,b),l=Z.Utils.arraySubarrayLen(a,b,c),e=Z.Utils.arraySubarray(a,b+c),g=d.concat(g,e),d=a.length=0,e=g.length;d<e;d++)a[a.length]=g[d];a=l}return a},arraySubarraySimple:function(a,b){return this.slice(a,b)},arraySortNumericAscending:function(a,
b,c){a.sort(function(a,b){return a-b});return a},arraySortNumericDescending:function(a,b,c){a.sort(function(a,b){return b-a});return a},arraySortByObjectValue:function(a,b,c,d){a.sort(function(a,c){return a[b]>c[b]});return a},arraySubarray:function(a,b,c){0>b&&(b=0);if(!c||c>a.length)c=a.length;if(b==c)return[];for(var d=[];b<c;b++)d[d.length]=a[b];return d},arraySubarrayLen:function(a,b,c){if(b>=a.length||c&&0>=c)return[];0>b&&(b=Math.abs(b)>a.length?0:a.length+b);if(!c||c+b>a.length)c=a.length-
b;for(var d=[],e=b;e<b+c;e++)d[d.length]=a[e];return d},arraySubtract:function(a,b){for(var c=a.slice(0),d=0,e=c.length;d<e;d++){for(var g=c[d],l=!1,p=0,v=b.length;p<v&&g>=(elmt2=b[p]);p++)if(elmt2==g){l=!0;break}l&&(c=Z.Utils.arraySplice(c,d--,1))}return c},arrayToArrayOfStrings:function(a){for(var b=[],c=0,d=a.length;c<d;c++)b[c]="undefined"!==typeof a[c]&&"undefined"!=a[c]&&null!==a[c]?a[c].toString():"";return b},arrayUnique:function(a){for(var b=1;b<a.length;)a[b-1]==a[b]?a=Z.Utils.arraySplice(a,
b,1):b++;return a},arrayUniqueByObjectValue:function(a,b){if("undefined"!==typeof a)for(var c=1;c<a.length;)a[c-1][b]==a[c][b]?a=Z.Utils.arraySplice(a,c,1):c++;return a},calculatePointsDistance:function(a,b,c,d){return Math.sqrt((a-=c)*a+(b-=d)*b)},fullScreenView:function(a,b,c){if("undefined"===typeof c||null===c)c=!1;b?(b=document.documentElement,b.requestFullScreen?a.requestFullScreen():b.mozRequestFullScreen?a.mozRequestFullScreen():b.webkitRequestFullScreen?a.webkitRequestFullScreen():b.msRequestFullscreen&&
a.msRequestFullscreen()):document.cancelFullScreen?c||document.cancelFullScreen():document.mozCancelFullScreen?c||document.mozCancelFullScreen():document.webkitCancelFullScreen?c||document.webkitCancelFullScreen():document.msExitFullscreen&&(c||document.msExitFullscreen())},rotatePoint:function(a,b,c){var d=Math.PI/180*-c;c=a*Math.cos(d)-b*Math.sin(d);a=a*Math.sin(d)+b*Math.cos(d);return new Z.Utils.Point(c,a)},rotateElement:function(a,b,c){if(b!=Z.imageR||c)b="rotate("+b.toString()+"deg)",a.transform=
b,a.msTransform=b,a.mozTransform=b,a.webkitTransform=b,a.oTransform=b},getPositionRotated:function(a,b,c,d,e){if("undefined"===typeof e||null===e)e=Z.imageR;0>e&&(e+=360);e=e*Math.PI/180;a-=c;var g=b-d;b=a*Math.cos(e)-g*Math.sin(e);e=a*Math.sin(e)+g*Math.cos(e);c=Math.round(b+c);d=Math.round(e+d);return new Z.Utils.Point(c,d)},getDisplayPositionRotated:function(a,b){if("undefined"===typeof b||null===b)b=Z.imageR;0>b&&(b+=360);var c=parseFloat(a.left),d=parseFloat(a.top),e=parseFloat(a.width),g=parseFloat(a.height);
return Z.Utils.getPositionRotated(c,d,c+e/2,d+g/2,b)},translateElement:function(a,b,c){b="translate("+b.toString()+"px,"+c.toString()+"px)";a.transform=b;a.msTransform=b;a.mozTransform=b;a.webkitTransform=b;a.oTransform=b},scaleElement:function(a,b){var c="scale("+b.toString()+")";a.transform=c;a.msTransform=c;a.mozTransform=c;a.webkitTransform=c;a.oTransform=c},intValue:function(a,b){return(a[b]+(a[b+1]<<8)|a[b+2]<<16)+16777216*a[b+3]},longValue:function(a,b){var c=(a[b]+(a[b+1]<<8)|a[b+2]<<16)+
16777216*a[b+3];0!=a[b+4]&&(c+=4294967296*a[b+4]);return c},shortValue:function(a,b){return a[b]+(a[b+1]<<8)},createUint8Array:function(a,b){return Z.uInt8ArraySupported?new Uint8Array(a,b):new Z.Utils.TypedArray(a,b)},TypedArray:function(a){var b;if("number"===typeof a){b=Array(a);for(var c=0;c<a;++c)b[c]=0}else b=a.slice(0);b.subarray=Z.Utils.arraySubarraySimple;b.buffer=b;b.byteLength=b.length;b.set=Z.Utils.setSimple;"object"===typeof a&&a.buffer&&(b.buffer=a.buffer);return b},setSimple:function(a,
b){2>arguments.length&&(b=0);for(var c=0,d=a.length;c<d;++c,++b)this[b]=a[c]&255},encodeBase64:function(a){var b,c,d,e,g=0,l=0,p="",p=[];if(!a)return a;do b=a[g++],c=a[g++],d=a[g++],e=b<<16|c<<8|d,b=e>>18&63,c=e>>12&63,d=e>>6&63,e&=63,p[l++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e);
while(g<a.length);p=p.join("");a=a.length%3;return(a?p.slice(0,a-3):p)+"===".slice(a||3)},validateResponseArrayFunctionality:function(){"ZoomifyImageFile"!=Z.tileSource||Z.responseArraySupported||Z.responseArrayPrototyped||(Z.Utils.defineObjectProperty(XMLHttpRequest.prototype,"response",{get:function(){return(new VBArray(this.responseBody)).toArray()}}),Z.responseArrayPrototyped=!0)},defineObjectProperty:function(a,b,c){Z.definePropertySupported?Object.defineProperty(a,b,c):(delete a[b],"get"in c&&
a.__defineGetter__(b,c.get),"set"in c&&a.__defineSetter__(b,c.set),"value"in c&&(a.__defineSetter__(b,function(a){this.__defineGetter__(b,function(){return a});return a}),a[b]=c.value))},createImageElementFromBytes:function(a,b){function c(a){d.onload=null;d.onabort=null;d.onerror=null;e&&window.clearTimeout(e);window.setTimeout(function(){b(d)},1)}var d=new Image,e=null,g=parseFloat(this.getResource("z139")),l=function(){c(!1)};d.onload=function(){c(!0)};d.onabort=l;d.onerror=l;e=window.setTimeout(function(){console.log(Z.Utils.getResource("z253"));
c(!1)},g);d.src=a},getCurrentUTCDateAsString:function(){var a=new Date,b=(10>a.getUTCMonth()+1?"0":"")+(a.getUTCMonth()+1),c=(10>a.getUTCDate()?"0":"")+a.getUTCDate(),d=(10>a.getUTCHours()?"0":"")+a.getUTCHours(),e=(10>a.getUTCMinutes()?"0":"")+a.getUTCMinutes(),g=(10>a.getUTCSeconds()?"0":"")+a.getUTCSeconds();return a.getUTCFullYear()+b+c+d+e+g},cacheProofPath:function(a){a+="?t"+(new Date).getTime().toString()+"n"+Z.cacheProofCounter.toString();Z.cacheProofCounter+=1;return a},easing:function(a,
b,c,d,e){if("undefined"===typeof e||null===e)e=Z.smoothZoomEasing;var g=b;if(Z.smoothZoom&&1<e)switch(e){case 2:c/=d;c--;g=(b-a)*(c*c*c*c*c+1)+a;break;case 3:g=(b-a)*(-Math.pow(2,-10*c/d)+1)+a;break;case 4:b-=a,g=1>(c/=d/2)?b/2*c*c*c*c*c+a:b/2*((c-=2)*c*c*c*c+2)+a}return g},functionCallWithDelay:function(a,b){window.setTimeout(a,b)},nodeIsInViewer:function(a){for(var b=!1;0==b;)if(a)a.id?"ViewerDisplay"==a.id?b=!0:a=a.parentNode:a=a.parentNode;else break;return b},roundToFixed:function(a,b){var c=
Math.round(a).toString().length,c=b-c,c=Math.pow(10,0>c?0:c);return a=Math.round(a*c)/c},getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},getSign:function(a){return a?0>a?-1:1:0},configureMessageDisplay:function(){var a=parseInt(this.getResource("z437"),10),b=parseInt(this.getResource("z436"),10),c=Z.Utils.getMessageDisplayCoords("6",a,Z.viewerW,Z.viewerH),d=this.getResource("z159"),e=this.getResource("z158");Z.MessageDisplay=this.createContainerElement("div","MessageDisplay",
"inline-block","absolute","auto",a+"px",b+"px",c.x+"px",c.y+"px","solid","1px",d,"0px","0px","normal",null,!0);Z.ViewerDisplay.appendChild(Z.MessageDisplay);Z.MessageDisplay.style.zIndex=(Z.baseZIndex+30).toString();c=Z.Utils.createTextElement("messageBox","",a-18+"px",b-40+"px","4px","4px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.MessageDisplay.appendChild(c);Z.messages=document.getElementById("messageBox");b=b-18-5;a-=66;c=this.getResource("z438");e=new Z.Utils.Button("buttonMessageOk",
c,null,null,null,null,"56px","18px",a+"px",b+"px","mousedown",this.messageOkButtonHandler,"z362","solid","1px",e,"0px","0px");Z.MessageDisplay.appendChild(e.elmt)},getMessageDisplayCoords:function(a,b,c,d){switch(a){case "1":d=a=40;break;case "2":a=c/2-b/2;d=40;break;case "3":a=c-b-80;d=40;break;case "4":a=c-b-40;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?d-120:d-80;break;case "5":a=c/2-b/2;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?d-120:d-80;break;case "6":a=40;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?
d-120:d-80;break;default:a=c-b,d=40}return new Z.Utils.Point(a,d)},messageOkButtonHandler:function(a){Z.Utils.hideMessage();return!0},messageCancelButtonHandler:function(a){Z.Utils.hideMessage();return!1},showMessage:function(a,b,c,d,e,g){if(Z.messagesVisible){Z.MessageDisplay||Z.Utils.configureMessageDisplay();if("undefined"===typeof g||null===g)g="6";var l=parseInt(this.getResource("z437"),10);g=Z.Utils.getMessageDisplayCoords(g,l,Z.viewerW,Z.viewerH);Z.MessageDisplay.style.left=g.x+"px";Z.MessageDisplay.style.top=
g.y+"px";Z.MessageDisplay.messageTimer&&window.clearTimeout(MessageDisplay.messageTimer);g=!0;e&&(-1!=Z.Utils.arrayIndexOf(Z.messageDisplayList,a)?g=!1:Z.messageDisplayList[Z.messageDisplayList.length]=a);if(g&&(Z.messages&&(Z.messages.value=a),Z.MessageDisplay.style.display="inline-block","undefined"!==typeof d&&null!==d&&(a=document.getElementById("textBoxFor-messageBox"))&&(a.firstChild.style.textAlign=d),d=document.getElementById("buttonMessageOk"),a=parseInt(this.getResource("z436"),10),"undefined"!==
typeof b&&null!==b&&b?(d.style.display="inline-block",Z.MessageDisplay.style.height=a+"px"):(d.style.display="none",Z.MessageDisplay.style.height=a-22+"px"),"undefined"!==typeof c&&null!==c&&!isNaN(c))){"undefined"!==typeof Z.MessageDisplay.messageTimer&&null!==Z.MessageDisplay.messageTimer&&window.clearTimeout(Z.MessageDisplay.messageTimer);if("undefined"===typeof c||null===c)c=3E3;Z.MessageDisplay.messageTimer=window.setTimeout(Z.Utils.hideMessageTimerHandler,c)}}},getMessage:function(){var a="";
Z.messages&&Z.Utils.stringValidate(Z.messages.value)&&(a=Z.messages.value);return a},hideMessage:function(){Z.MessageDisplay&&(Z.MessageDisplay.style.display="none")},hideMessageTimerHandler:function(){Z.MessageDisplay.messageTimer&&(window.clearTimeout(Z.MessageDisplay.messageTimer),Z.MessageDisplay.messageTimer=null);Z.Utils.hideMessage()},trace:function(a,b,c){Z.traces&&(Z.traces.value+=(b?"\n":"")+a+(c?"\n\n":"\n"),2==Z.debug&&(Z.traces.scrollTop=Z.traces.scrollHeight))}};
